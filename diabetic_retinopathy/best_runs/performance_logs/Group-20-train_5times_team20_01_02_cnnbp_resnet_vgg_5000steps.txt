2022-01-29 20:49:07.783882: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 20:49:08.366799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 20:49:08.767209 139772817229632 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 20:49:10.051276 139772817229632 main.py:117] Running model: cnn_blueprint
I0129 20:49:10.052260 139772817229632 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117
I0129 20:49:10.052331 139772817229632 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-204910
I0129 20:49:10.062817 139772817229632 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 20:49:10.062876 139772817229632 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts
I0129 20:49:10.062910 139772817229632 train.py:171] 
======== Starting Training ========
2022-01-29 20:49:10.088176: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 20:49:11.540962: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 20:49:38.205014 139772817229632 train.py:188] Step 250, Loss: 0.558803915977478, Accuracy: 70.18%, Validation Loss: 0.741792619228363, Validation Accuracy: 50.00%
I0129 20:49:38.219878 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:50:02.885531 139772817229632 train.py:188] Step 500, Loss: 0.44848939776420593, Accuracy: 77.68%, Validation Loss: 0.7042202949523926, Validation Accuracy: 58.49%
I0129 20:50:02.906711 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:50:27.985809 139772817229632 train.py:188] Step 750, Loss: 0.39669978618621826, Accuracy: 81.00%, Validation Loss: 0.573905348777771, Validation Accuracy: 69.81%
I0129 20:50:28.006633 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:50:52.715356 139772817229632 train.py:188] Step 1000, Loss: 0.3555420935153961, Accuracy: 83.95%, Validation Loss: 0.5106337666511536, Validation Accuracy: 73.58%
I0129 20:50:52.740619 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:51:17.344079 139772817229632 train.py:188] Step 1250, Loss: 0.3216971158981323, Accuracy: 85.66%, Validation Loss: 0.32028260827064514, Validation Accuracy: 83.96%
I0129 20:51:17.369251 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:51:40.770592 139772817229632 train.py:188] Step 1500, Loss: 0.28909212350845337, Accuracy: 87.24%, Validation Loss: 0.5646166801452637, Validation Accuracy: 71.70%
I0129 20:52:04.552854 139772817229632 train.py:188] Step 1750, Loss: 0.261646568775177, Accuracy: 88.60%, Validation Loss: 0.46553564071655273, Validation Accuracy: 75.47%
I0129 20:52:28.051924 139772817229632 train.py:188] Step 2000, Loss: 0.2359822690486908, Accuracy: 90.14%, Validation Loss: 0.3153274357318878, Validation Accuracy: 87.74%
I0129 20:52:28.082740 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:52:51.783887 139772817229632 train.py:188] Step 2250, Loss: 0.21827131509780884, Accuracy: 90.88%, Validation Loss: 0.3614524006843567, Validation Accuracy: 86.79%
I0129 20:53:15.103565 139772817229632 train.py:188] Step 2500, Loss: 0.21222670376300812, Accuracy: 91.37%, Validation Loss: 1.3145674467086792, Validation Accuracy: 57.55%
I0129 20:53:38.881484 139772817229632 train.py:188] Step 2750, Loss: 0.19604051113128662, Accuracy: 92.22%, Validation Loss: 0.22841720283031464, Validation Accuracy: 92.45%
I0129 20:53:38.897978 139772817229632 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts.
I0129 20:54:02.480627 139772817229632 train.py:188] Step 3000, Loss: 0.17795810103416443, Accuracy: 93.11%, Validation Loss: 1.4277998208999634, Validation Accuracy: 75.47%
I0129 20:54:26.203418 139772817229632 train.py:188] Step 3250, Loss: 0.18202990293502808, Accuracy: 92.67%, Validation Loss: 0.7868801951408386, Validation Accuracy: 72.64%
I0129 20:54:49.624130 139772817229632 train.py:188] Step 3500, Loss: 0.16309073567390442, Accuracy: 93.99%, Validation Loss: 0.686461329460144, Validation Accuracy: 84.91%
I0129 20:55:13.424055 139772817229632 train.py:188] Step 3750, Loss: 0.13950590789318085, Accuracy: 94.42%, Validation Loss: 0.3807428181171417, Validation Accuracy: 82.08%
I0129 20:55:36.791862 139772817229632 train.py:188] Step 4000, Loss: 0.14055849611759186, Accuracy: 94.79%, Validation Loss: 0.4769432246685028, Validation Accuracy: 87.74%
I0129 20:56:00.479156 139772817229632 train.py:188] Step 4250, Loss: 0.1352628916501999, Accuracy: 94.76%, Validation Loss: 0.3054031729698181, Validation Accuracy: 85.85%
I0129 20:56:23.765211 139772817229632 train.py:188] Step 4500, Loss: 0.13092447817325592, Accuracy: 95.29%, Validation Loss: 0.5652359127998352, Validation Accuracy: 86.79%
I0129 20:56:47.528224 139772817229632 train.py:188] Step 4750, Loss: 0.12077750265598297, Accuracy: 95.54%, Validation Loss: 3.1760706901550293, Validation Accuracy: 58.49%
I0129 20:57:11.042973 139772817229632 train.py:188] Step 5000, Loss: 0.11010938882827759, Accuracy: 95.99%, Validation Loss: 0.5146052837371826, Validation Accuracy: 82.08%
I0129 20:57:11.070922 139772817229632 train.py:222] Finished training after 5000 steps.
I0129 20:57:32.047234 139772817229632 eval.py:22] 
======== Starting Evaluation ========
I0129 20:57:32.058387 139772817229632 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/ckpts
I0129 20:57:32.205831 139772817229632 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         93.00396682293545
Sensitivity:          97.87234042553192
Specificity:          88.13559322033898
F1_Score:             92.0
Confusion_matrix:   
                   [46  7]
                   [ 1 52]


I0129 20:57:32.339926 139772817229632 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       78.64077669902912
Balanced_Acc:         77.3036858974359
Sensitivity:          71.7948717948718
Specificity:          82.8125
F1_Score:             71.7948717948718
Confusion_matrix:   
                   [28 11]
                   [11 53]


I0129 20:57:32.340198 139772817229632 eval.py:66] ======== Finished Evaluation ========
I0129 20:57:32.340511 139772817229632 visualization.py:90] 
======== Starting DeepVis ========
I0129 20:57:32.891652 139772817229632 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/plot/train/deepvis_IDRiD_001.jpg
I0129 20:57:33.268469 139772817229632 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/plot/test/deepvis_IDRiD_001.jpg
I0129 20:57:33.628487 139772817229632 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/plot/train/deepvis_IDRiD_009.jpg
I0129 20:57:33.984115 139772817229632 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-49-08-761117/plot/test/deepvis_IDRiD_009.jpg
I0129 20:57:34.064953 139772817229632 visualization.py:165] ======== Finished DeepVis ========
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 128, 5)       140       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 126, 126, 10)      460       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 63, 63, 10)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 63, 63, 10)        40        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 20)        1820      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 20)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 30, 30, 20)        80        
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 40)        7240      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 14, 14, 40)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 14, 14, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 40)                0         
_________________________________________________________________
dense (Dense)                (None, 30)                1230      
_________________________________________________________________
dropout (Dropout)            (None, 30)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 62        
=================================================================
Total params: 11,232
Trainable params: 11,092
Non-trainable params: 140
_________________________________________________________________
2022-01-29 20:57:37.543780: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 20:57:37.945056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 20:57:38.276399 139873101162304 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 20:57:39.554587 139873101162304 main.py:117] Running model: cnn_blueprint
I0129 20:57:39.555586 139873101162304 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312
I0129 20:57:39.555655 139873101162304 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-205739
I0129 20:57:39.566023 139873101162304 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 20:57:39.566084 139873101162304 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts
I0129 20:57:39.566118 139873101162304 train.py:171] 
======== Starting Training ========
2022-01-29 20:57:39.590966: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 20:57:40.962141: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 20:58:06.154664 139873101162304 train.py:188] Step 250, Loss: 0.5602453351020813, Accuracy: 70.54%, Validation Loss: 0.718131959438324, Validation Accuracy: 42.45%
I0129 20:58:06.167507 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 20:58:29.398883 139873101162304 train.py:188] Step 500, Loss: 0.493854820728302, Accuracy: 74.89%, Validation Loss: 0.6276204586029053, Validation Accuracy: 59.43%
I0129 20:58:29.422191 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 20:58:53.176125 139873101162304 train.py:188] Step 750, Loss: 0.4233858287334442, Accuracy: 79.49%, Validation Loss: 1.0795341730117798, Validation Accuracy: 58.49%
I0129 20:59:16.647212 139873101162304 train.py:188] Step 1000, Loss: 0.3546348810195923, Accuracy: 84.11%, Validation Loss: 0.3922930359840393, Validation Accuracy: 81.13%
I0129 20:59:16.667995 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 20:59:40.174080 139873101162304 train.py:188] Step 1250, Loss: 0.29829302430152893, Accuracy: 87.10%, Validation Loss: 0.35216715931892395, Validation Accuracy: 83.02%
I0129 20:59:40.193720 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 21:00:03.563279 139873101162304 train.py:188] Step 1500, Loss: 0.2662413716316223, Accuracy: 88.84%, Validation Loss: 0.40007296204566956, Validation Accuracy: 81.13%
I0129 21:00:27.111934 139873101162304 train.py:188] Step 1750, Loss: 0.2529563307762146, Accuracy: 89.46%, Validation Loss: 0.27146950364112854, Validation Accuracy: 88.68%
I0129 21:00:27.137993 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 21:00:50.420085 139873101162304 train.py:188] Step 2000, Loss: 0.22455231845378876, Accuracy: 90.81%, Validation Loss: 0.23737472295761108, Validation Accuracy: 93.40%
I0129 21:00:50.445794 139873101162304 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts.
I0129 21:01:14.288125 139873101162304 train.py:188] Step 2250, Loss: 0.20094791054725647, Accuracy: 92.18%, Validation Loss: 0.8341535329818726, Validation Accuracy: 80.19%
I0129 21:01:37.823926 139873101162304 train.py:188] Step 2500, Loss: 0.18295294046401978, Accuracy: 92.91%, Validation Loss: 1.0832505226135254, Validation Accuracy: 82.08%
I0129 21:02:01.490860 139873101162304 train.py:188] Step 2750, Loss: 0.16646359860897064, Accuracy: 93.69%, Validation Loss: 0.29886099696159363, Validation Accuracy: 90.57%
I0129 21:02:24.945403 139873101162304 train.py:188] Step 3000, Loss: 0.1623128354549408, Accuracy: 93.92%, Validation Loss: 0.5360267162322998, Validation Accuracy: 79.25%
I0129 21:02:48.646049 139873101162304 train.py:188] Step 3250, Loss: 0.15877777338027954, Accuracy: 94.04%, Validation Loss: 1.3404622077941895, Validation Accuracy: 75.47%
I0129 21:03:12.116602 139873101162304 train.py:188] Step 3500, Loss: 0.13102637231349945, Accuracy: 95.07%, Validation Loss: 0.5839895009994507, Validation Accuracy: 85.85%
I0129 21:03:35.825058 139873101162304 train.py:188] Step 3750, Loss: 0.1514105200767517, Accuracy: 94.32%, Validation Loss: 0.5427356958389282, Validation Accuracy: 84.91%
I0129 21:03:59.283855 139873101162304 train.py:188] Step 4000, Loss: 0.13316813111305237, Accuracy: 95.00%, Validation Loss: 0.5971359610557556, Validation Accuracy: 87.74%
I0129 21:04:22.966716 139873101162304 train.py:188] Step 4250, Loss: 0.12778881192207336, Accuracy: 95.62%, Validation Loss: 0.2869853377342224, Validation Accuracy: 89.62%
I0129 21:04:46.375692 139873101162304 train.py:188] Step 4500, Loss: 0.11593206971883774, Accuracy: 95.66%, Validation Loss: 0.35882729291915894, Validation Accuracy: 86.79%
I0129 21:05:09.991020 139873101162304 train.py:188] Step 4750, Loss: 0.12107368558645248, Accuracy: 95.51%, Validation Loss: 0.5066736936569214, Validation Accuracy: 86.79%
I0129 21:05:33.226370 139873101162304 train.py:188] Step 5000, Loss: 0.11225545406341553, Accuracy: 95.91%, Validation Loss: 0.27440109848976135, Validation Accuracy: 85.85%
I0129 21:05:56.818966 139873101162304 train.py:188] Step 5250, Loss: 0.12438777834177017, Accuracy: 95.45%, Validation Loss: 0.34534624218940735, Validation Accuracy: 83.02%
I0129 21:06:20.157035 139873101162304 train.py:188] Step 5500, Loss: 0.10553420335054398, Accuracy: 96.30%, Validation Loss: 0.3149467706680298, Validation Accuracy: 88.68%
I0129 21:06:43.886627 139873101162304 train.py:188] Step 5750, Loss: 0.11264698952436447, Accuracy: 95.92%, Validation Loss: 0.35152092576026917, Validation Accuracy: 93.40%
I0129 21:07:07.284428 139873101162304 train.py:188] Step 6000, Loss: 0.10424429178237915, Accuracy: 96.24%, Validation Loss: 0.41233640909194946, Validation Accuracy: 85.85%
I0129 21:07:30.875943 139873101162304 train.py:188] Step 6250, Loss: 0.10642851889133453, Accuracy: 96.31%, Validation Loss: 0.25874924659729004, Validation Accuracy: 87.74%
I0129 21:07:54.306894 139873101162304 train.py:188] Step 6500, Loss: 0.09382202476263046, Accuracy: 96.79%, Validation Loss: 0.25506678223609924, Validation Accuracy: 88.68%
I0129 21:08:17.872123 139873101162304 train.py:188] Step 6750, Loss: 0.09682942181825638, Accuracy: 96.59%, Validation Loss: 0.258249431848526, Validation Accuracy: 91.51%
I0129 21:08:41.360466 139873101162304 train.py:188] Step 7000, Loss: 0.10286033153533936, Accuracy: 96.42%, Validation Loss: 0.865225613117218, Validation Accuracy: 78.30%
I0129 21:09:04.990523 139873101162304 train.py:188] Step 7250, Loss: 0.10432600229978561, Accuracy: 96.38%, Validation Loss: 0.961033821105957, Validation Accuracy: 79.25%
I0129 21:09:28.167037 139873101162304 train.py:188] Step 7500, Loss: 0.09351399540901184, Accuracy: 96.64%, Validation Loss: 0.7402414083480835, Validation Accuracy: 84.91%
I0129 21:09:28.186061 139873101162304 train.py:222] Finished training after 7500 steps.
I0129 21:09:28.203097 139873101162304 eval.py:22] 
======== Starting Evaluation ========
I0129 21:09:28.212713 139873101162304 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/ckpts
I0129 21:09:28.361408 139873101162304 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       93.39622641509435
Balanced_Acc:         93.4116809116809
Sensitivity:          94.23076923076923
Specificity:          92.5925925925926
F1_Score:             93.33333333333333
Confusion_matrix:   
                   [49  4]
                   [ 3 50]


I0129 21:09:28.496574 139873101162304 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       76.69902912621359
Balanced_Acc:         75.3875968992248
Sensitivity:          67.44186046511628
Specificity:          83.33333333333334
F1_Score:             70.73170731707317
Confusion_matrix:   
                   [29 10]
                   [14 50]


I0129 21:09:28.496978 139873101162304 eval.py:66] ======== Finished Evaluation ========
I0129 21:09:28.497416 139873101162304 visualization.py:90] 
======== Starting DeepVis ========
I0129 21:09:29.014083 139873101162304 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/plot/train/deepvis_IDRiD_001.jpg
I0129 21:09:29.365061 139873101162304 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/plot/test/deepvis_IDRiD_001.jpg
I0129 21:09:29.722361 139873101162304 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/plot/train/deepvis_IDRiD_009.jpg
I0129 21:09:30.074954 139873101162304 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T20-57-38-270312/plot/test/deepvis_IDRiD_009.jpg
I0129 21:09:30.135102 139873101162304 visualization.py:165] ======== Finished DeepVis ========
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 128, 5)       140       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 126, 126, 10)      460       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 63, 63, 10)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 63, 63, 10)        40        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 20)        1820      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 20)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 30, 30, 20)        80        
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 40)        7240      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 14, 14, 40)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 14, 14, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 40)                0         
_________________________________________________________________
dense (Dense)                (None, 30)                1230      
_________________________________________________________________
dropout (Dropout)            (None, 30)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 62        
=================================================================
Total params: 11,232
Trainable params: 11,092
Non-trainable params: 140
_________________________________________________________________
2022-01-29 21:09:33.529340: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 21:09:33.928059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 21:09:34.244634 139860839728960 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 21:09:35.527429 139860839728960 main.py:117] Running model: cnn_blueprint
I0129 21:09:35.528414 139860839728960 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605
I0129 21:09:35.528491 139860839728960 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-210935
I0129 21:09:35.538830 139860839728960 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 21:09:35.538898 139860839728960 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts
I0129 21:09:35.538930 139860839728960 train.py:171] 
======== Starting Training ========
2022-01-29 21:09:35.563718: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 21:09:36.914348: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 21:10:01.996356 139860839728960 train.py:188] Step 250, Loss: 0.5926477313041687, Accuracy: 67.41%, Validation Loss: 0.689307689666748, Validation Accuracy: 60.38%
I0129 21:10:02.010562 139860839728960 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts.
I0129 21:10:25.214645 139860839728960 train.py:188] Step 500, Loss: 0.5311418771743774, Accuracy: 72.75%, Validation Loss: 0.6754370927810669, Validation Accuracy: 54.72%
I0129 21:10:48.715931 139860839728960 train.py:188] Step 750, Loss: 0.47093555331230164, Accuracy: 77.12%, Validation Loss: 0.5862851142883301, Validation Accuracy: 68.87%
I0129 21:10:48.738283 139860839728960 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts.
I0129 21:11:11.927826 139860839728960 train.py:188] Step 1000, Loss: 0.40307632088661194, Accuracy: 81.65%, Validation Loss: 0.5013998746871948, Validation Accuracy: 77.36%
I0129 21:11:11.946179 139860839728960 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts.
I0129 21:11:35.486942 139860839728960 train.py:188] Step 1250, Loss: 0.34055840969085693, Accuracy: 85.42%, Validation Loss: 0.4115479588508606, Validation Accuracy: 76.42%
I0129 21:11:58.850657 139860839728960 train.py:188] Step 1500, Loss: 0.3012716770172119, Accuracy: 87.50%, Validation Loss: 0.4138852655887604, Validation Accuracy: 83.96%
I0129 21:11:58.884192 139860839728960 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts.
I0129 21:12:22.342313 139860839728960 train.py:188] Step 1750, Loss: 0.26440107822418213, Accuracy: 89.22%, Validation Loss: 0.4938073754310608, Validation Accuracy: 76.42%
I0129 21:12:45.657710 139860839728960 train.py:188] Step 2000, Loss: 0.2270822823047638, Accuracy: 91.00%, Validation Loss: 0.45062127709388733, Validation Accuracy: 70.75%
I0129 21:13:09.442067 139860839728960 train.py:188] Step 2250, Loss: 0.20866459608078003, Accuracy: 92.05%, Validation Loss: 0.4282488226890564, Validation Accuracy: 76.42%
I0129 21:13:32.976917 139860839728960 train.py:188] Step 2500, Loss: 0.20055051147937775, Accuracy: 92.42%, Validation Loss: 0.58566814661026, Validation Accuracy: 74.53%
I0129 21:13:56.685369 139860839728960 train.py:188] Step 2750, Loss: 0.18217037618160248, Accuracy: 93.25%, Validation Loss: 0.2564834654331207, Validation Accuracy: 89.62%
I0129 21:13:56.699166 139860839728960 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts.
I0129 21:14:19.972146 139860839728960 train.py:188] Step 3000, Loss: 0.18093465268611908, Accuracy: 93.32%, Validation Loss: 0.3246094584465027, Validation Accuracy: 84.91%
I0129 21:14:43.507995 139860839728960 train.py:188] Step 3250, Loss: 0.15421436727046967, Accuracy: 94.18%, Validation Loss: 0.4679052531719208, Validation Accuracy: 80.19%
I0129 21:15:06.930391 139860839728960 train.py:188] Step 3500, Loss: 0.15226343274116516, Accuracy: 94.60%, Validation Loss: 0.33865734934806824, Validation Accuracy: 83.96%
I0129 21:15:30.551230 139860839728960 train.py:188] Step 3750, Loss: 0.14311549067497253, Accuracy: 94.82%, Validation Loss: 0.3975045680999756, Validation Accuracy: 86.79%
I0129 21:15:53.868334 139860839728960 train.py:188] Step 4000, Loss: 0.1356019675731659, Accuracy: 95.34%, Validation Loss: 0.37119778990745544, Validation Accuracy: 79.25%
I0129 21:16:17.563160 139860839728960 train.py:188] Step 4250, Loss: 0.12108650803565979, Accuracy: 95.67%, Validation Loss: 0.4953756630420685, Validation Accuracy: 82.08%
I0129 21:16:40.864780 139860839728960 train.py:188] Step 4500, Loss: 0.1332908719778061, Accuracy: 95.56%, Validation Loss: 0.8618239164352417, Validation Accuracy: 64.15%
I0129 21:17:04.338283 139860839728960 train.py:188] Step 4750, Loss: 0.10917685925960541, Accuracy: 96.13%, Validation Loss: 0.39671775698661804, Validation Accuracy: 78.30%
I0129 21:17:27.875625 139860839728960 train.py:188] Step 5000, Loss: 0.14808790385723114, Accuracy: 94.98%, Validation Loss: 0.6863740682601929, Validation Accuracy: 78.30%
I0129 21:17:51.414921 139860839728960 train.py:188] Step 5250, Loss: 0.1017061397433281, Accuracy: 96.43%, Validation Loss: 0.4322455823421478, Validation Accuracy: 88.68%
I0129 21:18:14.829983 139860839728960 train.py:188] Step 5500, Loss: 0.10635240375995636, Accuracy: 96.38%, Validation Loss: 0.4156304597854614, Validation Accuracy: 83.96%
I0129 21:18:38.490682 139860839728960 train.py:188] Step 5750, Loss: 0.10676521062850952, Accuracy: 96.62%, Validation Loss: 0.6760827302932739, Validation Accuracy: 80.19%
I0129 21:19:01.982971 139860839728960 train.py:188] Step 6000, Loss: 0.08915688097476959, Accuracy: 97.06%, Validation Loss: 0.8039588332176208, Validation Accuracy: 84.91%
I0129 21:19:25.463398 139860839728960 train.py:188] Step 6250, Loss: 0.1037842258810997, Accuracy: 96.41%, Validation Loss: 1.047494649887085, Validation Accuracy: 77.36%
I0129 21:19:48.903605 139860839728960 train.py:188] Step 6500, Loss: 0.09188606590032578, Accuracy: 97.07%, Validation Loss: 0.614905059337616, Validation Accuracy: 83.02%
I0129 21:20:12.491394 139860839728960 train.py:188] Step 6750, Loss: 0.08767307549715042, Accuracy: 97.06%, Validation Loss: 1.3810980319976807, Validation Accuracy: 78.30%
I0129 21:20:35.883715 139860839728960 train.py:188] Step 7000, Loss: 0.09863874316215515, Accuracy: 96.78%, Validation Loss: 0.8614065647125244, Validation Accuracy: 74.53%
I0129 21:20:59.469968 139860839728960 train.py:188] Step 7250, Loss: 0.08611225336790085, Accuracy: 97.19%, Validation Loss: 0.47933295369148254, Validation Accuracy: 88.68%
I0129 21:21:22.778437 139860839728960 train.py:188] Step 7500, Loss: 0.07529397308826447, Accuracy: 97.51%, Validation Loss: 0.7600903511047363, Validation Accuracy: 75.47%
I0129 21:21:22.803896 139860839728960 train.py:222] Finished training after 7500 steps.
I0129 21:21:22.820350 139860839728960 eval.py:22] 
======== Starting Evaluation ========
I0129 21:21:22.828545 139860839728960 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/ckpts
I0129 21:21:22.974708 139860839728960 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       89.62264150943396
Balanced_Acc:         90.32608695652173
Sensitivity:          95.65217391304348
Specificity:          85.0
F1_Score:             88.8888888888889
Confusion_matrix:   
                   [44  9]
                   [ 2 51]


I0129 21:21:23.108931 139860839728960 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       72.81553398058253
Balanced_Acc:         71.37096774193547
Sensitivity:          67.74193548387096
Specificity:          75.0
F1_Score:             60.0
Confusion_matrix:   
                   [21 18]
                   [10 54]


I0129 21:21:23.109201 139860839728960 eval.py:66] ======== Finished Evaluation ========
I0129 21:21:23.109481 139860839728960 visualization.py:90] 
======== Starting DeepVis ========
I0129 21:21:23.619990 139860839728960 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/plot/train/deepvis_IDRiD_001.jpg
I0129 21:21:23.969228 139860839728960 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/plot/test/deepvis_IDRiD_001.jpg
I0129 21:21:24.327439 139860839728960 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/plot/train/deepvis_IDRiD_009.jpg
I0129 21:21:24.678125 139860839728960 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-09-34-238605/plot/test/deepvis_IDRiD_009.jpg
I0129 21:21:24.738582 139860839728960 visualization.py:165] ======== Finished DeepVis ========
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 128, 5)       140       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 126, 126, 10)      460       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 63, 63, 10)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 63, 63, 10)        40        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 20)        1820      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 20)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 30, 30, 20)        80        
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 40)        7240      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 14, 14, 40)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 14, 14, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 40)                0         
_________________________________________________________________
dense (Dense)                (None, 30)                1230      
_________________________________________________________________
dropout (Dropout)            (None, 30)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 62        
=================================================================
Total params: 11,232
Trainable params: 11,092
Non-trainable params: 140
_________________________________________________________________
2022-01-29 21:21:28.147859: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 21:21:28.541534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 21:21:28.854576 139718094358336 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 21:21:30.156598 139718094358336 main.py:117] Running model: cnn_blueprint
I0129 21:21:30.157583 139718094358336 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540
I0129 21:21:30.157650 139718094358336 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-212130
I0129 21:21:30.168057 139718094358336 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 21:21:30.168118 139718094358336 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts
I0129 21:21:30.168152 139718094358336 train.py:171] 
======== Starting Training ========
2022-01-29 21:21:30.193250: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 21:21:31.544036: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 21:21:56.558068 139718094358336 train.py:188] Step 250, Loss: 0.5403062701225281, Accuracy: 71.69%, Validation Loss: 0.8787470459938049, Validation Accuracy: 50.00%
I0129 21:21:56.571601 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:22:19.761357 139718094358336 train.py:188] Step 500, Loss: 0.4152044951915741, Accuracy: 79.82%, Validation Loss: 0.9977738261222839, Validation Accuracy: 51.89%
I0129 21:22:19.793183 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:22:43.358714 139718094358336 train.py:188] Step 750, Loss: 0.3684289753437042, Accuracy: 83.26%, Validation Loss: 0.39544129371643066, Validation Accuracy: 76.42%
I0129 21:22:43.380023 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:23:06.814330 139718094358336 train.py:188] Step 1000, Loss: 0.3181711435317993, Accuracy: 86.24%, Validation Loss: 0.26710131764411926, Validation Accuracy: 83.02%
I0129 21:23:06.842160 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:23:30.467166 139718094358336 train.py:188] Step 1250, Loss: 0.2852175235748291, Accuracy: 87.50%, Validation Loss: 0.35582080483436584, Validation Accuracy: 82.08%
I0129 21:23:53.879505 139718094358336 train.py:188] Step 1500, Loss: 0.2638018727302551, Accuracy: 88.81%, Validation Loss: 0.47526293992996216, Validation Accuracy: 83.96%
I0129 21:23:53.902555 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:24:17.664533 139718094358336 train.py:188] Step 1750, Loss: 0.2437904328107834, Accuracy: 89.85%, Validation Loss: 0.9133561849594116, Validation Accuracy: 67.92%
I0129 21:24:41.027945 139718094358336 train.py:188] Step 2000, Loss: 0.2414284199476242, Accuracy: 90.08%, Validation Loss: 0.41627195477485657, Validation Accuracy: 85.85%
I0129 21:24:41.051523 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:25:04.809862 139718094358336 train.py:188] Step 2250, Loss: 0.2190341204404831, Accuracy: 90.84%, Validation Loss: 0.30665621161460876, Validation Accuracy: 86.79%
I0129 21:25:04.831073 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:25:27.907207 139718094358336 train.py:188] Step 2500, Loss: 0.20464853942394257, Accuracy: 91.73%, Validation Loss: 1.1125408411026, Validation Accuracy: 61.32%
I0129 21:25:51.433697 139718094358336 train.py:188] Step 2750, Loss: 0.19022178649902344, Accuracy: 92.28%, Validation Loss: 1.3120194673538208, Validation Accuracy: 64.15%
I0129 21:26:14.753911 139718094358336 train.py:188] Step 3000, Loss: 0.1912865936756134, Accuracy: 92.38%, Validation Loss: 0.3336937427520752, Validation Accuracy: 86.79%
I0129 21:26:38.435068 139718094358336 train.py:188] Step 3250, Loss: 0.1730022132396698, Accuracy: 93.31%, Validation Loss: 0.2929058372974396, Validation Accuracy: 89.62%
I0129 21:26:38.457158 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:27:01.865323 139718094358336 train.py:188] Step 3500, Loss: 0.16199138760566711, Accuracy: 93.84%, Validation Loss: 0.6951332688331604, Validation Accuracy: 68.87%
I0129 21:27:25.438313 139718094358336 train.py:188] Step 3750, Loss: 0.15647174417972565, Accuracy: 94.15%, Validation Loss: 0.23131459951400757, Validation Accuracy: 89.62%
I0129 21:27:48.598047 139718094358336 train.py:188] Step 4000, Loss: 0.17097139358520508, Accuracy: 93.61%, Validation Loss: 0.2578207552433014, Validation Accuracy: 91.51%
I0129 21:27:48.616185 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:28:12.271363 139718094358336 train.py:188] Step 4250, Loss: 0.14345161616802216, Accuracy: 94.52%, Validation Loss: 0.3066709637641907, Validation Accuracy: 84.91%
I0129 21:28:35.564222 139718094358336 train.py:188] Step 4500, Loss: 0.14034830033779144, Accuracy: 94.70%, Validation Loss: 0.4402744770050049, Validation Accuracy: 88.68%
I0129 21:28:59.021618 139718094358336 train.py:188] Step 4750, Loss: 0.13881121575832367, Accuracy: 94.48%, Validation Loss: 0.3968760073184967, Validation Accuracy: 87.74%
I0129 21:29:22.243724 139718094358336 train.py:188] Step 5000, Loss: 0.1800353229045868, Accuracy: 93.28%, Validation Loss: 0.9177402257919312, Validation Accuracy: 71.70%
I0129 21:29:45.796316 139718094358336 train.py:188] Step 5250, Loss: 0.1363077610731125, Accuracy: 94.93%, Validation Loss: 0.22707316279411316, Validation Accuracy: 91.51%
I0129 21:30:09.211364 139718094358336 train.py:188] Step 5500, Loss: 0.12135924398899078, Accuracy: 95.39%, Validation Loss: 4.089804172515869, Validation Accuracy: 60.38%
I0129 21:30:32.751935 139718094358336 train.py:188] Step 5750, Loss: 0.12927654385566711, Accuracy: 95.29%, Validation Loss: 0.6603640913963318, Validation Accuracy: 86.79%
I0129 21:30:56.043073 139718094358336 train.py:188] Step 6000, Loss: 0.13020417094230652, Accuracy: 94.99%, Validation Loss: 0.7299202084541321, Validation Accuracy: 75.47%
I0129 21:31:19.667199 139718094358336 train.py:188] Step 6250, Loss: 0.11754373461008072, Accuracy: 95.63%, Validation Loss: 0.25387486815452576, Validation Accuracy: 89.62%
I0129 21:31:42.917463 139718094358336 train.py:188] Step 6500, Loss: 0.11264856904745102, Accuracy: 95.82%, Validation Loss: 1.2796789407730103, Validation Accuracy: 73.58%
I0129 21:32:06.401221 139718094358336 train.py:188] Step 6750, Loss: 0.11731091886758804, Accuracy: 95.47%, Validation Loss: 0.3669527769088745, Validation Accuracy: 85.85%
I0129 21:32:29.719580 139718094358336 train.py:188] Step 7000, Loss: 0.11544489860534668, Accuracy: 95.95%, Validation Loss: 0.5588991641998291, Validation Accuracy: 75.47%
I0129 21:32:53.335479 139718094358336 train.py:188] Step 7250, Loss: 0.11745050549507141, Accuracy: 95.85%, Validation Loss: 0.13803939521312714, Validation Accuracy: 94.34%
I0129 21:32:53.376141 139718094358336 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts.
I0129 21:33:16.698077 139718094358336 train.py:188] Step 7500, Loss: 0.10275175422430038, Accuracy: 96.28%, Validation Loss: 0.5515496134757996, Validation Accuracy: 80.19%
I0129 21:33:16.731322 139718094358336 train.py:222] Finished training after 7500 steps.
I0129 21:33:16.751494 139718094358336 eval.py:22] 
======== Starting Evaluation ========
I0129 21:33:16.764120 139718094358336 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/ckpts
I0129 21:33:16.917473 139718094358336 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       94.33962264150944
Balanced_Acc:         94.59362692445399
Sensitivity:          97.95918367346938
Specificity:          91.22807017543859
F1_Score:             94.11764705882352
Confusion_matrix:   
                   [48  5]
                   [ 1 52]


I0129 21:33:17.043644 139718094358336 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       76.69902912621359
Balanced_Acc:         75.3875968992248
Sensitivity:          67.44186046511628
Specificity:          83.33333333333334
F1_Score:             70.73170731707317
Confusion_matrix:   
                   [29 10]
                   [14 50]


I0129 21:33:17.043902 139718094358336 eval.py:66] ======== Finished Evaluation ========
I0129 21:33:17.044187 139718094358336 visualization.py:90] 
======== Starting DeepVis ========
I0129 21:33:17.575262 139718094358336 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/plot/train/deepvis_IDRiD_001.jpg
I0129 21:33:17.928495 139718094358336 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/plot/test/deepvis_IDRiD_001.jpg
I0129 21:33:18.284406 139718094358336 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/plot/train/deepvis_IDRiD_009.jpg
I0129 21:33:18.636327 139718094358336 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-21-28-848540/plot/test/deepvis_IDRiD_009.jpg
I0129 21:33:18.696987 139718094358336 visualization.py:165] ======== Finished DeepVis ========
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 128, 5)       140       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 126, 126, 10)      460       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 63, 63, 10)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 63, 63, 10)        40        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 20)        1820      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 20)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 30, 30, 20)        80        
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 40)        7240      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 14, 14, 40)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 14, 14, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 40)                0         
_________________________________________________________________
dense (Dense)                (None, 30)                1230      
_________________________________________________________________
dropout (Dropout)            (None, 30)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 62        
=================================================================
Total params: 11,232
Trainable params: 11,092
Non-trainable params: 140
_________________________________________________________________
2022-01-29 21:33:22.118852: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 21:33:22.522194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 21:33:22.838031 139883811284800 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 21:33:24.110331 139883811284800 main.py:117] Running model: cnn_blueprint
I0129 21:33:24.111314 139883811284800 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013
I0129 21:33:24.111382 139883811284800 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-213324
I0129 21:33:24.121826 139883811284800 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 21:33:24.121893 139883811284800 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts
I0129 21:33:24.121927 139883811284800 train.py:171] 
======== Starting Training ========
2022-01-29 21:33:24.151183: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 21:33:25.486416: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 21:33:50.638038 139883811284800 train.py:188] Step 250, Loss: 0.5656803250312805, Accuracy: 69.60%, Validation Loss: 0.6820131540298462, Validation Accuracy: 52.83%
I0129 21:33:50.651015 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:34:13.796386 139883811284800 train.py:188] Step 500, Loss: 0.4900670647621155, Accuracy: 75.22%, Validation Loss: 0.6214798092842102, Validation Accuracy: 66.98%
I0129 21:34:13.826542 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:34:37.440400 139883811284800 train.py:188] Step 750, Loss: 0.38361531496047974, Accuracy: 82.06%, Validation Loss: 0.427472323179245, Validation Accuracy: 74.53%
I0129 21:34:37.466266 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:35:00.841867 139883811284800 train.py:188] Step 1000, Loss: 0.33238714933395386, Accuracy: 84.82%, Validation Loss: 0.6422126293182373, Validation Accuracy: 70.75%
I0129 21:35:24.486710 139883811284800 train.py:188] Step 1250, Loss: 0.29555150866508484, Accuracy: 86.79%, Validation Loss: 0.4756529927253723, Validation Accuracy: 78.30%
I0129 21:35:24.506663 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:35:47.752570 139883811284800 train.py:188] Step 1500, Loss: 0.27926433086395264, Accuracy: 88.18%, Validation Loss: 0.4259617328643799, Validation Accuracy: 80.19%
I0129 21:35:47.778447 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:36:11.582971 139883811284800 train.py:188] Step 1750, Loss: 0.25020337104797363, Accuracy: 89.53%, Validation Loss: 0.24521808326244354, Validation Accuracy: 89.62%
I0129 21:36:11.606623 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:36:35.295517 139883811284800 train.py:188] Step 2000, Loss: 0.23574885725975037, Accuracy: 90.35%, Validation Loss: 0.32877683639526367, Validation Accuracy: 85.85%
I0129 21:36:58.902532 139883811284800 train.py:188] Step 2250, Loss: 0.21087178587913513, Accuracy: 91.59%, Validation Loss: 0.3261925280094147, Validation Accuracy: 85.85%
I0129 21:37:22.306348 139883811284800 train.py:188] Step 2500, Loss: 0.1926092654466629, Accuracy: 92.35%, Validation Loss: 0.2399984747171402, Validation Accuracy: 86.79%
I0129 21:37:45.947255 139883811284800 train.py:188] Step 2750, Loss: 0.19168640673160553, Accuracy: 92.50%, Validation Loss: 0.7572355270385742, Validation Accuracy: 77.36%
I0129 21:38:09.520065 139883811284800 train.py:188] Step 3000, Loss: 0.17055867612361908, Accuracy: 93.50%, Validation Loss: 0.3439650535583496, Validation Accuracy: 84.91%
I0129 21:38:33.225682 139883811284800 train.py:188] Step 3250, Loss: 0.16817311942577362, Accuracy: 93.57%, Validation Loss: 0.9993802309036255, Validation Accuracy: 83.96%
I0129 21:38:56.654790 139883811284800 train.py:188] Step 3500, Loss: 0.1564042717218399, Accuracy: 94.00%, Validation Loss: 0.38935917615890503, Validation Accuracy: 86.79%
I0129 21:39:20.289263 139883811284800 train.py:188] Step 3750, Loss: 0.1449732929468155, Accuracy: 94.78%, Validation Loss: 0.20150130987167358, Validation Accuracy: 92.45%
I0129 21:39:20.316968 139883811284800 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts.
I0129 21:39:43.709744 139883811284800 train.py:188] Step 4000, Loss: 0.14408522844314575, Accuracy: 94.54%, Validation Loss: 0.20535056293010712, Validation Accuracy: 89.62%
I0129 21:40:07.441065 139883811284800 train.py:188] Step 4250, Loss: 0.13163083791732788, Accuracy: 95.03%, Validation Loss: 0.3153599202632904, Validation Accuracy: 85.85%
I0129 21:40:30.997875 139883811284800 train.py:188] Step 4500, Loss: 0.12196686118841171, Accuracy: 95.35%, Validation Loss: 0.9266214370727539, Validation Accuracy: 63.21%
I0129 21:40:54.628876 139883811284800 train.py:188] Step 4750, Loss: 0.13498088717460632, Accuracy: 95.28%, Validation Loss: 0.3636957108974457, Validation Accuracy: 85.85%
I0129 21:41:18.020262 139883811284800 train.py:188] Step 5000, Loss: 0.11586758494377136, Accuracy: 95.75%, Validation Loss: 0.24722464382648468, Validation Accuracy: 87.74%
I0129 21:41:41.801214 139883811284800 train.py:188] Step 5250, Loss: 0.1123989149928093, Accuracy: 95.93%, Validation Loss: 0.4397081434726715, Validation Accuracy: 88.68%
I0129 21:42:05.399221 139883811284800 train.py:188] Step 5500, Loss: 0.11708187311887741, Accuracy: 95.89%, Validation Loss: 0.4913865923881531, Validation Accuracy: 84.91%
I0129 21:42:29.078476 139883811284800 train.py:188] Step 5750, Loss: 0.10541965812444687, Accuracy: 96.31%, Validation Loss: 0.5366010069847107, Validation Accuracy: 85.85%
I0129 21:42:52.487172 139883811284800 train.py:188] Step 6000, Loss: 0.1125868558883667, Accuracy: 95.87%, Validation Loss: 0.32403862476348877, Validation Accuracy: 90.57%
I0129 21:43:16.277522 139883811284800 train.py:188] Step 6250, Loss: 0.10308518260717392, Accuracy: 96.38%, Validation Loss: 0.5690787434577942, Validation Accuracy: 83.96%
I0129 21:43:39.682302 139883811284800 train.py:188] Step 6500, Loss: 0.10745726525783539, Accuracy: 96.23%, Validation Loss: 0.360005646944046, Validation Accuracy: 84.91%
I0129 21:44:03.478878 139883811284800 train.py:188] Step 6750, Loss: 0.08961442112922668, Accuracy: 96.97%, Validation Loss: 0.2866457402706146, Validation Accuracy: 87.74%
I0129 21:44:26.817696 139883811284800 train.py:188] Step 7000, Loss: 0.08614528179168701, Accuracy: 96.86%, Validation Loss: 0.5505557656288147, Validation Accuracy: 77.36%
I0129 21:44:50.415107 139883811284800 train.py:188] Step 7250, Loss: 0.08853621035814285, Accuracy: 96.88%, Validation Loss: 0.22780486941337585, Validation Accuracy: 87.74%
I0129 21:45:13.785519 139883811284800 train.py:188] Step 7500, Loss: 0.08386798202991486, Accuracy: 97.01%, Validation Loss: 0.2946580648422241, Validation Accuracy: 89.62%
I0129 21:45:13.812926 139883811284800 train.py:222] Finished training after 7500 steps.
I0129 21:45:46.094676 139883811284800 eval.py:22] 
======== Starting Evaluation ========
I0129 21:45:46.101555 139883811284800 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/ckpts
I0129 21:45:46.256691 139883811284800 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         92.45283018867924
Sensitivity:          92.45283018867924
Specificity:          92.45283018867924
F1_Score:             92.45283018867924
Confusion_matrix:   
                   [49  4]
                   [ 4 49]


I0129 21:45:46.388566 139883811284800 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       77.66990291262135
Balanced_Acc:         76.29554655870446
Sensitivity:          71.05263157894737
Specificity:          81.53846153846153
F1_Score:             70.12987012987013
Confusion_matrix:   
                   [27 12]
                   [11 53]


I0129 21:45:46.388821 139883811284800 eval.py:66] ======== Finished Evaluation ========
I0129 21:45:46.389116 139883811284800 visualization.py:90] 
======== Starting DeepVis ========
I0129 21:45:46.903396 139883811284800 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/plot/train/deepvis_IDRiD_001.jpg
I0129 21:45:47.255161 139883811284800 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/plot/test/deepvis_IDRiD_001.jpg
I0129 21:45:47.610292 139883811284800 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/plot/train/deepvis_IDRiD_009.jpg
I0129 21:45:47.962685 139883811284800 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-33-22-832013/plot/test/deepvis_IDRiD_009.jpg
I0129 21:45:48.023036 139883811284800 visualization.py:165] ======== Finished DeepVis ========
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 128, 5)       140       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 126, 126, 10)      460       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 63, 63, 10)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 63, 63, 10)        40        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 20)        1820      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 20)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 30, 30, 20)        80        
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 40)        7240      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 14, 14, 40)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 14, 14, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 40)                0         
_________________________________________________________________
dense (Dense)                (None, 30)                1230      
_________________________________________________________________
dropout (Dropout)            (None, 30)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 62        
=================================================================
Total params: 11,232
Trainable params: 11,092
Non-trainable params: 140
_________________________________________________________________
2022-01-29 21:45:51.433036: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 21:45:51.837531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 21:45:52.154169 140156176652096 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 21:45:53.442219 140156176652096 architectures.py:84] team20_cnn_01 input shape:  (None, 256, 256, 3)
I0129 21:45:53.442351 140156176652096 architectures.py:85] team20_cnn_01 output shape: (None, 2)
I0129 21:45:53.442553 140156176652096 main.py:117] Running model: cnn_01
I0129 21:45:53.443302 140156176652096 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213
I0129 21:45:53.443368 140156176652096 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-214553
I0129 21:45:53.453662 140156176652096 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 21:45:53.453727 140156176652096 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts
I0129 21:45:53.453759 140156176652096 train.py:171] 
======== Starting Training ========
2022-01-29 21:45:53.478614: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 21:45:54.796196: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 21:46:20.066859 140156176652096 train.py:188] Step 250, Loss: 0.5855145454406738, Accuracy: 69.17%, Validation Loss: 0.6910368800163269, Validation Accuracy: 50.00%
I0129 21:46:20.082047 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:46:43.475934 140156176652096 train.py:188] Step 500, Loss: 0.5666511058807373, Accuracy: 70.16%, Validation Loss: 0.651800811290741, Validation Accuracy: 50.00%
I0129 21:47:07.392582 140156176652096 train.py:188] Step 750, Loss: 0.5330730080604553, Accuracy: 72.21%, Validation Loss: 0.5575849413871765, Validation Accuracy: 68.87%
I0129 21:47:07.410840 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:47:30.729525 140156176652096 train.py:188] Step 1000, Loss: 0.5013989806175232, Accuracy: 74.65%, Validation Loss: 0.4915161728858948, Validation Accuracy: 80.19%
I0129 21:47:30.763666 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:47:54.403848 140156176652096 train.py:188] Step 1250, Loss: 0.48826056718826294, Accuracy: 76.19%, Validation Loss: 0.38015758991241455, Validation Accuracy: 83.96%
I0129 21:47:54.437049 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:48:17.688329 140156176652096 train.py:188] Step 1500, Loss: 0.44242584705352783, Accuracy: 78.46%, Validation Loss: 0.5160248279571533, Validation Accuracy: 73.58%
I0129 21:48:41.532049 140156176652096 train.py:188] Step 1750, Loss: 0.3854193389415741, Accuracy: 82.38%, Validation Loss: 0.4723900258541107, Validation Accuracy: 82.08%
I0129 21:49:05.177464 140156176652096 train.py:188] Step 2000, Loss: 0.34757962822914124, Accuracy: 84.63%, Validation Loss: 0.2840738594532013, Validation Accuracy: 89.62%
I0129 21:49:05.205358 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:49:28.895996 140156176652096 train.py:188] Step 2250, Loss: 0.32701656222343445, Accuracy: 85.60%, Validation Loss: 0.24365945160388947, Validation Accuracy: 83.96%
I0129 21:49:52.387145 140156176652096 train.py:188] Step 2500, Loss: 0.3009590208530426, Accuracy: 87.16%, Validation Loss: 0.2999229431152344, Validation Accuracy: 86.79%
I0129 21:50:16.252202 140156176652096 train.py:188] Step 2750, Loss: 0.30264151096343994, Accuracy: 86.75%, Validation Loss: 0.25758081674575806, Validation Accuracy: 93.40%
I0129 21:50:16.271147 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:50:39.812683 140156176652096 train.py:188] Step 3000, Loss: 0.2752363085746765, Accuracy: 88.04%, Validation Loss: 0.45206791162490845, Validation Accuracy: 80.19%
I0129 21:51:03.499971 140156176652096 train.py:188] Step 3250, Loss: 0.25797751545906067, Accuracy: 89.28%, Validation Loss: 0.16920576989650726, Validation Accuracy: 96.23%
I0129 21:51:03.530517 140156176652096 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts.
I0129 21:51:26.967259 140156176652096 train.py:188] Step 3500, Loss: 0.2502281963825226, Accuracy: 89.61%, Validation Loss: 0.2854492664337158, Validation Accuracy: 83.96%
I0129 21:51:50.769201 140156176652096 train.py:188] Step 3750, Loss: 0.24714922904968262, Accuracy: 89.84%, Validation Loss: 0.46919897198677063, Validation Accuracy: 81.13%
I0129 21:52:14.386577 140156176652096 train.py:188] Step 4000, Loss: 0.22752732038497925, Accuracy: 90.61%, Validation Loss: 0.25647178292274475, Validation Accuracy: 87.74%
I0129 21:52:38.130617 140156176652096 train.py:188] Step 4250, Loss: 0.2175597846508026, Accuracy: 91.40%, Validation Loss: 0.2395673543214798, Validation Accuracy: 90.57%
I0129 21:53:01.685607 140156176652096 train.py:188] Step 4500, Loss: 0.22891920804977417, Accuracy: 90.98%, Validation Loss: 3.660653829574585, Validation Accuracy: 55.66%
I0129 21:53:25.554242 140156176652096 train.py:188] Step 4750, Loss: 0.24667610228061676, Accuracy: 89.68%, Validation Loss: 0.18241728842258453, Validation Accuracy: 95.28%
I0129 21:53:49.003894 140156176652096 train.py:188] Step 5000, Loss: 0.20199206471443176, Accuracy: 91.67%, Validation Loss: 0.187917560338974, Validation Accuracy: 92.45%
I0129 21:54:12.706557 140156176652096 train.py:188] Step 5250, Loss: 0.20592018961906433, Accuracy: 91.88%, Validation Loss: 0.1520509123802185, Validation Accuracy: 91.51%
I0129 21:54:36.009345 140156176652096 train.py:188] Step 5500, Loss: 0.2134425938129425, Accuracy: 91.49%, Validation Loss: 0.37815314531326294, Validation Accuracy: 83.02%
I0129 21:54:59.821911 140156176652096 train.py:188] Step 5750, Loss: 0.19102589786052704, Accuracy: 92.39%, Validation Loss: 0.1890919953584671, Validation Accuracy: 88.68%
I0129 21:55:23.535250 140156176652096 train.py:188] Step 6000, Loss: 0.18860505521297455, Accuracy: 92.49%, Validation Loss: 0.2887837886810303, Validation Accuracy: 84.91%
I0129 21:55:47.385483 140156176652096 train.py:188] Step 6250, Loss: 0.19129374623298645, Accuracy: 92.19%, Validation Loss: 0.14726482331752777, Validation Accuracy: 95.28%
I0129 21:56:10.862241 140156176652096 train.py:188] Step 6500, Loss: 0.18670068681240082, Accuracy: 92.45%, Validation Loss: 0.2215566784143448, Validation Accuracy: 93.40%
I0129 21:56:34.841691 140156176652096 train.py:188] Step 6750, Loss: 0.17471767961978912, Accuracy: 92.95%, Validation Loss: 1.350149154663086, Validation Accuracy: 84.91%
I0129 21:56:58.272608 140156176652096 train.py:188] Step 7000, Loss: 0.1925768405199051, Accuracy: 92.38%, Validation Loss: 0.23240001499652863, Validation Accuracy: 93.40%
I0129 21:57:21.950021 140156176652096 train.py:188] Step 7250, Loss: 0.18049979209899902, Accuracy: 92.78%, Validation Loss: 0.30474501848220825, Validation Accuracy: 90.57%
I0129 21:57:45.366623 140156176652096 train.py:188] Step 7500, Loss: 0.18316859006881714, Accuracy: 92.49%, Validation Loss: 0.17689307034015656, Validation Accuracy: 87.74%
I0129 21:57:45.394942 140156176652096 train.py:222] Finished training after 7500 steps.
I0129 21:57:45.420859 140156176652096 eval.py:22] 
======== Starting Evaluation ========
I0129 21:57:45.428767 140156176652096 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/ckpts
I0129 21:57:45.593003 140156176652096 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       96.22641509433963
Balanced_Acc:         96.49122807017544
Sensitivity:          100.0
Specificity:          92.98245614035088
F1_Score:             96.07843137254902
Confusion_matrix:   
                   [49  4]
                   [ 0 53]


I0129 21:57:45.741272 140156176652096 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       81.55339805825243
Balanced_Acc:         80.34738485558157
Sensitivity:          73.80952380952381
Specificity:          86.88524590163934
F1_Score:             76.54320987654322
Confusion_matrix:   
                   [31  8]
                   [11 53]


I0129 21:57:45.741523 140156176652096 eval.py:66] ======== Finished Evaluation ========
I0129 21:57:45.741795 140156176652096 visualization.py:90] 
======== Starting DeepVis ========
I0129 21:57:46.274411 140156176652096 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/plot/train/deepvis_IDRiD_001.jpg
I0129 21:57:46.642368 140156176652096 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/plot/test/deepvis_IDRiD_001.jpg
I0129 21:57:47.000145 140156176652096 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/plot/train/deepvis_IDRiD_009.jpg
I0129 21:57:47.351594 140156176652096 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-45-52-148213/plot/test/deepvis_IDRiD_009.jpg
I0129 21:57:47.412384 140156176652096 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_01"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 252, 252, 4)       304       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 84, 84, 4)         0         
_________________________________________________________________
batch_normalization (BatchNo (None, 84, 84, 4)         16        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 82, 82, 32)        1184      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 27, 27, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 27, 27, 32)        128       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 25, 25, 64)        18496     
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0         
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense (Dense)                (None, 16)                1040      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 21,202
Trainable params: 21,130
Non-trainable params: 72
_________________________________________________________________
2022-01-29 21:57:50.816414: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 21:57:51.219177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 21:57:51.533549 139929148282688 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 21:57:52.804596 139929148282688 architectures.py:84] team20_cnn_01 input shape:  (None, 256, 256, 3)
I0129 21:57:52.804728 139929148282688 architectures.py:85] team20_cnn_01 output shape: (None, 2)
I0129 21:57:52.804925 139929148282688 main.py:117] Running model: cnn_01
I0129 21:57:52.805641 139929148282688 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614
I0129 21:57:52.805705 139929148282688 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-215752
I0129 21:57:52.815953 139929148282688 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 21:57:52.816022 139929148282688 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts
I0129 21:57:52.816056 139929148282688 train.py:171] 
======== Starting Training ========
2022-01-29 21:57:52.840748: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 21:57:54.165782: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 21:58:19.602021 139929148282688 train.py:188] Step 250, Loss: 0.6112340092658997, Accuracy: 67.03%, Validation Loss: 0.6932750940322876, Validation Accuracy: 53.77%
I0129 21:58:19.616255 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 21:58:43.052308 139929148282688 train.py:188] Step 500, Loss: 0.5808594822883606, Accuracy: 69.25%, Validation Loss: 0.7462206482887268, Validation Accuracy: 53.77%
I0129 21:59:06.929589 139929148282688 train.py:188] Step 750, Loss: 0.564762532711029, Accuracy: 70.18%, Validation Loss: 0.8463785648345947, Validation Accuracy: 62.26%
I0129 21:59:06.953821 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 21:59:30.513955 139929148282688 train.py:188] Step 1000, Loss: 0.5530053377151489, Accuracy: 70.94%, Validation Loss: 0.5679662823677063, Validation Accuracy: 76.42%
I0129 21:59:30.535184 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 21:59:54.258966 139929148282688 train.py:188] Step 1250, Loss: 0.5418110489845276, Accuracy: 72.75%, Validation Loss: 0.5643754601478577, Validation Accuracy: 67.92%
I0129 22:00:17.826693 139929148282688 train.py:188] Step 1500, Loss: 0.5202850103378296, Accuracy: 74.14%, Validation Loss: 0.4883160889148712, Validation Accuracy: 74.53%
I0129 22:00:41.643121 139929148282688 train.py:188] Step 1750, Loss: 0.5024729371070862, Accuracy: 75.77%, Validation Loss: 0.5018108487129211, Validation Accuracy: 75.47%
I0129 22:01:05.164771 139929148282688 train.py:188] Step 2000, Loss: 0.4954644441604614, Accuracy: 76.25%, Validation Loss: 0.43404555320739746, Validation Accuracy: 77.36%
I0129 22:01:05.185578 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:01:28.737802 139929148282688 train.py:188] Step 2250, Loss: 0.4818321764469147, Accuracy: 77.14%, Validation Loss: 0.4098813831806183, Validation Accuracy: 86.79%
I0129 22:01:28.762185 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:01:52.120652 139929148282688 train.py:188] Step 2500, Loss: 0.4718281626701355, Accuracy: 77.38%, Validation Loss: 0.4303373396396637, Validation Accuracy: 78.30%
I0129 22:02:15.757767 139929148282688 train.py:188] Step 2750, Loss: 0.4823993444442749, Accuracy: 76.94%, Validation Loss: 0.4230589270591736, Validation Accuracy: 82.08%
I0129 22:02:38.912729 139929148282688 train.py:188] Step 3000, Loss: 0.4628925025463104, Accuracy: 77.94%, Validation Loss: 0.3694562613964081, Validation Accuracy: 86.79%
I0129 22:03:02.276998 139929148282688 train.py:188] Step 3250, Loss: 0.45287182927131653, Accuracy: 78.95%, Validation Loss: 0.4055188000202179, Validation Accuracy: 79.25%
I0129 22:03:25.292716 139929148282688 train.py:188] Step 3500, Loss: 0.4478054642677307, Accuracy: 79.23%, Validation Loss: 0.4410124719142914, Validation Accuracy: 78.30%
I0129 22:03:48.695396 139929148282688 train.py:188] Step 3750, Loss: 0.44979244470596313, Accuracy: 79.25%, Validation Loss: 0.36081576347351074, Validation Accuracy: 85.85%
I0129 22:04:11.796514 139929148282688 train.py:188] Step 4000, Loss: 0.42743009328842163, Accuracy: 80.33%, Validation Loss: 0.30293649435043335, Validation Accuracy: 87.74%
I0129 22:04:11.822134 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:04:35.157252 139929148282688 train.py:188] Step 4250, Loss: 0.40788063406944275, Accuracy: 81.48%, Validation Loss: 0.34659069776535034, Validation Accuracy: 84.91%
I0129 22:04:58.467249 139929148282688 train.py:188] Step 4500, Loss: 0.3842308521270752, Accuracy: 83.00%, Validation Loss: 0.6507159471511841, Validation Accuracy: 83.02%
I0129 22:05:21.743629 139929148282688 train.py:188] Step 4750, Loss: 0.3430676758289337, Accuracy: 84.97%, Validation Loss: 0.5968573689460754, Validation Accuracy: 73.58%
I0129 22:05:44.880563 139929148282688 train.py:188] Step 5000, Loss: 0.3286866545677185, Accuracy: 86.41%, Validation Loss: 0.23621049523353577, Validation Accuracy: 90.57%
I0129 22:05:44.898706 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:06:08.241332 139929148282688 train.py:188] Step 5250, Loss: 0.30027955770492554, Accuracy: 87.35%, Validation Loss: 0.21718338131904602, Validation Accuracy: 90.57%
I0129 22:06:31.385544 139929148282688 train.py:188] Step 5500, Loss: 0.2937299311161041, Accuracy: 87.77%, Validation Loss: 0.278131365776062, Validation Accuracy: 88.68%
I0129 22:06:54.702395 139929148282688 train.py:188] Step 5750, Loss: 0.26609620451927185, Accuracy: 89.14%, Validation Loss: 0.2385769933462143, Validation Accuracy: 87.74%
I0129 22:07:17.911409 139929148282688 train.py:188] Step 6000, Loss: 0.2696453928947449, Accuracy: 89.10%, Validation Loss: 0.19461871683597565, Validation Accuracy: 92.45%
I0129 22:07:17.936630 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:07:41.320158 139929148282688 train.py:188] Step 6250, Loss: 0.24270300567150116, Accuracy: 90.00%, Validation Loss: 0.45448407530784607, Validation Accuracy: 80.19%
I0129 22:08:04.278868 139929148282688 train.py:188] Step 6500, Loss: 0.23456141352653503, Accuracy: 90.66%, Validation Loss: 0.1973056048154831, Validation Accuracy: 88.68%
I0129 22:08:27.658127 139929148282688 train.py:188] Step 6750, Loss: 0.2333402931690216, Accuracy: 90.50%, Validation Loss: 0.17469815909862518, Validation Accuracy: 96.23%
I0129 22:08:27.676464 139929148282688 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts.
I0129 22:08:50.776531 139929148282688 train.py:188] Step 7000, Loss: 0.24219395220279694, Accuracy: 90.19%, Validation Loss: 0.24750925600528717, Validation Accuracy: 95.28%
I0129 22:09:14.316178 139929148282688 train.py:188] Step 7250, Loss: 0.22862549126148224, Accuracy: 91.17%, Validation Loss: 0.24473309516906738, Validation Accuracy: 89.62%
I0129 22:09:37.507047 139929148282688 train.py:188] Step 7500, Loss: 0.22282743453979492, Accuracy: 91.35%, Validation Loss: 0.17272602021694183, Validation Accuracy: 95.28%
I0129 22:09:37.549129 139929148282688 train.py:222] Finished training after 7500 steps.
I0129 22:09:37.584290 139929148282688 eval.py:22] 
======== Starting Evaluation ========
I0129 22:09:37.622585 139929148282688 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/ckpts
I0129 22:09:37.837050 139929148282688 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       96.22641509433963
Balanced_Acc:         96.49122807017544
Sensitivity:          100.0
Specificity:          92.98245614035088
F1_Score:             96.07843137254902
Confusion_matrix:   
                   [49  4]
                   [ 0 53]


I0129 22:09:37.983535 139929148282688 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       79.6116504854369
Balanced_Acc:         78.81500426257459
Sensitivity:          76.47058823529412
Specificity:          81.15942028985508
F1_Score:             71.23287671232877
Confusion_matrix:   
                   [26 13]
                   [ 8 56]


I0129 22:09:37.983792 139929148282688 eval.py:66] ======== Finished Evaluation ========
I0129 22:09:37.984113 139929148282688 visualization.py:90] 
======== Starting DeepVis ========
I0129 22:09:38.544384 139929148282688 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/plot/train/deepvis_IDRiD_001.jpg
I0129 22:09:38.896614 139929148282688 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/plot/test/deepvis_IDRiD_001.jpg
I0129 22:09:39.254484 139929148282688 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/plot/train/deepvis_IDRiD_009.jpg
I0129 22:09:39.607545 139929148282688 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T21-57-51-527614/plot/test/deepvis_IDRiD_009.jpg
I0129 22:09:39.667149 139929148282688 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_01"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 252, 252, 4)       304       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 84, 84, 4)         0         
_________________________________________________________________
batch_normalization (BatchNo (None, 84, 84, 4)         16        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 82, 82, 32)        1184      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 27, 27, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 27, 27, 32)        128       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 25, 25, 64)        18496     
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0         
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense (Dense)                (None, 16)                1040      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 21,202
Trainable params: 21,130
Non-trainable params: 72
_________________________________________________________________
2022-01-29 22:09:43.263170: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 22:09:43.683754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 22:09:44.004553 139715238897472 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 22:09:45.269330 139715238897472 architectures.py:84] team20_cnn_01 input shape:  (None, 256, 256, 3)
I0129 22:09:45.269457 139715238897472 architectures.py:85] team20_cnn_01 output shape: (None, 2)
I0129 22:09:45.269658 139715238897472 main.py:117] Running model: cnn_01
I0129 22:09:45.270377 139715238897472 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618
I0129 22:09:45.270441 139715238897472 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-220945
I0129 22:09:45.280809 139715238897472 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 22:09:45.280871 139715238897472 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts
I0129 22:09:45.280903 139715238897472 train.py:171] 
======== Starting Training ========
2022-01-29 22:09:45.305552: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 22:09:46.809709: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 22:10:12.776092 139715238897472 train.py:188] Step 250, Loss: 0.6074234843254089, Accuracy: 67.07%, Validation Loss: 0.6777791976928711, Validation Accuracy: 51.89%
I0129 22:10:12.791584 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:10:36.002839 139715238897472 train.py:188] Step 500, Loss: 0.5746569633483887, Accuracy: 69.77%, Validation Loss: 0.6340668797492981, Validation Accuracy: 70.75%
I0129 22:10:36.021999 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:10:59.568766 139715238897472 train.py:188] Step 750, Loss: 0.5569736361503601, Accuracy: 70.64%, Validation Loss: 0.7285165786743164, Validation Accuracy: 69.81%
I0129 22:11:22.841870 139715238897472 train.py:188] Step 1000, Loss: 0.5370123386383057, Accuracy: 73.21%, Validation Loss: 0.7867066860198975, Validation Accuracy: 71.70%
I0129 22:11:22.875369 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:11:46.531687 139715238897472 train.py:188] Step 1250, Loss: 0.5107126832008362, Accuracy: 74.74%, Validation Loss: 0.4836481213569641, Validation Accuracy: 78.30%
I0129 22:11:46.553192 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:12:09.957245 139715238897472 train.py:188] Step 1500, Loss: 0.4934282600879669, Accuracy: 76.38%, Validation Loss: 0.5004022717475891, Validation Accuracy: 79.25%
I0129 22:12:09.978621 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:12:33.566006 139715238897472 train.py:188] Step 1750, Loss: 0.4742206037044525, Accuracy: 77.57%, Validation Loss: 0.4491235613822937, Validation Accuracy: 79.25%
I0129 22:12:57.083539 139715238897472 train.py:188] Step 2000, Loss: 0.4469830393791199, Accuracy: 78.60%, Validation Loss: 0.45394259691238403, Validation Accuracy: 83.96%
I0129 22:12:57.105637 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:13:20.703318 139715238897472 train.py:188] Step 2250, Loss: 0.4143458902835846, Accuracy: 80.86%, Validation Loss: 0.3118509352207184, Validation Accuracy: 90.57%
I0129 22:13:20.724197 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:13:44.122630 139715238897472 train.py:188] Step 2500, Loss: 0.37042510509490967, Accuracy: 83.35%, Validation Loss: 0.3464343249797821, Validation Accuracy: 83.96%
I0129 22:14:07.855891 139715238897472 train.py:188] Step 2750, Loss: 0.34350135922431946, Accuracy: 85.08%, Validation Loss: 0.26790910959243774, Validation Accuracy: 86.79%
I0129 22:14:31.337848 139715238897472 train.py:188] Step 3000, Loss: 0.3214903175830841, Accuracy: 86.04%, Validation Loss: 0.24616758525371552, Validation Accuracy: 89.62%
I0129 22:14:54.884137 139715238897472 train.py:188] Step 3250, Loss: 0.3019329607486725, Accuracy: 86.86%, Validation Loss: 0.5864302515983582, Validation Accuracy: 71.70%
I0129 22:15:18.321151 139715238897472 train.py:188] Step 3500, Loss: 0.304198682308197, Accuracy: 87.18%, Validation Loss: 0.22067850828170776, Validation Accuracy: 92.45%
I0129 22:15:18.344460 139715238897472 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts.
I0129 22:15:42.014108 139715238897472 train.py:188] Step 3750, Loss: 0.2871829867362976, Accuracy: 87.79%, Validation Loss: 0.3106059730052948, Validation Accuracy: 82.08%
I0129 22:16:05.530532 139715238897472 train.py:188] Step 4000, Loss: 0.265183687210083, Accuracy: 88.90%, Validation Loss: 0.1741173416376114, Validation Accuracy: 91.51%
I0129 22:16:30.357903 139715238897472 train.py:188] Step 4250, Loss: 0.25072377920150757, Accuracy: 89.53%, Validation Loss: 0.2652454972267151, Validation Accuracy: 84.91%
I0129 22:16:53.832607 139715238897472 train.py:188] Step 4500, Loss: 0.2457476109266281, Accuracy: 89.77%, Validation Loss: 0.27390924096107483, Validation Accuracy: 90.57%
I0129 22:17:17.468534 139715238897472 train.py:188] Step 4750, Loss: 0.2328670173883438, Accuracy: 90.36%, Validation Loss: 0.2437535524368286, Validation Accuracy: 86.79%
I0129 22:17:40.846791 139715238897472 train.py:188] Step 5000, Loss: 0.2249828577041626, Accuracy: 90.81%, Validation Loss: 0.22709879279136658, Validation Accuracy: 87.74%
I0129 22:18:04.610971 139715238897472 train.py:188] Step 5250, Loss: 0.2201671600341797, Accuracy: 91.00%, Validation Loss: 0.2124156653881073, Validation Accuracy: 85.85%
I0129 22:18:27.998658 139715238897472 train.py:188] Step 5500, Loss: 0.212922140955925, Accuracy: 91.25%, Validation Loss: 0.5317922234535217, Validation Accuracy: 82.08%
I0129 22:18:51.598396 139715238897472 train.py:188] Step 5750, Loss: 0.21003910899162292, Accuracy: 91.39%, Validation Loss: 0.25620636343955994, Validation Accuracy: 85.85%
I0129 22:19:15.026769 139715238897472 train.py:188] Step 6000, Loss: 0.2124824970960617, Accuracy: 91.42%, Validation Loss: 0.29306110739707947, Validation Accuracy: 89.62%
I0129 22:19:38.613991 139715238897472 train.py:188] Step 6250, Loss: 0.20214806497097015, Accuracy: 91.69%, Validation Loss: 0.27152854204177856, Validation Accuracy: 87.74%
I0129 22:20:01.889097 139715238897472 train.py:188] Step 6500, Loss: 0.20073097944259644, Accuracy: 91.64%, Validation Loss: 0.2515954375267029, Validation Accuracy: 87.74%
I0129 22:20:25.829446 139715238897472 train.py:188] Step 6750, Loss: 0.1936277598142624, Accuracy: 92.20%, Validation Loss: 0.18689076602458954, Validation Accuracy: 89.62%
I0129 22:20:49.135661 139715238897472 train.py:188] Step 7000, Loss: 0.1911296248435974, Accuracy: 92.24%, Validation Loss: 0.249283105134964, Validation Accuracy: 86.79%
I0129 22:21:12.607204 139715238897472 train.py:188] Step 7250, Loss: 0.1898677945137024, Accuracy: 92.17%, Validation Loss: 0.2945253551006317, Validation Accuracy: 88.68%
I0129 22:21:36.160794 139715238897472 train.py:188] Step 7500, Loss: 0.1755003184080124, Accuracy: 92.56%, Validation Loss: 0.4579160213470459, Validation Accuracy: 87.74%
I0129 22:21:36.180301 139715238897472 train.py:222] Finished training after 7500 steps.
I0129 22:21:36.201390 139715238897472 eval.py:22] 
======== Starting Evaluation ========
I0129 22:21:36.209183 139715238897472 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/ckpts
I0129 22:21:36.369812 139715238897472 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         92.5133689839572
Sensitivity:          94.11764705882352
Specificity:          90.9090909090909
F1_Score:             92.3076923076923
Confusion_matrix:   
                   [48  5]
                   [ 3 50]


I0129 22:21:36.511825 139715238897472 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       76.69902912621359
Balanced_Acc:         75.57471264367817
Sensitivity:          66.66666666666666
Specificity:          84.48275862068965
F1_Score:             71.42857142857142
Confusion_matrix:   
                   [30  9]
                   [15 49]


I0129 22:21:36.512088 139715238897472 eval.py:66] ======== Finished Evaluation ========
I0129 22:21:36.512375 139715238897472 visualization.py:90] 
======== Starting DeepVis ========
I0129 22:21:37.047954 139715238897472 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/plot/train/deepvis_IDRiD_001.jpg
I0129 22:21:37.405349 139715238897472 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/plot/test/deepvis_IDRiD_001.jpg
I0129 22:21:37.767310 139715238897472 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/plot/train/deepvis_IDRiD_009.jpg
I0129 22:21:38.125188 139715238897472 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-09-43-998618/plot/test/deepvis_IDRiD_009.jpg
I0129 22:21:38.187273 139715238897472 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_01"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 252, 252, 4)       304       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 84, 84, 4)         0         
_________________________________________________________________
batch_normalization (BatchNo (None, 84, 84, 4)         16        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 82, 82, 32)        1184      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 27, 27, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 27, 27, 32)        128       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 25, 25, 64)        18496     
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0         
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense (Dense)                (None, 16)                1040      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 21,202
Trainable params: 21,130
Non-trainable params: 72
_________________________________________________________________
2022-01-29 22:21:41.671016: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 22:21:42.086775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 22:21:42.405315 140680428713792 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 22:21:43.721343 140680428713792 architectures.py:84] team20_cnn_01 input shape:  (None, 256, 256, 3)
I0129 22:21:43.721470 140680428713792 architectures.py:85] team20_cnn_01 output shape: (None, 2)
I0129 22:21:43.721667 140680428713792 main.py:117] Running model: cnn_01
I0129 22:21:43.722405 140680428713792 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245
I0129 22:21:43.722469 140680428713792 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-222143
I0129 22:21:43.733028 140680428713792 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 22:21:43.733092 140680428713792 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts
I0129 22:21:43.733132 140680428713792 train.py:171] 
======== Starting Training ========
2022-01-29 22:21:43.758746: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 22:21:45.104188: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 22:22:10.296108 140680428713792 train.py:188] Step 250, Loss: 0.6167569756507874, Accuracy: 66.12%, Validation Loss: 0.688239336013794, Validation Accuracy: 50.94%
I0129 22:22:10.310954 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:22:33.400138 140680428713792 train.py:188] Step 500, Loss: 0.5455154776573181, Accuracy: 71.95%, Validation Loss: 0.600109338760376, Validation Accuracy: 63.21%
I0129 22:22:33.424379 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:22:56.648574 140680428713792 train.py:188] Step 750, Loss: 0.5199181437492371, Accuracy: 73.94%, Validation Loss: 0.49429863691329956, Validation Accuracy: 74.53%
I0129 22:22:56.669981 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:23:19.522687 140680428713792 train.py:188] Step 1000, Loss: 0.4843660593032837, Accuracy: 76.02%, Validation Loss: 0.4372148811817169, Validation Accuracy: 83.96%
I0129 22:23:19.557187 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:23:42.667070 140680428713792 train.py:188] Step 1250, Loss: 0.46631956100463867, Accuracy: 77.94%, Validation Loss: 0.4418402910232544, Validation Accuracy: 75.47%
I0129 22:24:05.693249 140680428713792 train.py:188] Step 1500, Loss: 0.4225558340549469, Accuracy: 80.18%, Validation Loss: 0.3714642822742462, Validation Accuracy: 77.36%
I0129 22:24:29.167464 140680428713792 train.py:188] Step 1750, Loss: 0.37039080262184143, Accuracy: 83.06%, Validation Loss: 0.2995908260345459, Validation Accuracy: 84.91%
I0129 22:24:29.185544 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:24:52.470295 140680428713792 train.py:188] Step 2000, Loss: 0.3455606698989868, Accuracy: 84.93%, Validation Loss: 0.24611620604991913, Validation Accuracy: 89.62%
I0129 22:24:52.491142 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:25:15.784515 140680428713792 train.py:188] Step 2250, Loss: 0.32828283309936523, Accuracy: 85.55%, Validation Loss: 0.2645299732685089, Validation Accuracy: 86.79%
I0129 22:25:38.874693 140680428713792 train.py:188] Step 2500, Loss: 0.3111208975315094, Accuracy: 86.62%, Validation Loss: 0.26825767755508423, Validation Accuracy: 86.79%
I0129 22:26:02.023504 140680428713792 train.py:188] Step 2750, Loss: 0.2983715236186981, Accuracy: 87.06%, Validation Loss: 0.35546228289604187, Validation Accuracy: 84.91%
I0129 22:26:25.040528 140680428713792 train.py:188] Step 3000, Loss: 0.27732548117637634, Accuracy: 88.07%, Validation Loss: 0.27199360728263855, Validation Accuracy: 87.74%
I0129 22:26:48.133432 140680428713792 train.py:188] Step 3250, Loss: 0.2705872058868408, Accuracy: 88.46%, Validation Loss: 0.2513578236103058, Validation Accuracy: 91.51%
I0129 22:26:48.154870 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:27:11.117099 140680428713792 train.py:188] Step 3500, Loss: 0.26446807384490967, Accuracy: 88.95%, Validation Loss: 0.21617577970027924, Validation Accuracy: 86.79%
I0129 22:27:34.630564 140680428713792 train.py:188] Step 3750, Loss: 0.2556265890598297, Accuracy: 89.53%, Validation Loss: 0.2743820250034332, Validation Accuracy: 89.62%
I0129 22:27:57.661016 140680428713792 train.py:188] Step 4000, Loss: 0.2438272386789322, Accuracy: 90.04%, Validation Loss: 0.26975804567337036, Validation Accuracy: 84.91%
I0129 22:28:20.794285 140680428713792 train.py:188] Step 4250, Loss: 0.23531316220760345, Accuracy: 90.45%, Validation Loss: 0.294033020734787, Validation Accuracy: 92.45%
I0129 22:28:20.809045 140680428713792 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts.
I0129 22:28:43.864629 140680428713792 train.py:188] Step 4500, Loss: 0.23800396919250488, Accuracy: 90.55%, Validation Loss: 0.30789628624916077, Validation Accuracy: 88.68%
I0129 22:29:07.129427 140680428713792 train.py:188] Step 4750, Loss: 0.2268647998571396, Accuracy: 90.64%, Validation Loss: 0.26456740498542786, Validation Accuracy: 88.68%
I0129 22:29:30.025192 140680428713792 train.py:188] Step 5000, Loss: 0.21467271447181702, Accuracy: 91.24%, Validation Loss: 0.2552993893623352, Validation Accuracy: 91.51%
I0129 22:29:53.216085 140680428713792 train.py:188] Step 5250, Loss: 0.21946945786476135, Accuracy: 91.33%, Validation Loss: 0.3704398274421692, Validation Accuracy: 83.02%
I0129 22:30:16.275236 140680428713792 train.py:188] Step 5500, Loss: 0.20791156589984894, Accuracy: 91.79%, Validation Loss: 0.2664843797683716, Validation Accuracy: 89.62%
I0129 22:30:39.792047 140680428713792 train.py:188] Step 5750, Loss: 0.19559787213802338, Accuracy: 92.27%, Validation Loss: 0.4140116572380066, Validation Accuracy: 82.08%
I0129 22:31:02.905140 140680428713792 train.py:188] Step 6000, Loss: 0.21121788024902344, Accuracy: 91.53%, Validation Loss: 0.2920907139778137, Validation Accuracy: 88.68%
I0129 22:31:26.694532 140680428713792 train.py:188] Step 6250, Loss: 0.1871262788772583, Accuracy: 92.52%, Validation Loss: 0.3669138252735138, Validation Accuracy: 90.57%
I0129 22:31:49.778461 140680428713792 train.py:188] Step 6500, Loss: 0.1999363750219345, Accuracy: 92.19%, Validation Loss: 0.7267870903015137, Validation Accuracy: 60.38%
I0129 22:32:12.985650 140680428713792 train.py:188] Step 6750, Loss: 0.21266847848892212, Accuracy: 91.37%, Validation Loss: 0.3573341965675354, Validation Accuracy: 85.85%
I0129 22:32:36.106117 140680428713792 train.py:188] Step 7000, Loss: 0.16890370845794678, Accuracy: 93.19%, Validation Loss: 0.3098877966403961, Validation Accuracy: 88.68%
I0129 22:32:59.527105 140680428713792 train.py:188] Step 7250, Loss: 0.16430972516536713, Accuracy: 93.49%, Validation Loss: 0.309192419052124, Validation Accuracy: 85.85%
I0129 22:33:22.644794 140680428713792 train.py:188] Step 7500, Loss: 0.16132798790931702, Accuracy: 93.64%, Validation Loss: 0.34074997901916504, Validation Accuracy: 88.68%
I0129 22:33:22.668492 140680428713792 train.py:222] Finished training after 7500 steps.
I0129 22:33:22.687808 140680428713792 eval.py:22] 
======== Starting Evaluation ========
I0129 22:33:22.695670 140680428713792 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/ckpts
I0129 22:33:22.864001 140680428713792 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         92.5133689839572
Sensitivity:          90.9090909090909
Specificity:          94.11764705882352
F1_Score:             92.5925925925926
Confusion_matrix:   
                   [50  3]
                   [ 5 48]


I0129 22:33:23.013930 140680428713792 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       76.69902912621359
Balanced_Acc:         75.24038461538461
Sensitivity:          69.23076923076923
Specificity:          81.25
F1_Score:             69.23076923076923
Confusion_matrix:   
                   [27 12]
                   [12 52]


I0129 22:33:23.014195 140680428713792 eval.py:66] ======== Finished Evaluation ========
I0129 22:33:23.014489 140680428713792 visualization.py:90] 
======== Starting DeepVis ========
I0129 22:33:23.550770 140680428713792 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/plot/train/deepvis_IDRiD_001.jpg
I0129 22:33:23.909704 140680428713792 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/plot/test/deepvis_IDRiD_001.jpg
I0129 22:33:24.270302 140680428713792 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/plot/train/deepvis_IDRiD_009.jpg
I0129 22:33:24.628495 140680428713792 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-21-42-399245/plot/test/deepvis_IDRiD_009.jpg
I0129 22:33:24.690574 140680428713792 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_01"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 252, 252, 4)       304       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 84, 84, 4)         0         
_________________________________________________________________
batch_normalization (BatchNo (None, 84, 84, 4)         16        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 82, 82, 32)        1184      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 27, 27, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 27, 27, 32)        128       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 25, 25, 64)        18496     
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0         
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense (Dense)                (None, 16)                1040      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 21,202
Trainable params: 21,130
Non-trainable params: 72
_________________________________________________________________
2022-01-29 22:33:28.115732: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 22:33:28.519497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 22:33:28.839462 139925593360192 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 22:33:30.158092 139925593360192 architectures.py:84] team20_cnn_01 input shape:  (None, 256, 256, 3)
I0129 22:33:30.158214 139925593360192 architectures.py:85] team20_cnn_01 output shape: (None, 2)
I0129 22:33:30.158415 139925593360192 main.py:117] Running model: cnn_01
I0129 22:33:30.159164 139925593360192 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286
I0129 22:33:30.159231 139925593360192 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-223330
I0129 22:33:30.169903 139925593360192 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 22:33:30.169966 139925593360192 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts
I0129 22:33:30.170001 139925593360192 train.py:171] 
======== Starting Training ========
2022-01-29 22:33:30.195601: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 22:33:31.549792: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 22:33:56.696855 139925593360192 train.py:188] Step 250, Loss: 0.6081741452217102, Accuracy: 67.51%, Validation Loss: 0.7021051049232483, Validation Accuracy: 53.77%
I0129 22:33:56.713099 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:34:19.959649 139925593360192 train.py:188] Step 500, Loss: 0.5694835186004639, Accuracy: 70.45%, Validation Loss: 0.6784183382987976, Validation Accuracy: 55.66%
I0129 22:34:19.975543 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:34:43.446971 139925593360192 train.py:188] Step 750, Loss: 0.5364155769348145, Accuracy: 72.89%, Validation Loss: 0.5843831896781921, Validation Accuracy: 78.30%
I0129 22:34:43.477555 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:35:06.840665 139925593360192 train.py:188] Step 1000, Loss: 0.49689316749572754, Accuracy: 75.35%, Validation Loss: 0.43615469336509705, Validation Accuracy: 76.42%
I0129 22:35:30.373552 139925593360192 train.py:188] Step 1250, Loss: 0.42693501710891724, Accuracy: 79.41%, Validation Loss: 0.29432299733161926, Validation Accuracy: 85.85%
I0129 22:35:30.404927 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:35:53.430095 139925593360192 train.py:188] Step 1500, Loss: 0.3914933502674103, Accuracy: 82.26%, Validation Loss: 0.27339330315589905, Validation Accuracy: 89.62%
I0129 22:35:53.461311 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:36:16.673678 139925593360192 train.py:188] Step 1750, Loss: 0.3702460527420044, Accuracy: 83.57%, Validation Loss: 0.3479626476764679, Validation Accuracy: 85.85%
I0129 22:36:39.737874 139925593360192 train.py:188] Step 2000, Loss: 0.34113219380378723, Accuracy: 85.10%, Validation Loss: 0.2358682006597519, Validation Accuracy: 90.57%
I0129 22:36:39.761605 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:37:02.974717 139925593360192 train.py:188] Step 2250, Loss: 0.3141833245754242, Accuracy: 86.57%, Validation Loss: 0.2801290452480316, Validation Accuracy: 87.74%
I0129 22:37:26.182599 139925593360192 train.py:188] Step 2500, Loss: 0.2816685140132904, Accuracy: 88.16%, Validation Loss: 0.29814836382865906, Validation Accuracy: 88.68%
I0129 22:37:49.505055 139925593360192 train.py:188] Step 2750, Loss: 0.2744051218032837, Accuracy: 88.81%, Validation Loss: 0.27892830967903137, Validation Accuracy: 84.91%
I0129 22:38:12.589078 139925593360192 train.py:188] Step 3000, Loss: 0.25887084007263184, Accuracy: 89.25%, Validation Loss: 0.21795237064361572, Validation Accuracy: 96.23%
I0129 22:38:12.613950 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:38:35.796169 139925593360192 train.py:188] Step 3250, Loss: 0.25212615728378296, Accuracy: 89.63%, Validation Loss: 0.16982071101665497, Validation Accuracy: 98.11%
I0129 22:38:35.823199 139925593360192 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts.
I0129 22:38:58.924064 139925593360192 train.py:188] Step 3500, Loss: 0.24190038442611694, Accuracy: 90.03%, Validation Loss: 0.24481739103794098, Validation Accuracy: 87.74%
I0129 22:39:22.269120 139925593360192 train.py:188] Step 3750, Loss: 0.22002841532230377, Accuracy: 91.05%, Validation Loss: 0.2151372730731964, Validation Accuracy: 92.45%
I0129 22:39:45.197001 139925593360192 train.py:188] Step 4000, Loss: 0.2180768847465515, Accuracy: 91.13%, Validation Loss: 0.28290385007858276, Validation Accuracy: 87.74%
I0129 22:40:08.483855 139925593360192 train.py:188] Step 4250, Loss: 0.20399543642997742, Accuracy: 91.74%, Validation Loss: 0.22999347746372223, Validation Accuracy: 87.74%
I0129 22:40:31.645555 139925593360192 train.py:188] Step 4500, Loss: 0.21265003085136414, Accuracy: 91.14%, Validation Loss: 0.3214518427848816, Validation Accuracy: 86.79%
I0129 22:40:54.801254 139925593360192 train.py:188] Step 4750, Loss: 0.19746336340904236, Accuracy: 91.92%, Validation Loss: 0.29981037974357605, Validation Accuracy: 92.45%
I0129 22:41:17.942691 139925593360192 train.py:188] Step 5000, Loss: 0.19199736416339874, Accuracy: 92.04%, Validation Loss: 0.2898731529712677, Validation Accuracy: 84.91%
I0129 22:41:40.979624 139925593360192 train.py:188] Step 5250, Loss: 0.18757501244544983, Accuracy: 92.49%, Validation Loss: 0.14928869903087616, Validation Accuracy: 92.45%
I0129 22:42:03.898952 139925593360192 train.py:188] Step 5500, Loss: 0.1724177896976471, Accuracy: 93.05%, Validation Loss: 0.23164768517017365, Validation Accuracy: 89.62%
I0129 22:42:27.183904 139925593360192 train.py:188] Step 5750, Loss: 0.16986869275569916, Accuracy: 93.05%, Validation Loss: 0.3885424733161926, Validation Accuracy: 83.96%
I0129 22:42:50.500207 139925593360192 train.py:188] Step 6000, Loss: 0.17735572159290314, Accuracy: 92.91%, Validation Loss: 0.24679706990718842, Validation Accuracy: 87.74%
I0129 22:43:14.073555 139925593360192 train.py:188] Step 6250, Loss: 0.17413556575775146, Accuracy: 93.18%, Validation Loss: 0.16117453575134277, Validation Accuracy: 90.57%
I0129 22:43:37.211309 139925593360192 train.py:188] Step 6500, Loss: 0.16524755954742432, Accuracy: 93.32%, Validation Loss: 0.2983691990375519, Validation Accuracy: 87.74%
I0129 22:44:00.608958 139925593360192 train.py:188] Step 6750, Loss: 0.1615900844335556, Accuracy: 93.60%, Validation Loss: 0.21727226674556732, Validation Accuracy: 92.45%
I0129 22:44:23.808942 139925593360192 train.py:188] Step 7000, Loss: 0.15162993967533112, Accuracy: 93.87%, Validation Loss: 0.1447552889585495, Validation Accuracy: 94.34%
I0129 22:44:47.136501 139925593360192 train.py:188] Step 7250, Loss: 0.15687988698482513, Accuracy: 93.68%, Validation Loss: 0.17202478647232056, Validation Accuracy: 96.23%
I0129 22:45:10.122654 139925593360192 train.py:188] Step 7500, Loss: 0.1448868364095688, Accuracy: 94.23%, Validation Loss: 0.2929059565067291, Validation Accuracy: 92.45%
I0129 22:45:10.144278 139925593360192 train.py:222] Finished training after 7500 steps.
I0129 22:45:10.157285 139925593360192 eval.py:22] 
======== Starting Evaluation ========
I0129 22:45:10.165324 139925593360192 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/ckpts
I0129 22:45:10.335132 139925593360192 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       98.11320754716981
Balanced_Acc:         98.18181818181819
Sensitivity:          96.36363636363636
Specificity:          100.0
F1_Score:             98.14814814814815
Confusion_matrix:   
                   [53  0]
                   [ 2 51]


I0129 22:45:10.481776 139925593360192 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       78.64077669902912
Balanced_Acc:         78.52564102564102
Sensitivity:          66.66666666666666
Specificity:          90.38461538461539
F1_Score:             75.55555555555556
Confusion_matrix:   
                   [34  5]
                   [17 47]


I0129 22:45:10.482043 139925593360192 eval.py:66] ======== Finished Evaluation ========
I0129 22:45:10.482326 139925593360192 visualization.py:90] 
======== Starting DeepVis ========
I0129 22:45:11.021717 139925593360192 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/plot/train/deepvis_IDRiD_001.jpg
I0129 22:45:11.381605 139925593360192 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/plot/test/deepvis_IDRiD_001.jpg
I0129 22:45:11.745784 139925593360192 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/plot/train/deepvis_IDRiD_009.jpg
I0129 22:45:12.109342 139925593360192 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-33-28-833286/plot/test/deepvis_IDRiD_009.jpg
I0129 22:45:12.171887 139925593360192 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_01"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 252, 252, 4)       304       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 84, 84, 4)         0         
_________________________________________________________________
batch_normalization (BatchNo (None, 84, 84, 4)         16        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 82, 82, 32)        1184      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 27, 27, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 27, 27, 32)        128       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 25, 25, 64)        18496     
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0         
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense (Dense)                (None, 16)                1040      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 21,202
Trainable params: 21,130
Non-trainable params: 72
_________________________________________________________________
2022-01-29 22:45:15.667693: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 22:45:16.080009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 22:45:16.401326 140276847109952 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 22:45:17.728693 140276847109952 architectures.py:143] team20_cnn_02 input shape:  (None, 256, 256, 3)
I0129 22:45:17.728827 140276847109952 architectures.py:144] team20_cnn_02 output shape: (None, 2)
I0129 22:45:17.729038 140276847109952 main.py:117] Running model: cnn_02
I0129 22:45:17.729988 140276847109952 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241
I0129 22:45:17.730055 140276847109952 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-224517
I0129 22:45:17.740940 140276847109952 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 22:45:17.741031 140276847109952 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts
I0129 22:45:17.741066 140276847109952 train.py:171] 
======== Starting Training ========
2022-01-29 22:45:17.766975: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 22:45:19.174955: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 22:46:01.321122 140276847109952 train.py:188] Step 250, Loss: 0.6318403482437134, Accuracy: 66.94%, Validation Loss: 0.9380776882171631, Validation Accuracy: 51.89%
I0129 22:46:01.336354 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:46:39.033446 140276847109952 train.py:188] Step 500, Loss: 0.5966774225234985, Accuracy: 69.51%, Validation Loss: 0.6441043615341187, Validation Accuracy: 56.60%
I0129 22:46:39.054016 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:47:17.224220 140276847109952 train.py:188] Step 750, Loss: 0.5890032052993774, Accuracy: 69.91%, Validation Loss: 0.7046069502830505, Validation Accuracy: 54.72%
I0129 22:47:54.938132 140276847109952 train.py:188] Step 1000, Loss: 0.5439398884773254, Accuracy: 72.78%, Validation Loss: 0.7653762698173523, Validation Accuracy: 59.43%
I0129 22:47:54.969077 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:48:33.002797 140276847109952 train.py:188] Step 1250, Loss: 0.4302002191543579, Accuracy: 79.57%, Validation Loss: 0.6117308139801025, Validation Accuracy: 61.32%
I0129 22:48:33.025234 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:49:10.586932 140276847109952 train.py:188] Step 1500, Loss: 0.34415075182914734, Accuracy: 84.50%, Validation Loss: 0.4557034373283386, Validation Accuracy: 70.75%
I0129 22:49:10.608229 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:49:48.682992 140276847109952 train.py:188] Step 1750, Loss: 0.2848502993583679, Accuracy: 88.09%, Validation Loss: 0.3576781749725342, Validation Accuracy: 74.53%
I0129 22:49:48.713617 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:50:26.609885 140276847109952 train.py:188] Step 2000, Loss: 0.24061225354671478, Accuracy: 90.16%, Validation Loss: 0.5231056809425354, Validation Accuracy: 77.36%
I0129 22:50:26.631359 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:51:04.624233 140276847109952 train.py:188] Step 2250, Loss: 0.24299633502960205, Accuracy: 89.86%, Validation Loss: 0.8400740027427673, Validation Accuracy: 81.13%
I0129 22:51:04.649726 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:51:42.508674 140276847109952 train.py:188] Step 2500, Loss: 0.20293518900871277, Accuracy: 92.10%, Validation Loss: 0.6084147095680237, Validation Accuracy: 83.96%
I0129 22:51:42.526931 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:52:20.465826 140276847109952 train.py:188] Step 2750, Loss: 0.17618218064308167, Accuracy: 93.41%, Validation Loss: 0.9361292719841003, Validation Accuracy: 78.30%
I0129 22:52:58.321746 140276847109952 train.py:188] Step 3000, Loss: 0.15798082947731018, Accuracy: 94.21%, Validation Loss: 1.222124457359314, Validation Accuracy: 68.87%
I0129 22:53:36.416580 140276847109952 train.py:188] Step 3250, Loss: 0.14883653819561005, Accuracy: 94.49%, Validation Loss: 1.1494486331939697, Validation Accuracy: 78.30%
I0129 22:54:14.174889 140276847109952 train.py:188] Step 3500, Loss: 0.12653973698616028, Accuracy: 95.37%, Validation Loss: 0.6940276622772217, Validation Accuracy: 84.91%
I0129 22:54:14.200051 140276847109952 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts.
I0129 22:54:52.349810 140276847109952 train.py:188] Step 3750, Loss: 0.1599418669939041, Accuracy: 93.89%, Validation Loss: 0.9369584321975708, Validation Accuracy: 77.36%
I0129 22:55:30.167912 140276847109952 train.py:188] Step 4000, Loss: 0.11466307938098907, Accuracy: 95.75%, Validation Loss: 1.3090438842773438, Validation Accuracy: 76.42%
I0129 22:56:08.005957 140276847109952 train.py:188] Step 4250, Loss: 0.09746774286031723, Accuracy: 96.53%, Validation Loss: 1.316572904586792, Validation Accuracy: 77.36%
I0129 22:56:45.756728 140276847109952 train.py:188] Step 4500, Loss: 0.10192624479532242, Accuracy: 96.37%, Validation Loss: 0.9034690856933594, Validation Accuracy: 82.08%
I0129 22:57:23.772313 140276847109952 train.py:188] Step 4750, Loss: 0.09105227142572403, Accuracy: 96.83%, Validation Loss: 0.7132513523101807, Validation Accuracy: 83.02%
I0129 22:58:01.464800 140276847109952 train.py:188] Step 5000, Loss: 0.09441078454256058, Accuracy: 96.84%, Validation Loss: 2.3839850425720215, Validation Accuracy: 72.64%
I0129 22:58:39.552398 140276847109952 train.py:188] Step 5250, Loss: 0.0911606103181839, Accuracy: 96.83%, Validation Loss: 0.8501022458076477, Validation Accuracy: 83.96%
I0129 22:59:17.370582 140276847109952 train.py:188] Step 5500, Loss: 0.08705557882785797, Accuracy: 96.94%, Validation Loss: 1.0328705310821533, Validation Accuracy: 79.25%
I0129 22:59:55.422613 140276847109952 train.py:188] Step 5750, Loss: 0.07091336697340012, Accuracy: 97.55%, Validation Loss: 1.2610390186309814, Validation Accuracy: 83.02%
I0129 23:00:33.008872 140276847109952 train.py:188] Step 6000, Loss: 0.07403605431318283, Accuracy: 97.42%, Validation Loss: 0.9793339967727661, Validation Accuracy: 81.13%
I0129 23:01:10.857744 140276847109952 train.py:188] Step 6250, Loss: 0.07192154973745346, Accuracy: 97.53%, Validation Loss: 1.1874020099639893, Validation Accuracy: 82.08%
I0129 23:01:48.577218 140276847109952 train.py:188] Step 6500, Loss: 0.06441066414117813, Accuracy: 97.91%, Validation Loss: 1.4535971879959106, Validation Accuracy: 83.02%
I0129 23:02:26.684576 140276847109952 train.py:188] Step 6750, Loss: 0.060668885707855225, Accuracy: 98.00%, Validation Loss: 3.5902795791625977, Validation Accuracy: 68.87%
I0129 23:03:04.346796 140276847109952 train.py:188] Step 7000, Loss: 0.07047545909881592, Accuracy: 97.62%, Validation Loss: 0.8756276369094849, Validation Accuracy: 77.36%
I0129 23:03:42.315473 140276847109952 train.py:188] Step 7250, Loss: 0.07043305784463882, Accuracy: 97.59%, Validation Loss: 1.1178590059280396, Validation Accuracy: 78.30%
I0129 23:04:19.977149 140276847109952 train.py:188] Step 7500, Loss: 0.06332781910896301, Accuracy: 97.82%, Validation Loss: 1.7976648807525635, Validation Accuracy: 74.53%
I0129 23:04:19.994892 140276847109952 train.py:222] Finished training after 7500 steps.
I0129 23:04:20.019863 140276847109952 eval.py:22] 
======== Starting Evaluation ========
I0129 23:04:20.030301 140276847109952 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/ckpts
I0129 23:04:20.689289 140276847109952 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       84.90566037735849
Balanced_Acc:         84.95543672014261
Sensitivity:          83.63636363636363
Specificity:          86.27450980392157
F1_Score:             85.18518518518519
Confusion_matrix:   
                   [46  7]
                   [ 9 44]


I0129 23:04:21.319988 140276847109952 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       79.6116504854369
Balanced_Acc:         80.27210884353741
Sensitivity:          66.66666666666666
Specificity:          93.87755102040816
F1_Score:             77.41935483870968
Confusion_matrix:   
                   [36  3]
                   [18 46]


I0129 23:04:21.320246 140276847109952 eval.py:66] ======== Finished Evaluation ========
I0129 23:04:21.320533 140276847109952 visualization.py:90] 
======== Starting DeepVis ========
I0129 23:04:22.522108 140276847109952 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/plot/train/deepvis_IDRiD_001.jpg
I0129 23:04:22.932203 140276847109952 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/plot/test/deepvis_IDRiD_001.jpg
I0129 23:04:23.345884 140276847109952 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/plot/train/deepvis_IDRiD_009.jpg
I0129 23:04:23.764099 140276847109952 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T22-45-16-395241/plot/test/deepvis_IDRiD_009.jpg
I0129 23:04:23.825097 140276847109952 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_02"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 250, 250, 8)       1184      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 244, 244, 16)      6288      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 122, 122, 16)      0         
_________________________________________________________________
batch_normalization (BatchNo (None, 122, 122, 16)      64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 118, 118, 32)      12832     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 59, 59, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 59, 59, 32)        128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 57, 57, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 64)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 128)       73856     
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 16)                2064      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 115,202
Trainable params: 114,978
Non-trainable params: 224
_________________________________________________________________
2022-01-29 23:04:27.299220: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 23:04:27.703099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 23:04:28.039535 139900965054272 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 23:04:29.399462 139900965054272 architectures.py:143] team20_cnn_02 input shape:  (None, 256, 256, 3)
I0129 23:04:29.399594 139900965054272 architectures.py:144] team20_cnn_02 output shape: (None, 2)
I0129 23:04:29.399802 139900965054272 main.py:117] Running model: cnn_02
I0129 23:04:29.403798 139900965054272 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328
I0129 23:04:29.403896 139900965054272 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-230429
I0129 23:04:29.418143 139900965054272 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 23:04:29.418219 139900965054272 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts
I0129 23:04:29.418255 139900965054272 train.py:171] 
======== Starting Training ========
2022-01-29 23:04:29.444224: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 23:04:30.848552: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 23:05:13.034047 139900965054272 train.py:188] Step 250, Loss: 0.6179059743881226, Accuracy: 67.60%, Validation Loss: 0.6690558195114136, Validation Accuracy: 55.66%
I0129 23:05:13.047287 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:05:50.638598 139900965054272 train.py:188] Step 500, Loss: 0.5837150812149048, Accuracy: 70.37%, Validation Loss: 0.6554378271102905, Validation Accuracy: 70.75%
I0129 23:05:50.663944 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:06:28.600980 139900965054272 train.py:188] Step 750, Loss: 0.5658795237541199, Accuracy: 71.99%, Validation Loss: 0.6234294176101685, Validation Accuracy: 67.92%
I0129 23:07:06.275846 139900965054272 train.py:188] Step 1000, Loss: 0.5227032899856567, Accuracy: 74.65%, Validation Loss: 0.6403204202651978, Validation Accuracy: 61.32%
I0129 23:07:44.363043 139900965054272 train.py:188] Step 1250, Loss: 0.4436657130718231, Accuracy: 78.96%, Validation Loss: 0.5111152529716492, Validation Accuracy: 78.30%
I0129 23:07:44.386662 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:08:22.050571 139900965054272 train.py:188] Step 1500, Loss: 0.3646223247051239, Accuracy: 83.21%, Validation Loss: 0.6749053597450256, Validation Accuracy: 60.38%
I0129 23:09:00.167950 139900965054272 train.py:188] Step 1750, Loss: 0.3540003299713135, Accuracy: 83.67%, Validation Loss: 2.09382963180542, Validation Accuracy: 62.26%
I0129 23:09:37.870529 139900965054272 train.py:188] Step 2000, Loss: 0.28342506289482117, Accuracy: 87.59%, Validation Loss: 0.7296240925788879, Validation Accuracy: 71.70%
I0129 23:10:15.796280 139900965054272 train.py:188] Step 2250, Loss: 0.23567956686019897, Accuracy: 90.10%, Validation Loss: 0.6802350282669067, Validation Accuracy: 84.91%
I0129 23:10:15.817487 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:10:53.439269 139900965054272 train.py:188] Step 2500, Loss: 0.21209633350372314, Accuracy: 90.93%, Validation Loss: 1.3124674558639526, Validation Accuracy: 68.87%
I0129 23:11:31.230799 139900965054272 train.py:188] Step 2750, Loss: 0.21227049827575684, Accuracy: 91.33%, Validation Loss: 0.9481102824211121, Validation Accuracy: 73.58%
I0129 23:12:08.653245 139900965054272 train.py:188] Step 3000, Loss: 0.207103431224823, Accuracy: 91.97%, Validation Loss: 0.6271116137504578, Validation Accuracy: 83.96%
I0129 23:12:46.659367 139900965054272 train.py:188] Step 3250, Loss: 0.16494877636432648, Accuracy: 93.74%, Validation Loss: 1.9260812997817993, Validation Accuracy: 74.53%
I0129 23:13:24.480923 139900965054272 train.py:188] Step 3500, Loss: 0.14346353709697723, Accuracy: 94.42%, Validation Loss: 0.7348775863647461, Validation Accuracy: 85.85%
I0129 23:13:24.507387 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:14:02.492037 139900965054272 train.py:188] Step 3750, Loss: 0.16312354803085327, Accuracy: 94.03%, Validation Loss: 0.8198471069335938, Validation Accuracy: 75.47%
I0129 23:14:40.102596 139900965054272 train.py:188] Step 4000, Loss: 0.11131741851568222, Accuracy: 95.94%, Validation Loss: 0.6058653593063354, Validation Accuracy: 90.57%
I0129 23:14:40.127955 139900965054272 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts.
I0129 23:15:18.056784 139900965054272 train.py:188] Step 4250, Loss: 0.11831361800432205, Accuracy: 95.99%, Validation Loss: 1.6615115404129028, Validation Accuracy: 77.36%
I0129 23:15:55.608961 139900965054272 train.py:188] Step 4500, Loss: 0.10328448563814163, Accuracy: 96.30%, Validation Loss: 2.0215532779693604, Validation Accuracy: 69.81%
I0129 23:16:33.492484 139900965054272 train.py:188] Step 4750, Loss: 0.08503065258264542, Accuracy: 97.02%, Validation Loss: 0.9948114156723022, Validation Accuracy: 84.91%
I0129 23:17:11.096683 139900965054272 train.py:188] Step 5000, Loss: 0.09783929586410522, Accuracy: 96.54%, Validation Loss: 1.8224912881851196, Validation Accuracy: 76.42%
I0129 23:17:49.015038 139900965054272 train.py:188] Step 5250, Loss: 0.0941290408372879, Accuracy: 96.74%, Validation Loss: 0.8058804273605347, Validation Accuracy: 70.75%
I0129 23:18:26.586406 139900965054272 train.py:188] Step 5500, Loss: 0.07442250102758408, Accuracy: 97.36%, Validation Loss: 2.2692031860351562, Validation Accuracy: 84.91%
I0129 23:19:04.473552 139900965054272 train.py:188] Step 5750, Loss: 0.10362411290407181, Accuracy: 96.60%, Validation Loss: 0.8103234767913818, Validation Accuracy: 79.25%
I0129 23:19:42.064202 139900965054272 train.py:188] Step 6000, Loss: 0.0829450786113739, Accuracy: 97.23%, Validation Loss: 1.5775963068008423, Validation Accuracy: 81.13%
I0129 23:20:19.962668 139900965054272 train.py:188] Step 6250, Loss: 0.07298816740512848, Accuracy: 97.56%, Validation Loss: 1.1431366205215454, Validation Accuracy: 83.96%
I0129 23:20:57.404540 139900965054272 train.py:188] Step 6500, Loss: 0.07448062300682068, Accuracy: 97.71%, Validation Loss: 0.8889486193656921, Validation Accuracy: 81.13%
I0129 23:21:35.494359 139900965054272 train.py:188] Step 6750, Loss: 0.06647101044654846, Accuracy: 97.82%, Validation Loss: 1.707778811454773, Validation Accuracy: 76.42%
I0129 23:22:13.216556 139900965054272 train.py:188] Step 7000, Loss: 0.06317843496799469, Accuracy: 98.04%, Validation Loss: 6.5917744636535645, Validation Accuracy: 69.81%
I0129 23:22:51.110541 139900965054272 train.py:188] Step 7250, Loss: 0.05734186992049217, Accuracy: 98.20%, Validation Loss: 1.7768563032150269, Validation Accuracy: 73.58%
I0129 23:23:28.754429 139900965054272 train.py:188] Step 7500, Loss: 0.0631169006228447, Accuracy: 98.02%, Validation Loss: 1.3783977031707764, Validation Accuracy: 75.47%
I0129 23:23:28.775263 139900965054272 train.py:222] Finished training after 7500 steps.
I0129 23:23:28.795712 139900965054272 eval.py:22] 
======== Starting Evaluation ========
I0129 23:23:28.806248 139900965054272 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/ckpts
I0129 23:23:29.483619 139900965054272 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       90.56603773584906
Balanced_Acc:         90.7984246330111
Sensitivity:          87.71929824561403
Specificity:          93.87755102040816
F1_Score:             90.9090909090909
Confusion_matrix:   
                   [50  3]
                   [ 7 46]


I0129 23:23:30.116600 139900965054272 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       79.6116504854369
Balanced_Acc:         79.28301886792453
Sensitivity:          68.0
Specificity:          90.56603773584906
F1_Score:             76.40449438202246
Confusion_matrix:   
                   [34  5]
                   [16 48]


I0129 23:23:30.116870 139900965054272 eval.py:66] ======== Finished Evaluation ========
I0129 23:23:30.117165 139900965054272 visualization.py:90] 
======== Starting DeepVis ========
I0129 23:23:31.312482 139900965054272 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/plot/train/deepvis_IDRiD_001.jpg
I0129 23:23:31.722343 139900965054272 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/plot/test/deepvis_IDRiD_001.jpg
I0129 23:23:32.134634 139900965054272 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/plot/train/deepvis_IDRiD_009.jpg
I0129 23:23:32.545983 139900965054272 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-04-28-033328/plot/test/deepvis_IDRiD_009.jpg
I0129 23:23:32.609634 139900965054272 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_02"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 250, 250, 8)       1184      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 244, 244, 16)      6288      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 122, 122, 16)      0         
_________________________________________________________________
batch_normalization (BatchNo (None, 122, 122, 16)      64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 118, 118, 32)      12832     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 59, 59, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 59, 59, 32)        128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 57, 57, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 64)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 128)       73856     
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 16)                2064      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 115,202
Trainable params: 114,978
Non-trainable params: 224
_________________________________________________________________
2022-01-29 23:23:36.045539: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 23:23:36.451670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 23:23:36.770532 140465626199872 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 23:23:38.073830 140465626199872 architectures.py:143] team20_cnn_02 input shape:  (None, 256, 256, 3)
I0129 23:23:38.073949 140465626199872 architectures.py:144] team20_cnn_02 output shape: (None, 2)
I0129 23:23:38.074145 140465626199872 main.py:117] Running model: cnn_02
I0129 23:23:38.075124 140465626199872 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438
I0129 23:23:38.075189 140465626199872 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-232338
I0129 23:23:38.086042 140465626199872 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 23:23:38.086107 140465626199872 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts
I0129 23:23:38.086142 140465626199872 train.py:171] 
======== Starting Training ========
2022-01-29 23:23:38.115260: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 23:23:39.513992: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 23:24:21.474845 140465626199872 train.py:188] Step 250, Loss: 0.6223514676094055, Accuracy: 66.86%, Validation Loss: 1.2229018211364746, Validation Accuracy: 51.89%
I0129 23:24:21.489796 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:24:59.109861 140465626199872 train.py:188] Step 500, Loss: 0.5936996340751648, Accuracy: 69.84%, Validation Loss: 0.8441225290298462, Validation Accuracy: 57.55%
I0129 23:24:59.131267 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:25:37.165976 140465626199872 train.py:188] Step 750, Loss: 0.5261365175247192, Accuracy: 73.39%, Validation Loss: 0.691875696182251, Validation Accuracy: 62.26%
I0129 23:25:37.194463 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:26:14.821019 140465626199872 train.py:188] Step 1000, Loss: 0.4211949408054352, Accuracy: 79.88%, Validation Loss: 0.5854606032371521, Validation Accuracy: 63.21%
I0129 23:26:14.841953 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:26:52.876326 140465626199872 train.py:188] Step 1250, Loss: 0.31451982259750366, Accuracy: 86.53%, Validation Loss: 0.3639387786388397, Validation Accuracy: 81.13%
I0129 23:26:52.899323 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:27:30.608841 140465626199872 train.py:188] Step 1500, Loss: 0.2782580554485321, Accuracy: 88.11%, Validation Loss: 0.3960265815258026, Validation Accuracy: 86.79%
I0129 23:27:30.632651 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:28:08.537180 140465626199872 train.py:188] Step 1750, Loss: 0.24703848361968994, Accuracy: 90.11%, Validation Loss: 0.5252509713172913, Validation Accuracy: 81.13%
I0129 23:28:46.336698 140465626199872 train.py:188] Step 2000, Loss: 0.21764875948429108, Accuracy: 91.36%, Validation Loss: 0.5001476407051086, Validation Accuracy: 77.36%
I0129 23:29:24.190926 140465626199872 train.py:188] Step 2250, Loss: 0.1892557442188263, Accuracy: 92.63%, Validation Loss: 0.6775941848754883, Validation Accuracy: 81.13%
I0129 23:30:01.812299 140465626199872 train.py:188] Step 2500, Loss: 0.19407151639461517, Accuracy: 92.62%, Validation Loss: 0.5947341322898865, Validation Accuracy: 86.79%
I0129 23:30:39.943010 140465626199872 train.py:188] Step 2750, Loss: 0.15199461579322815, Accuracy: 94.22%, Validation Loss: 0.7697064280509949, Validation Accuracy: 82.08%
I0129 23:31:17.549711 140465626199872 train.py:188] Step 3000, Loss: 0.14756321907043457, Accuracy: 94.74%, Validation Loss: 0.8472456336021423, Validation Accuracy: 87.74%
I0129 23:31:17.584665 140465626199872 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts.
I0129 23:31:55.697733 140465626199872 train.py:188] Step 3250, Loss: 0.12059134244918823, Accuracy: 95.45%, Validation Loss: 1.7093137502670288, Validation Accuracy: 75.47%
I0129 23:32:33.378978 140465626199872 train.py:188] Step 3500, Loss: 0.10655796527862549, Accuracy: 96.15%, Validation Loss: 1.2021499872207642, Validation Accuracy: 80.19%
I0129 23:33:11.454887 140465626199872 train.py:188] Step 3750, Loss: 0.10409072041511536, Accuracy: 96.17%, Validation Loss: 1.8698936700820923, Validation Accuracy: 68.87%
I0129 23:33:49.274126 140465626199872 train.py:188] Step 4000, Loss: 0.114947110414505, Accuracy: 95.94%, Validation Loss: 0.8763883113861084, Validation Accuracy: 81.13%
I0129 23:34:27.412886 140465626199872 train.py:188] Step 4250, Loss: 0.08762183040380478, Accuracy: 96.93%, Validation Loss: 1.1533318758010864, Validation Accuracy: 73.58%
I0129 23:35:05.098199 140465626199872 train.py:188] Step 4500, Loss: 0.09459271281957626, Accuracy: 96.93%, Validation Loss: 1.2298641204833984, Validation Accuracy: 70.75%
I0129 23:35:43.282344 140465626199872 train.py:188] Step 4750, Loss: 0.08542876690626144, Accuracy: 97.09%, Validation Loss: 1.0691078901290894, Validation Accuracy: 83.02%
I0129 23:36:21.077837 140465626199872 train.py:188] Step 5000, Loss: 0.10611597448587418, Accuracy: 96.15%, Validation Loss: 6.8402886390686035, Validation Accuracy: 70.75%
I0129 23:36:59.017710 140465626199872 train.py:188] Step 5250, Loss: 0.0764763355255127, Accuracy: 97.38%, Validation Loss: 1.8116915225982666, Validation Accuracy: 72.64%
I0129 23:37:36.671767 140465626199872 train.py:188] Step 5500, Loss: 0.0640040785074234, Accuracy: 97.92%, Validation Loss: 1.4007556438446045, Validation Accuracy: 73.58%
I0129 23:38:14.726722 140465626199872 train.py:188] Step 5750, Loss: 0.08034636825323105, Accuracy: 97.45%, Validation Loss: 1.7023544311523438, Validation Accuracy: 75.47%
I0129 23:38:52.367527 140465626199872 train.py:188] Step 6000, Loss: 0.05205090716481209, Accuracy: 98.16%, Validation Loss: 1.2917866706848145, Validation Accuracy: 79.25%
I0129 23:39:30.335079 140465626199872 train.py:188] Step 6250, Loss: 0.06694679707288742, Accuracy: 97.77%, Validation Loss: 1.777343511581421, Validation Accuracy: 66.04%
I0129 23:40:08.076615 140465626199872 train.py:188] Step 6500, Loss: 0.06533853709697723, Accuracy: 97.96%, Validation Loss: 1.259106159210205, Validation Accuracy: 84.91%
I0129 23:40:46.101870 140465626199872 train.py:188] Step 6750, Loss: 0.08376524597406387, Accuracy: 97.32%, Validation Loss: 1.2627718448638916, Validation Accuracy: 77.36%
I0129 23:41:23.860153 140465626199872 train.py:188] Step 7000, Loss: 0.05883416160941124, Accuracy: 98.09%, Validation Loss: 2.3657901287078857, Validation Accuracy: 72.64%
I0129 23:42:01.908142 140465626199872 train.py:188] Step 7250, Loss: 0.04659459367394447, Accuracy: 98.55%, Validation Loss: 2.0301849842071533, Validation Accuracy: 73.58%
I0129 23:42:39.532559 140465626199872 train.py:188] Step 7500, Loss: 0.053254202008247375, Accuracy: 98.38%, Validation Loss: 2.897054433822632, Validation Accuracy: 50.00%
I0129 23:42:39.562026 140465626199872 train.py:222] Finished training after 7500 steps.
I0129 23:42:39.575337 140465626199872 eval.py:22] 
======== Starting Evaluation ========
I0129 23:42:39.586054 140465626199872 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/ckpts
I0129 23:42:40.249405 140465626199872 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       87.73584905660378
Balanced_Acc:         88.40579710144928
Sensitivity:          93.47826086956522
Specificity:          83.33333333333334
F1_Score:             86.86868686868686
Confusion_matrix:   
                   [43 10]
                   [ 3 50]


I0129 23:42:40.880964 140465626199872 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       76.69902912621359
Balanced_Acc:         75.3875968992248
Sensitivity:          67.44186046511628
Specificity:          83.33333333333334
F1_Score:             70.73170731707317
Confusion_matrix:   
                   [29 10]
                   [14 50]


I0129 23:42:40.881223 140465626199872 eval.py:66] ======== Finished Evaluation ========
I0129 23:42:40.881505 140465626199872 visualization.py:90] 
======== Starting DeepVis ========
I0129 23:42:42.078004 140465626199872 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/plot/train/deepvis_IDRiD_001.jpg
I0129 23:42:42.488332 140465626199872 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/plot/test/deepvis_IDRiD_001.jpg
I0129 23:42:42.905446 140465626199872 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/plot/train/deepvis_IDRiD_009.jpg
I0129 23:42:43.321003 140465626199872 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-23-36-764438/plot/test/deepvis_IDRiD_009.jpg
I0129 23:42:43.385151 140465626199872 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_02"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 250, 250, 8)       1184      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 244, 244, 16)      6288      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 122, 122, 16)      0         
_________________________________________________________________
batch_normalization (BatchNo (None, 122, 122, 16)      64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 118, 118, 32)      12832     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 59, 59, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 59, 59, 32)        128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 57, 57, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 64)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 128)       73856     
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 16)                2064      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 115,202
Trainable params: 114,978
Non-trainable params: 224
_________________________________________________________________
2022-01-29 23:42:46.832699: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-29 23:42:47.239323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0129 23:42:47.573769 139902091855680 main.py:50] TFRecords files already exist. Proceed with the execution
I0129 23:42:48.921394 139902091855680 architectures.py:143] team20_cnn_02 input shape:  (None, 256, 256, 3)
I0129 23:42:48.921529 139902091855680 architectures.py:144] team20_cnn_02 output shape: (None, 2)
I0129 23:42:48.921729 139902091855680 main.py:117] Running model: cnn_02
I0129 23:42:48.922669 139902091855680 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641
I0129 23:42:48.922732 139902091855680 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220129-234248
I0129 23:42:48.933542 139902091855680 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0129 23:42:48.933611 139902091855680 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts
I0129 23:42:48.933647 139902091855680 train.py:171] 
======== Starting Training ========
2022-01-29 23:42:48.959155: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-29 23:42:50.375464: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0129 23:43:32.361027 139902091855680 train.py:188] Step 250, Loss: 0.6365060806274414, Accuracy: 66.63%, Validation Loss: 1.1965159177780151, Validation Accuracy: 51.89%
I0129 23:43:32.375818 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:44:09.927039 139902091855680 train.py:188] Step 500, Loss: 0.5939369797706604, Accuracy: 69.95%, Validation Loss: 0.8598960041999817, Validation Accuracy: 54.72%
I0129 23:44:09.956189 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:44:47.793087 139902091855680 train.py:188] Step 750, Loss: 0.582054615020752, Accuracy: 71.19%, Validation Loss: 0.572292685508728, Validation Accuracy: 67.92%
I0129 23:44:47.811251 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:45:25.426721 139902091855680 train.py:188] Step 1000, Loss: 0.5691475868225098, Accuracy: 71.66%, Validation Loss: 0.7137484550476074, Validation Accuracy: 61.32%
I0129 23:46:03.284789 139902091855680 train.py:188] Step 1250, Loss: 0.4746640920639038, Accuracy: 76.93%, Validation Loss: 0.7699847221374512, Validation Accuracy: 59.43%
I0129 23:46:40.941613 139902091855680 train.py:188] Step 1500, Loss: 0.3696903586387634, Accuracy: 82.80%, Validation Loss: 0.540920615196228, Validation Accuracy: 71.70%
I0129 23:46:40.964074 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:47:18.825896 139902091855680 train.py:188] Step 1750, Loss: 0.3463199734687805, Accuracy: 85.19%, Validation Loss: 0.40837231278419495, Validation Accuracy: 83.02%
I0129 23:47:18.853620 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:47:56.484544 139902091855680 train.py:188] Step 2000, Loss: 0.2925855219364166, Accuracy: 87.76%, Validation Loss: 0.47047939896583557, Validation Accuracy: 79.25%
I0129 23:48:34.397474 139902091855680 train.py:188] Step 2250, Loss: 0.2577662169933319, Accuracy: 89.32%, Validation Loss: 0.3826373815536499, Validation Accuracy: 82.08%
I0129 23:49:12.040363 139902091855680 train.py:188] Step 2500, Loss: 0.2382514327764511, Accuracy: 90.40%, Validation Loss: 0.40832987427711487, Validation Accuracy: 86.79%
I0129 23:49:12.063236 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:49:49.956545 139902091855680 train.py:188] Step 2750, Loss: 0.22917278110980988, Accuracy: 90.87%, Validation Loss: 0.6977551579475403, Validation Accuracy: 83.02%
I0129 23:50:27.679965 139902091855680 train.py:188] Step 3000, Loss: 0.20548684895038605, Accuracy: 92.13%, Validation Loss: 1.2777721881866455, Validation Accuracy: 71.70%
I0129 23:51:05.644197 139902091855680 train.py:188] Step 3250, Loss: 0.18735440075397491, Accuracy: 92.72%, Validation Loss: 0.5182878375053406, Validation Accuracy: 84.91%
I0129 23:51:43.340293 139902091855680 train.py:188] Step 3500, Loss: 0.17973150312900543, Accuracy: 92.96%, Validation Loss: 0.3775932490825653, Validation Accuracy: 86.79%
I0129 23:52:21.239762 139902091855680 train.py:188] Step 3750, Loss: 0.17627321183681488, Accuracy: 93.16%, Validation Loss: 0.32756781578063965, Validation Accuracy: 86.79%
I0129 23:53:00.232453 139902091855680 train.py:188] Step 4000, Loss: 0.2696283459663391, Accuracy: 87.94%, Validation Loss: 0.5599496960639954, Validation Accuracy: 80.19%
I0129 23:53:39.829081 139902091855680 train.py:188] Step 4250, Loss: 0.2633650302886963, Accuracy: 88.91%, Validation Loss: 0.9306643009185791, Validation Accuracy: 74.53%
I0129 23:54:19.318744 139902091855680 train.py:188] Step 4500, Loss: 0.15678443014621735, Accuracy: 94.08%, Validation Loss: 0.5117926597595215, Validation Accuracy: 83.02%
I0129 23:54:58.424584 139902091855680 train.py:188] Step 4750, Loss: 0.14783485233783722, Accuracy: 94.70%, Validation Loss: 0.7400501370429993, Validation Accuracy: 84.91%
I0129 23:55:38.278806 139902091855680 train.py:188] Step 5000, Loss: 0.13457761704921722, Accuracy: 95.14%, Validation Loss: 0.5203057527542114, Validation Accuracy: 79.25%
I0129 23:56:17.809390 139902091855680 train.py:188] Step 5250, Loss: 0.12988018989562988, Accuracy: 95.22%, Validation Loss: 0.6978686451911926, Validation Accuracy: 83.02%
I0129 23:56:56.617972 139902091855680 train.py:188] Step 5500, Loss: 0.12147360295057297, Accuracy: 95.43%, Validation Loss: 0.9004990458488464, Validation Accuracy: 83.02%
I0129 23:57:36.966717 139902091855680 train.py:188] Step 5750, Loss: 0.12693150341510773, Accuracy: 95.35%, Validation Loss: 0.47499433159828186, Validation Accuracy: 84.91%
I0129 23:58:15.483621 139902091855680 train.py:188] Step 6000, Loss: 0.10654772073030472, Accuracy: 96.12%, Validation Loss: 0.9817355871200562, Validation Accuracy: 77.36%
I0129 23:58:54.985893 139902091855680 train.py:188] Step 6250, Loss: 0.1224634051322937, Accuracy: 95.99%, Validation Loss: 0.6764901876449585, Validation Accuracy: 87.74%
I0129 23:58:55.018242 139902091855680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts.
I0129 23:59:32.948764 139902091855680 train.py:188] Step 6500, Loss: 0.09837626665830612, Accuracy: 96.46%, Validation Loss: 3.961962938308716, Validation Accuracy: 63.21%
I0130 00:00:11.193084 139902091855680 train.py:188] Step 6750, Loss: 0.1085003986954689, Accuracy: 96.27%, Validation Loss: 0.47037273645401, Validation Accuracy: 87.74%
I0130 00:00:48.909303 139902091855680 train.py:188] Step 7000, Loss: 0.08862593024969101, Accuracy: 96.82%, Validation Loss: 0.9298521280288696, Validation Accuracy: 83.96%
I0130 00:01:26.934320 139902091855680 train.py:188] Step 7250, Loss: 0.08294472098350525, Accuracy: 97.01%, Validation Loss: 0.7858615517616272, Validation Accuracy: 83.96%
I0130 00:02:04.820075 139902091855680 train.py:188] Step 7500, Loss: 0.09238137304782867, Accuracy: 96.84%, Validation Loss: 0.6971529722213745, Validation Accuracy: 82.08%
I0130 00:02:04.846729 139902091855680 train.py:222] Finished training after 7500 steps.
I0130 00:02:04.856474 139902091855680 eval.py:22] 
======== Starting Evaluation ========
I0130 00:02:04.864783 139902091855680 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/ckpts
I0130 00:02:05.546775 139902091855680 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       87.73584905660378
Balanced_Acc:         88.40579710144928
Sensitivity:          93.47826086956522
Specificity:          83.33333333333334
F1_Score:             86.86868686868686
Confusion_matrix:   
                   [43 10]
                   [ 3 50]


I0130 00:02:06.178457 139902091855680 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       80.58252427184466
Balanced_Acc:         79.36698717948718
Sensitivity:          74.35897435897436
Specificity:          84.375
F1_Score:             74.35897435897438
Confusion_matrix:   
                   [29 10]
                   [10 54]


I0130 00:02:06.178719 139902091855680 eval.py:66] ======== Finished Evaluation ========
I0130 00:02:06.179021 139902091855680 visualization.py:90] 
======== Starting DeepVis ========
I0130 00:02:07.392785 139902091855680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/plot/train/deepvis_IDRiD_001.jpg
I0130 00:02:07.816715 139902091855680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/plot/test/deepvis_IDRiD_001.jpg
I0130 00:02:08.250506 139902091855680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/plot/train/deepvis_IDRiD_009.jpg
I0130 00:02:08.669507 139902091855680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-29T23-42-47-567641/plot/test/deepvis_IDRiD_009.jpg
I0130 00:02:08.731131 139902091855680 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_02"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 250, 250, 8)       1184      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 244, 244, 16)      6288      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 122, 122, 16)      0         
_________________________________________________________________
batch_normalization (BatchNo (None, 122, 122, 16)      64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 118, 118, 32)      12832     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 59, 59, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 59, 59, 32)        128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 57, 57, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 64)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 128)       73856     
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 16)                2064      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 115,202
Trainable params: 114,978
Non-trainable params: 224
_________________________________________________________________
2022-01-30 00:02:12.263168: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 00:02:12.675522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 00:02:13.015476 140076722636608 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 00:02:14.338984 140076722636608 architectures.py:143] team20_cnn_02 input shape:  (None, 256, 256, 3)
I0130 00:02:14.339115 140076722636608 architectures.py:144] team20_cnn_02 output shape: (None, 2)
I0130 00:02:14.339312 140076722636608 main.py:117] Running model: cnn_02
I0130 00:02:14.340269 140076722636608 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039
I0130 00:02:14.340334 140076722636608 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-000214
I0130 00:02:14.351153 140076722636608 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 00:02:14.351226 140076722636608 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts
I0130 00:02:14.351260 140076722636608 train.py:171] 
======== Starting Training ========
2022-01-30 00:02:14.376777: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 00:02:15.824188: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 00:02:57.985272 140076722636608 train.py:188] Step 250, Loss: 0.626382052898407, Accuracy: 67.30%, Validation Loss: 0.6426548361778259, Validation Accuracy: 69.81%
I0130 00:02:57.998494 140076722636608 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts.
I0130 00:03:35.596556 140076722636608 train.py:188] Step 500, Loss: 0.5487619638442993, Accuracy: 72.24%, Validation Loss: 6.384029388427734, Validation Accuracy: 50.00%
I0130 00:04:13.696390 140076722636608 train.py:188] Step 750, Loss: 0.4577844738960266, Accuracy: 77.71%, Validation Loss: 8.094780921936035, Validation Accuracy: 50.00%
I0130 00:04:51.499343 140076722636608 train.py:188] Step 1000, Loss: 0.3392009437084198, Accuracy: 85.07%, Validation Loss: 1.764622688293457, Validation Accuracy: 50.00%
I0130 00:05:29.486952 140076722636608 train.py:188] Step 1250, Loss: 0.29025742411613464, Accuracy: 87.54%, Validation Loss: 2.1787052154541016, Validation Accuracy: 50.00%
I0130 00:06:07.130417 140076722636608 train.py:188] Step 1500, Loss: 0.23980624973773956, Accuracy: 90.13%, Validation Loss: 1.093429684638977, Validation Accuracy: 64.15%
I0130 00:06:45.129642 140076722636608 train.py:188] Step 1750, Loss: 0.22449377179145813, Accuracy: 90.99%, Validation Loss: 1.3966716527938843, Validation Accuracy: 70.75%
I0130 00:06:45.153587 140076722636608 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts.
I0130 00:07:22.879438 140076722636608 train.py:188] Step 2000, Loss: 0.18081936240196228, Accuracy: 92.59%, Validation Loss: 0.7753421664237976, Validation Accuracy: 78.30%
I0130 00:07:22.910901 140076722636608 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts.
I0130 00:08:01.039878 140076722636608 train.py:188] Step 2250, Loss: 0.14860953390598297, Accuracy: 94.29%, Validation Loss: 0.5889463424682617, Validation Accuracy: 83.02%
I0130 00:08:01.054746 140076722636608 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts.
I0130 00:08:38.803821 140076722636608 train.py:188] Step 2500, Loss: 0.14890238642692566, Accuracy: 94.55%, Validation Loss: 5.291736602783203, Validation Accuracy: 54.72%
I0130 00:09:16.945887 140076722636608 train.py:188] Step 2750, Loss: 0.14558535814285278, Accuracy: 94.74%, Validation Loss: 0.2978045344352722, Validation Accuracy: 91.51%
I0130 00:09:16.963722 140076722636608 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts.
I0130 00:09:54.817070 140076722636608 train.py:188] Step 3000, Loss: 0.13797110319137573, Accuracy: 95.10%, Validation Loss: 0.722119152545929, Validation Accuracy: 83.02%
I0130 00:10:32.820346 140076722636608 train.py:188] Step 3250, Loss: 0.11274022608995438, Accuracy: 95.86%, Validation Loss: 0.7284681797027588, Validation Accuracy: 79.25%
I0130 00:11:10.753129 140076722636608 train.py:188] Step 3500, Loss: 0.16907182335853577, Accuracy: 93.93%, Validation Loss: 0.9707980155944824, Validation Accuracy: 77.36%
I0130 00:11:48.731219 140076722636608 train.py:188] Step 3750, Loss: 0.124884232878685, Accuracy: 95.47%, Validation Loss: 0.7893487215042114, Validation Accuracy: 79.25%
I0130 00:12:26.590886 140076722636608 train.py:188] Step 4000, Loss: 0.11147942394018173, Accuracy: 96.21%, Validation Loss: 0.7846115827560425, Validation Accuracy: 82.08%
I0130 00:13:04.620206 140076722636608 train.py:188] Step 4250, Loss: 0.08270124346017838, Accuracy: 97.08%, Validation Loss: 1.8067818880081177, Validation Accuracy: 79.25%
I0130 00:13:42.392445 140076722636608 train.py:188] Step 4500, Loss: 0.10651113092899323, Accuracy: 96.24%, Validation Loss: 0.6677634119987488, Validation Accuracy: 83.02%
I0130 00:14:20.587608 140076722636608 train.py:188] Step 4750, Loss: 0.08845887333154678, Accuracy: 96.98%, Validation Loss: 1.8939024209976196, Validation Accuracy: 72.64%
I0130 00:14:58.335015 140076722636608 train.py:188] Step 5000, Loss: 0.0746345967054367, Accuracy: 97.49%, Validation Loss: 1.0614805221557617, Validation Accuracy: 82.08%
I0130 00:15:36.302209 140076722636608 train.py:188] Step 5250, Loss: 0.08135446161031723, Accuracy: 97.35%, Validation Loss: 4.87885046005249, Validation Accuracy: 65.09%
I0130 00:16:14.022741 140076722636608 train.py:188] Step 5500, Loss: 0.06925452500581741, Accuracy: 97.58%, Validation Loss: 1.0498045682907104, Validation Accuracy: 76.42%
I0130 00:16:52.193019 140076722636608 train.py:188] Step 5750, Loss: 0.11158553510904312, Accuracy: 96.38%, Validation Loss: 1.618208646774292, Validation Accuracy: 72.64%
I0130 00:17:29.939579 140076722636608 train.py:188] Step 6000, Loss: 0.06219422072172165, Accuracy: 97.98%, Validation Loss: 1.5719778537750244, Validation Accuracy: 81.13%
I0130 00:18:07.826742 140076722636608 train.py:188] Step 6250, Loss: 0.06464477628469467, Accuracy: 97.81%, Validation Loss: 1.502172827720642, Validation Accuracy: 76.42%
I0130 00:18:45.632663 140076722636608 train.py:188] Step 6500, Loss: 0.06497058272361755, Accuracy: 97.93%, Validation Loss: 1.939414143562317, Validation Accuracy: 69.81%
I0130 00:19:23.532439 140076722636608 train.py:188] Step 6750, Loss: 0.07087474316358566, Accuracy: 97.69%, Validation Loss: 1.5169310569763184, Validation Accuracy: 78.30%
I0130 00:20:01.349065 140076722636608 train.py:188] Step 7000, Loss: 0.05099238082766533, Accuracy: 98.21%, Validation Loss: 1.1302515268325806, Validation Accuracy: 76.42%
I0130 00:20:39.565019 140076722636608 train.py:188] Step 7250, Loss: 0.058174215257167816, Accuracy: 98.12%, Validation Loss: 0.6055369973182678, Validation Accuracy: 86.79%
I0130 00:21:17.254591 140076722636608 train.py:188] Step 7500, Loss: 0.052872560918331146, Accuracy: 98.38%, Validation Loss: 2.1382319927215576, Validation Accuracy: 77.36%
I0130 00:21:17.276285 140076722636608 train.py:222] Finished training after 7500 steps.
I0130 00:21:17.294225 140076722636608 eval.py:22] 
======== Starting Evaluation ========
I0130 00:21:17.302628 140076722636608 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/ckpts
I0130 00:21:17.962980 140076722636608 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       91.50943396226415
Balanced_Acc:         91.52421652421653
Sensitivity:          92.3076923076923
Specificity:          90.74074074074075
F1_Score:             91.42857142857143
Confusion_matrix:   
                   [48  5]
                   [ 4 49]


I0130 00:21:18.599963 140076722636608 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       80.58252427184466
Balanced_Acc:         80.06424792139077
Sensitivity:          69.38775510204081
Specificity:          90.74074074074075
F1_Score:             77.27272727272728
Confusion_matrix:   
                   [34  5]
                   [15 49]


I0130 00:21:18.600234 140076722636608 eval.py:66] ======== Finished Evaluation ========
I0130 00:21:18.600536 140076722636608 visualization.py:90] 
======== Starting DeepVis ========
I0130 00:21:19.797591 140076722636608 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/plot/train/deepvis_IDRiD_001.jpg
I0130 00:21:20.212097 140076722636608 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/plot/test/deepvis_IDRiD_001.jpg
I0130 00:21:20.621898 140076722636608 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/plot/train/deepvis_IDRiD_009.jpg
I0130 00:21:21.028362 140076722636608 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-02-12-994039/plot/test/deepvis_IDRiD_009.jpg
I0130 00:21:21.089691 140076722636608 visualization.py:165] ======== Finished DeepVis ========
Model: "team20_cnn_02"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 250, 250, 8)       1184      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 244, 244, 16)      6288      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 122, 122, 16)      0         
_________________________________________________________________
batch_normalization (BatchNo (None, 122, 122, 16)      64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 118, 118, 32)      12832     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 59, 59, 32)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 59, 59, 32)        128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 57, 57, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 64)        0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 128)       73856     
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 16)                2064      
_________________________________________________________________
dropout_1 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 34        
=================================================================
Total params: 115,202
Trainable params: 114,978
Non-trainable params: 224
_________________________________________________________________
2022-01-30 00:21:24.566607: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 00:21:24.990954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 00:21:25.320075 140541537462080 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 00:21:26.729406 140541537462080 main.py:117] Running model: resnet
I0130 00:21:26.731653 140541537462080 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915
I0130 00:21:26.731722 140541537462080 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-002126
I0130 00:21:26.742002 140541537462080 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 00:21:26.742081 140541537462080 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts
I0130 00:21:26.742116 140541537462080 train.py:171] 
======== Starting Training ========
2022-01-30 00:21:26.767823: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 00:21:28.461510: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 00:22:23.659709 140541537462080 train.py:188] Step 250, Loss: 0.5562068819999695, Accuracy: 71.72%, Validation Loss: 0.684028148651123, Validation Accuracy: 56.60%
I0130 00:22:23.676735 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:23:15.489317 140541537462080 train.py:188] Step 500, Loss: 0.48004570603370667, Accuracy: 77.06%, Validation Loss: 0.9806182384490967, Validation Accuracy: 50.00%
I0130 00:24:07.856399 140541537462080 train.py:188] Step 750, Loss: 0.42488065361976624, Accuracy: 80.05%, Validation Loss: 0.526041567325592, Validation Accuracy: 72.64%
I0130 00:24:07.883909 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:24:59.788955 140541537462080 train.py:188] Step 1000, Loss: 0.37901774048805237, Accuracy: 82.91%, Validation Loss: 0.46692681312561035, Validation Accuracy: 81.13%
I0130 00:24:59.820852 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:25:51.961402 140541537462080 train.py:188] Step 1250, Loss: 0.33510205149650574, Accuracy: 85.44%, Validation Loss: 0.3234468400478363, Validation Accuracy: 83.02%
I0130 00:25:51.990999 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:26:43.859634 140541537462080 train.py:188] Step 1500, Loss: 0.3133063316345215, Accuracy: 86.52%, Validation Loss: 0.6122851371765137, Validation Accuracy: 84.91%
I0130 00:26:43.899530 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:27:36.168148 140541537462080 train.py:188] Step 1750, Loss: 0.2886092960834503, Accuracy: 88.09%, Validation Loss: 0.3900110423564911, Validation Accuracy: 83.02%
I0130 00:28:28.114769 140541537462080 train.py:188] Step 2000, Loss: 0.2678073048591614, Accuracy: 89.28%, Validation Loss: 0.35664767026901245, Validation Accuracy: 87.74%
I0130 00:28:28.137421 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:29:20.365436 140541537462080 train.py:188] Step 2250, Loss: 0.2518453598022461, Accuracy: 89.86%, Validation Loss: 0.363768994808197, Validation Accuracy: 87.74%
I0130 00:30:12.205714 140541537462080 train.py:188] Step 2500, Loss: 0.25078463554382324, Accuracy: 89.84%, Validation Loss: 0.3785799741744995, Validation Accuracy: 81.13%
I0130 00:31:04.575127 140541537462080 train.py:188] Step 2750, Loss: 0.23308615386486053, Accuracy: 90.79%, Validation Loss: 0.3253417909145355, Validation Accuracy: 83.96%
I0130 00:31:56.482246 140541537462080 train.py:188] Step 3000, Loss: 0.21610888838768005, Accuracy: 91.16%, Validation Loss: 0.39221450686454773, Validation Accuracy: 83.96%
I0130 00:32:48.723169 140541537462080 train.py:188] Step 3250, Loss: 0.2264116257429123, Accuracy: 90.83%, Validation Loss: 0.30301350355148315, Validation Accuracy: 88.68%
I0130 00:32:48.745078 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:33:40.638359 140541537462080 train.py:188] Step 3500, Loss: 0.2234426885843277, Accuracy: 91.16%, Validation Loss: 0.3068928122520447, Validation Accuracy: 90.57%
I0130 00:33:40.662877 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:34:33.003573 140541537462080 train.py:188] Step 3750, Loss: 0.22418448328971863, Accuracy: 91.13%, Validation Loss: 0.3306410014629364, Validation Accuracy: 83.96%
I0130 00:35:24.912882 140541537462080 train.py:188] Step 4000, Loss: 0.19733385741710663, Accuracy: 92.00%, Validation Loss: 0.24395966529846191, Validation Accuracy: 87.74%
I0130 00:36:17.150484 140541537462080 train.py:188] Step 4250, Loss: 0.19576792418956757, Accuracy: 92.29%, Validation Loss: 0.4842110872268677, Validation Accuracy: 88.68%
I0130 00:37:09.123555 140541537462080 train.py:188] Step 4500, Loss: 0.18982893228530884, Accuracy: 92.54%, Validation Loss: 0.20603413879871368, Validation Accuracy: 90.57%
I0130 00:38:01.513536 140541537462080 train.py:188] Step 4750, Loss: 0.18175627291202545, Accuracy: 92.61%, Validation Loss: 0.3396001160144806, Validation Accuracy: 83.02%
I0130 00:38:53.422689 140541537462080 train.py:188] Step 5000, Loss: 0.17166581749916077, Accuracy: 93.31%, Validation Loss: 0.47073403000831604, Validation Accuracy: 86.79%
I0130 00:39:45.698536 140541537462080 train.py:188] Step 5250, Loss: 0.17191453278064728, Accuracy: 93.28%, Validation Loss: 0.29436343908309937, Validation Accuracy: 85.85%
I0130 00:40:37.711646 140541537462080 train.py:188] Step 5500, Loss: 0.17568209767341614, Accuracy: 93.10%, Validation Loss: 0.3969571590423584, Validation Accuracy: 88.68%
I0130 00:41:30.093048 140541537462080 train.py:188] Step 5750, Loss: 0.1597442477941513, Accuracy: 93.70%, Validation Loss: 0.21865543723106384, Validation Accuracy: 92.45%
I0130 00:41:30.113840 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:42:22.066854 140541537462080 train.py:188] Step 6000, Loss: 0.16520357131958008, Accuracy: 93.46%, Validation Loss: 0.25394245982170105, Validation Accuracy: 93.40%
I0130 00:42:22.086664 140541537462080 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts.
I0130 00:43:14.404043 140541537462080 train.py:188] Step 6250, Loss: 0.15929733216762543, Accuracy: 93.78%, Validation Loss: 0.7019917368888855, Validation Accuracy: 76.42%
I0130 00:44:06.274682 140541537462080 train.py:188] Step 6500, Loss: 0.1559482216835022, Accuracy: 94.05%, Validation Loss: 0.4395364224910736, Validation Accuracy: 83.96%
I0130 00:44:58.451583 140541537462080 train.py:188] Step 6750, Loss: 0.14392048120498657, Accuracy: 94.29%, Validation Loss: 0.4094392955303192, Validation Accuracy: 90.57%
I0130 00:45:50.528250 140541537462080 train.py:188] Step 7000, Loss: 0.14684803783893585, Accuracy: 94.44%, Validation Loss: 0.3698408305644989, Validation Accuracy: 84.91%
I0130 00:46:42.793011 140541537462080 train.py:188] Step 7250, Loss: 0.15408708155155182, Accuracy: 94.18%, Validation Loss: 0.35051870346069336, Validation Accuracy: 87.74%
I0130 00:47:34.640377 140541537462080 train.py:188] Step 7500, Loss: 0.14319171011447906, Accuracy: 94.64%, Validation Loss: 0.5615373849868774, Validation Accuracy: 86.79%
I0130 00:47:34.669394 140541537462080 train.py:222] Finished training after 7500 steps.
I0130 00:47:34.690000 140541537462080 eval.py:22] 
======== Starting Evaluation ========
I0130 00:47:34.711119 140541537462080 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/ckpts
I0130 00:47:35.030342 140541537462080 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       93.39622641509435
Balanced_Acc:         93.4116809116809
Sensitivity:          94.23076923076923
Specificity:          92.5925925925926
F1_Score:             93.33333333333333
Confusion_matrix:   
                   [49  4]
                   [ 3 50]


I0130 00:47:35.405367 140541537462080 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       78.64077669902912
Balanced_Acc:         77.58403361344538
Sensitivity:          74.28571428571429
Specificity:          80.88235294117648
F1_Score:             70.27027027027027
Confusion_matrix:   
                   [26 13]
                   [ 9 55]


I0130 00:47:35.405641 140541537462080 eval.py:66] ======== Finished Evaluation ========
I0130 00:47:35.405930 140541537462080 visualization.py:90] 
======== Starting DeepVis ========
I0130 00:47:36.474064 140541537462080 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/plot/train/deepvis_IDRiD_001.jpg
I0130 00:47:36.930692 140541537462080 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/plot/test/deepvis_IDRiD_001.jpg
I0130 00:47:37.390374 140541537462080 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/plot/train/deepvis_IDRiD_009.jpg
I0130 00:47:37.846849 140541537462080 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-21-25-313915/plot/test/deepvis_IDRiD_009.jpg
I0130 00:47:37.908890 140541537462080 visualization.py:165] ======== Finished DeepVis ========
Model: "resnet"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
stem (Sequential)               (None, 256, 256, 32) 1024        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 128, 4)  1156        stem[0][0]                       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128, 128, 4)  16          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 128, 128, 4)  16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 4)  132         stem[0][0]                       
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128, 4)  0           batch_normalization_2[0][0]      
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 128, 128, 4)  0           add[0][0]                        
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 4)  148         re_lu[0][0]                      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128, 128, 4)  16          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 128, 4)  16          conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 128, 128, 4)  20          re_lu[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 128, 4)  0           batch_normalization_4[0][0]      
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 128, 128, 4)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 64, 8)    296         re_lu_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64, 64, 8)    32          conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 64, 8)    584         batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 64, 64, 8)    32          conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 64, 8)    40          re_lu_1[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 64, 64, 8)    0           batch_normalization_6[0][0]      
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64, 64, 8)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 64, 64, 8)    584         re_lu_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 64, 64, 8)    32          conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 64, 64, 8)    584         batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 64, 64, 8)    32          conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 64, 64, 8)    72          re_lu_2[0][0]                    
__________________________________________________________________________________________________
add_3 (Add)                     (None, 64, 64, 8)    0           batch_normalization_8[0][0]      
                                                                 conv2d_12[0][0]                  
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64, 64, 8)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 32)   2336        re_lu_3[0][0]                    
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 39)           1287        global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            80          dropout[0][0]                    
==================================================================================================
Total params: 8,831
Trainable params: 8,671
Non-trainable params: 160
__________________________________________________________________________________________________
2022-01-30 00:47:41.359857: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 00:47:41.766168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 00:47:42.092803 140012778575680 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 00:47:43.460516 140012778575680 main.py:117] Running model: resnet
I0130 00:47:43.462709 140012778575680 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742
I0130 00:47:43.462789 140012778575680 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-004743
I0130 00:47:43.472873 140012778575680 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 00:47:43.472933 140012778575680 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts
I0130 00:47:43.472966 140012778575680 train.py:171] 
======== Starting Training ========
2022-01-30 00:47:43.499255: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 00:47:45.194436: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 00:48:40.571306 140012778575680 train.py:188] Step 250, Loss: 0.5471586585044861, Accuracy: 71.91%, Validation Loss: 0.7117719650268555, Validation Accuracy: 50.00%
I0130 00:48:40.585006 140012778575680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts.
I0130 00:49:32.401588 140012778575680 train.py:188] Step 500, Loss: 0.41290968656539917, Accuracy: 79.18%, Validation Loss: 0.6969470381736755, Validation Accuracy: 56.60%
I0130 00:49:32.424085 140012778575680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts.
I0130 00:50:24.670153 140012778575680 train.py:188] Step 750, Loss: 0.3253035247325897, Accuracy: 84.66%, Validation Loss: 0.2668488025665283, Validation Accuracy: 86.79%
I0130 00:50:24.695616 140012778575680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts.
I0130 00:51:16.654891 140012778575680 train.py:188] Step 1000, Loss: 0.2965821921825409, Accuracy: 87.03%, Validation Loss: 1.4322534799575806, Validation Accuracy: 61.32%
I0130 00:52:08.826525 140012778575680 train.py:188] Step 1250, Loss: 0.2742546498775482, Accuracy: 87.92%, Validation Loss: 0.3628423810005188, Validation Accuracy: 84.91%
I0130 00:53:00.939119 140012778575680 train.py:188] Step 1500, Loss: 0.2388612926006317, Accuracy: 89.52%, Validation Loss: 0.5130535960197449, Validation Accuracy: 79.25%
I0130 00:53:53.352649 140012778575680 train.py:188] Step 1750, Loss: 0.2438002973794937, Accuracy: 89.32%, Validation Loss: 0.27783530950546265, Validation Accuracy: 84.91%
I0130 00:54:45.357267 140012778575680 train.py:188] Step 2000, Loss: 0.22036972641944885, Accuracy: 90.65%, Validation Loss: 0.35911011695861816, Validation Accuracy: 83.96%
I0130 00:55:37.549093 140012778575680 train.py:188] Step 2250, Loss: 0.2109098732471466, Accuracy: 91.28%, Validation Loss: 0.47207358479499817, Validation Accuracy: 77.36%
I0130 00:56:29.375071 140012778575680 train.py:188] Step 2500, Loss: 0.21323411166667938, Accuracy: 91.34%, Validation Loss: 0.2935353219509125, Validation Accuracy: 84.91%
I0130 00:57:21.675877 140012778575680 train.py:188] Step 2750, Loss: 0.20368599891662598, Accuracy: 91.88%, Validation Loss: 0.8791305422782898, Validation Accuracy: 74.53%
I0130 00:58:13.678812 140012778575680 train.py:188] Step 3000, Loss: 0.1942652016878128, Accuracy: 92.00%, Validation Loss: 0.5219088196754456, Validation Accuracy: 78.30%
I0130 00:59:06.130798 140012778575680 train.py:188] Step 3250, Loss: 0.18147355318069458, Accuracy: 92.91%, Validation Loss: 0.15557602047920227, Validation Accuracy: 94.34%
I0130 00:59:06.161170 140012778575680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts.
I0130 00:59:58.177806 140012778575680 train.py:188] Step 3500, Loss: 0.17178216576576233, Accuracy: 93.26%, Validation Loss: 0.18389718234539032, Validation Accuracy: 92.45%
I0130 01:00:50.782634 140012778575680 train.py:188] Step 3750, Loss: 0.18239200115203857, Accuracy: 92.80%, Validation Loss: 0.27050700783729553, Validation Accuracy: 89.62%
I0130 01:01:42.904197 140012778575680 train.py:188] Step 4000, Loss: 0.16369254887104034, Accuracy: 93.53%, Validation Loss: 0.34969761967658997, Validation Accuracy: 80.19%
I0130 01:02:35.497478 140012778575680 train.py:188] Step 4250, Loss: 0.15830989181995392, Accuracy: 93.71%, Validation Loss: 0.3470557630062103, Validation Accuracy: 84.91%
I0130 01:03:27.682269 140012778575680 train.py:188] Step 4500, Loss: 0.16065962612628937, Accuracy: 93.65%, Validation Loss: 0.402805894613266, Validation Accuracy: 85.85%
I0130 01:04:20.153495 140012778575680 train.py:188] Step 4750, Loss: 0.16682957112789154, Accuracy: 93.56%, Validation Loss: 0.30403071641921997, Validation Accuracy: 83.96%
I0130 01:05:12.376992 140012778575680 train.py:188] Step 5000, Loss: 0.14252004027366638, Accuracy: 94.40%, Validation Loss: 0.4679289162158966, Validation Accuracy: 83.02%
I0130 01:06:05.094770 140012778575680 train.py:188] Step 5250, Loss: 0.14090430736541748, Accuracy: 94.52%, Validation Loss: 0.45473629236221313, Validation Accuracy: 84.91%
I0130 01:06:57.079785 140012778575680 train.py:188] Step 5500, Loss: 0.13886725902557373, Accuracy: 94.27%, Validation Loss: 0.34582918882369995, Validation Accuracy: 83.96%
I0130 01:07:49.419282 140012778575680 train.py:188] Step 5750, Loss: 0.15525422990322113, Accuracy: 94.19%, Validation Loss: 0.3773009479045868, Validation Accuracy: 85.85%
I0130 01:08:41.529053 140012778575680 train.py:188] Step 6000, Loss: 0.13665947318077087, Accuracy: 94.75%, Validation Loss: 0.2004236876964569, Validation Accuracy: 90.57%
I0130 01:09:34.062205 140012778575680 train.py:188] Step 6250, Loss: 0.12910892069339752, Accuracy: 94.93%, Validation Loss: 0.17640480399131775, Validation Accuracy: 93.40%
I0130 01:10:26.334120 140012778575680 train.py:188] Step 6500, Loss: 0.13696524500846863, Accuracy: 94.75%, Validation Loss: 0.17612788081169128, Validation Accuracy: 90.57%
I0130 01:11:18.947474 140012778575680 train.py:188] Step 6750, Loss: 0.14027130603790283, Accuracy: 94.76%, Validation Loss: 0.1827094852924347, Validation Accuracy: 88.68%
I0130 01:12:11.089057 140012778575680 train.py:188] Step 7000, Loss: 0.12550556659698486, Accuracy: 95.19%, Validation Loss: 0.15674713253974915, Validation Accuracy: 96.23%
I0130 01:12:11.110675 140012778575680 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts.
I0130 01:13:03.587764 140012778575680 train.py:188] Step 7250, Loss: 0.12633736431598663, Accuracy: 95.16%, Validation Loss: 0.14516907930374146, Validation Accuracy: 92.45%
I0130 01:13:55.530755 140012778575680 train.py:188] Step 7500, Loss: 0.12827958166599274, Accuracy: 95.15%, Validation Loss: 0.5992542505264282, Validation Accuracy: 82.08%
I0130 01:13:55.556248 140012778575680 train.py:222] Finished training after 7500 steps.
I0130 01:14:05.422369 140012778575680 eval.py:22] 
======== Starting Evaluation ========
I0130 01:14:05.445024 140012778575680 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/ckpts
I0130 01:14:05.781610 140012778575680 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       96.22641509433963
Balanced_Acc:         96.29233511586452
Sensitivity:          98.0392156862745
Specificity:          94.54545454545455
F1_Score:             96.15384615384616
Confusion_matrix:   
                   [50  3]
                   [ 1 52]


I0130 01:14:06.153446 140012778575680 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       79.6116504854369
Balanced_Acc:         78.6422578184592
Sensitivity:          69.56521739130434
Specificity:          87.71929824561403
F1_Score:             75.29411764705883
Confusion_matrix:   
                   [32  7]
                   [14 50]


I0130 01:14:06.153707 140012778575680 eval.py:66] ======== Finished Evaluation ========
I0130 01:14:06.153975 140012778575680 visualization.py:90] 
======== Starting DeepVis ========
I0130 01:14:07.189093 140012778575680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/plot/train/deepvis_IDRiD_001.jpg
I0130 01:14:07.658187 140012778575680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/plot/test/deepvis_IDRiD_001.jpg
I0130 01:14:08.111546 140012778575680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/plot/train/deepvis_IDRiD_009.jpg
I0130 01:14:08.558261 140012778575680 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T00-47-42-086742/plot/test/deepvis_IDRiD_009.jpg
I0130 01:14:08.617741 140012778575680 visualization.py:165] ======== Finished DeepVis ========
Model: "resnet"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
stem (Sequential)               (None, 256, 256, 32) 1024        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 128, 4)  1156        stem[0][0]                       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128, 128, 4)  16          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 128, 128, 4)  16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 4)  132         stem[0][0]                       
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128, 4)  0           batch_normalization_2[0][0]      
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 128, 128, 4)  0           add[0][0]                        
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 4)  148         re_lu[0][0]                      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128, 128, 4)  16          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 128, 4)  16          conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 128, 128, 4)  20          re_lu[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 128, 4)  0           batch_normalization_4[0][0]      
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 128, 128, 4)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 64, 8)    296         re_lu_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64, 64, 8)    32          conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 64, 8)    584         batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 64, 64, 8)    32          conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 64, 8)    40          re_lu_1[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 64, 64, 8)    0           batch_normalization_6[0][0]      
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64, 64, 8)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 64, 64, 8)    584         re_lu_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 64, 64, 8)    32          conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 64, 64, 8)    584         batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 64, 64, 8)    32          conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 64, 64, 8)    72          re_lu_2[0][0]                    
__________________________________________________________________________________________________
add_3 (Add)                     (None, 64, 64, 8)    0           batch_normalization_8[0][0]      
                                                                 conv2d_12[0][0]                  
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64, 64, 8)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 32)   2336        re_lu_3[0][0]                    
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 39)           1287        global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            80          dropout[0][0]                    
==================================================================================================
Total params: 8,831
Trainable params: 8,671
Non-trainable params: 160
__________________________________________________________________________________________________
2022-01-30 01:14:12.016484: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 01:14:12.429946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 01:14:12.748033 140360185870144 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 01:14:14.094035 140360185870144 main.py:117] Running model: resnet
I0130 01:14:14.096205 140360185870144 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915
I0130 01:14:14.096276 140360185870144 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-011414
I0130 01:14:14.106146 140360185870144 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 01:14:14.106203 140360185870144 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/ckpts
I0130 01:14:14.106236 140360185870144 train.py:171] 
======== Starting Training ========
2022-01-30 01:14:14.131038: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 01:14:15.766112: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 01:15:11.576451 140360185870144 train.py:188] Step 250, Loss: 0.5786133408546448, Accuracy: 70.08%, Validation Loss: 0.6866541504859924, Validation Accuracy: 66.04%
I0130 01:15:11.588761 140360185870144 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/ckpts.
I0130 01:16:05.356180 140360185870144 train.py:188] Step 500, Loss: 0.46226948499679565, Accuracy: 76.96%, Validation Loss: 0.5962554812431335, Validation Accuracy: 62.26%
I0130 01:16:59.371639 140360185870144 train.py:188] Step 750, Loss: 0.3285064101219177, Accuracy: 85.18%, Validation Loss: 0.22455859184265137, Validation Accuracy: 92.45%
I0130 01:16:59.398709 140360185870144 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/ckpts.
I0130 01:17:53.249175 140360185870144 train.py:188] Step 1000, Loss: 0.26693785190582275, Accuracy: 88.32%, Validation Loss: 0.20968401432037354, Validation Accuracy: 91.51%
I0130 01:18:47.646766 140360185870144 train.py:188] Step 1250, Loss: 0.2515980899333954, Accuracy: 89.60%, Validation Loss: 0.39781737327575684, Validation Accuracy: 83.02%
I0130 01:19:41.501990 140360185870144 train.py:188] Step 1500, Loss: 0.23329001665115356, Accuracy: 90.60%, Validation Loss: 0.280208557844162, Validation Accuracy: 89.62%
I0130 01:20:35.515784 140360185870144 train.py:188] Step 1750, Loss: 0.22173550724983215, Accuracy: 91.06%, Validation Loss: 0.1726372390985489, Validation Accuracy: 89.62%
I0130 01:21:29.506963 140360185870144 train.py:188] Step 2000, Loss: 0.20892712473869324, Accuracy: 91.63%, Validation Loss: 0.44705379009246826, Validation Accuracy: 82.08%
I0130 01:22:23.854988 140360185870144 train.py:188] Step 2250, Loss: 0.19105887413024902, Accuracy: 91.86%, Validation Loss: 0.24226249754428864, Validation Accuracy: 91.51%
I0130 01:23:17.761420 140360185870144 train.py:188] Step 2500, Loss: 0.1940508931875229, Accuracy: 92.29%, Validation Loss: 0.1889721304178238, Validation Accuracy: 87.74%
I0130 01:24:12.017455 140360185870144 train.py:188] Step 2750, Loss: 0.18471087515354156, Accuracy: 92.60%, Validation Loss: 0.3761923015117645, Validation Accuracy: 83.02%
I0130 01:25:05.943494 140360185870144 train.py:188] Step 3000, Loss: 0.17651312053203583, Accuracy: 92.98%, Validation Loss: 0.3131110668182373, Validation Accuracy: 84.91%
I0130 01:26:00.247770 140360185870144 train.py:188] Step 3250, Loss: 0.17303840816020966, Accuracy: 93.04%, Validation Loss: 0.33431851863861084, Validation Accuracy: 85.85%
I0130 01:26:54.240308 140360185870144 train.py:188] Step 3500, Loss: 0.17145422101020813, Accuracy: 93.00%, Validation Loss: 0.27064621448516846, Validation Accuracy: 88.68%
I0130 01:27:48.573838 140360185870144 train.py:188] Step 3750, Loss: 0.15868167579174042, Accuracy: 93.79%, Validation Loss: 0.6671733260154724, Validation Accuracy: 74.53%
I0130 01:28:42.531298 140360185870144 train.py:188] Step 4000, Loss: 0.1875218003988266, Accuracy: 92.64%, Validation Loss: 0.6694457530975342, Validation Accuracy: 75.47%
I0130 01:29:36.797296 140360185870144 train.py:188] Step 4250, Loss: 0.16111163794994354, Accuracy: 93.68%, Validation Loss: 0.4819944500923157, Validation Accuracy: 70.75%
I0130 01:30:30.642623 140360185870144 train.py:188] Step 4500, Loss: 0.15115246176719666, Accuracy: 94.31%, Validation Loss: 0.5767974257469177, Validation Accuracy: 80.19%
I0130 01:31:25.042322 140360185870144 train.py:188] Step 4750, Loss: 0.13945981860160828, Accuracy: 94.23%, Validation Loss: 0.21520675718784332, Validation Accuracy: 90.57%
I0130 01:32:18.952538 140360185870144 train.py:188] Step 5000, Loss: 0.15182046592235565, Accuracy: 94.14%, Validation Loss: 0.3827972114086151, Validation Accuracy: 83.02%
I0130 01:33:13.211156 140360185870144 train.py:188] Step 5250, Loss: 0.13863281905651093, Accuracy: 94.53%, Validation Loss: 0.5312223434448242, Validation Accuracy: 81.13%
I0130 01:34:07.064776 140360185870144 train.py:188] Step 5500, Loss: 0.14046341180801392, Accuracy: 94.64%, Validation Loss: 0.3685550093650818, Validation Accuracy: 83.02%
I0130 01:35:01.302152 140360185870144 train.py:188] Step 5750, Loss: 0.14001795649528503, Accuracy: 94.39%, Validation Loss: 0.3531999886035919, Validation Accuracy: 87.74%
I0130 01:35:55.201734 140360185870144 train.py:188] Step 6000, Loss: 0.13656537234783173, Accuracy: 94.70%, Validation Loss: 0.34436625242233276, Validation Accuracy: 83.96%
I0130 01:36:49.560445 140360185870144 train.py:188] Step 6250, Loss: 0.1416793316602707, Accuracy: 94.63%, Validation Loss: 0.19841799139976501, Validation Accuracy: 94.34%
I0130 01:36:49.578673 140360185870144 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/ckpts.
I0130 01:37:43.341518 140360185870144 train.py:188] Step 6500, Loss: 0.12774182856082916, Accuracy: 95.02%, Validation Loss: 0.47675621509552, Validation Accuracy: 82.08%
I0130 01:38:37.623229 140360185870144 train.py:188] Step 6750, Loss: 0.124009869992733, Accuracy: 95.14%, Validation Loss: 0.4140145182609558, Validation Accuracy: 83.02%
I0130 01:39:31.516060 140360185870144 train.py:188] Step 7000, Loss: 0.13322114944458008, Accuracy: 95.13%, Validation Loss: 0.46162134408950806, Validation Accuracy: 79.25%
I0130 01:40:25.771265 140360185870144 train.py:188] Step 7250, Loss: 0.12470914423465729, Accuracy: 95.07%, Validation Loss: 0.26474976539611816, Validation Accuracy: 92.45%
I0130 01:41:19.851308 140360185870144 train.py:188] Step 7500, Loss: 0.13131235539913177, Accuracy: 95.14%, Validation Loss: 1.22401762008667, Validation Accuracy: 75.47%
I0130 01:41:19.868591 140360185870144 train.py:222] Finished training after 7500 steps.
I0130 01:41:19.883635 140360185870144 eval.py:22] 
======== Starting Evaluation ========
I0130 01:41:19.908607 140360185870144 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/ckpts
I0130 01:41:20.226217 140360185870144 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       94.33962264150944
Balanced_Acc:         94.91525423728814
Sensitivity:          89.83050847457628
Specificity:          100.0
F1_Score:             94.64285714285715
Confusion_matrix:   
                   [53  0]
                   [ 6 47]


I0130 01:41:20.603267 140360185870144 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       84.46601941747572
Balanced_Acc:         84.35143288084464
Sensitivity:          72.54901960784314
Specificity:          96.15384615384616
F1_Score:             82.22222222222223
Confusion_matrix:   
                   [37  2]
                   [14 50]


I0130 01:41:20.603706 140360185870144 eval.py:66] ======== Finished Evaluation ========
I0130 01:41:20.604174 140360185870144 visualization.py:90] 
======== Starting DeepVis ========
I0130 01:41:21.676467 140360185870144 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/plot/train/deepvis_IDRiD_001.jpg
I0130 01:41:22.157389 140360185870144 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/plot/test/deepvis_IDRiD_001.jpg
I0130 01:41:22.633678 140360185870144 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/plot/train/deepvis_IDRiD_009.jpg
I0130 01:41:23.115407 140360185870144 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-14-12-741915/plot/test/deepvis_IDRiD_009.jpg
I0130 01:41:23.179265 140360185870144 visualization.py:165] ======== Finished DeepVis ========
Model: "resnet"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
stem (Sequential)               (None, 256, 256, 32) 1024        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 128, 4)  1156        stem[0][0]                       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128, 128, 4)  16          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 128, 128, 4)  16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 4)  132         stem[0][0]                       
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128, 4)  0           batch_normalization_2[0][0]      
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 128, 128, 4)  0           add[0][0]                        
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 4)  148         re_lu[0][0]                      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128, 128, 4)  16          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 128, 4)  16          conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 128, 128, 4)  20          re_lu[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 128, 4)  0           batch_normalization_4[0][0]      
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 128, 128, 4)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 64, 8)    296         re_lu_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64, 64, 8)    32          conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 64, 8)    584         batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 64, 64, 8)    32          conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 64, 8)    40          re_lu_1[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 64, 64, 8)    0           batch_normalization_6[0][0]      
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64, 64, 8)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 64, 64, 8)    584         re_lu_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 64, 64, 8)    32          conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 64, 64, 8)    584         batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 64, 64, 8)    32          conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 64, 64, 8)    72          re_lu_2[0][0]                    
__________________________________________________________________________________________________
add_3 (Add)                     (None, 64, 64, 8)    0           batch_normalization_8[0][0]      
                                                                 conv2d_12[0][0]                  
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64, 64, 8)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 32)   2336        re_lu_3[0][0]                    
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 39)           1287        global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            80          dropout[0][0]                    
==================================================================================================
Total params: 8,831
Trainable params: 8,671
Non-trainable params: 160
__________________________________________________________________________________________________
2022-01-30 01:41:27.090857: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 01:41:27.547411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 01:41:27.950389 139944570513216 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 01:41:29.342003 139944570513216 main.py:117] Running model: resnet
I0130 01:41:29.344200 139944570513216 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256
I0130 01:41:29.344271 139944570513216 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-014129
I0130 01:41:29.354332 139944570513216 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 01:41:29.354386 139944570513216 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts
I0130 01:41:29.354421 139944570513216 train.py:171] 
======== Starting Training ========
2022-01-30 01:41:29.380630: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 01:41:31.190297: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 01:42:28.565681 139944570513216 train.py:188] Step 250, Loss: 0.5663709044456482, Accuracy: 70.65%, Validation Loss: 0.971704363822937, Validation Accuracy: 51.89%
I0130 01:42:28.578467 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:43:22.455753 139944570513216 train.py:188] Step 500, Loss: 0.5028509497642517, Accuracy: 75.66%, Validation Loss: 1.0310945510864258, Validation Accuracy: 54.72%
I0130 01:43:22.482880 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:44:16.783807 139944570513216 train.py:188] Step 750, Loss: 0.478958398103714, Accuracy: 77.61%, Validation Loss: 0.5527266263961792, Validation Accuracy: 73.58%
I0130 01:44:16.808287 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:45:10.737464 139944570513216 train.py:188] Step 1000, Loss: 0.44918957352638245, Accuracy: 79.35%, Validation Loss: 0.4147550165653229, Validation Accuracy: 81.13%
I0130 01:45:10.769843 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:46:05.001971 139944570513216 train.py:188] Step 1250, Loss: 0.42991530895233154, Accuracy: 80.38%, Validation Loss: 0.3432532846927643, Validation Accuracy: 83.96%
I0130 01:46:05.030926 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:46:58.951999 139944570513216 train.py:188] Step 1500, Loss: 0.40610674023628235, Accuracy: 81.44%, Validation Loss: 0.4217899739742279, Validation Accuracy: 78.30%
I0130 01:47:53.268946 139944570513216 train.py:188] Step 1750, Loss: 0.39344528317451477, Accuracy: 82.04%, Validation Loss: 0.2690330445766449, Validation Accuracy: 85.85%
I0130 01:47:53.309182 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:48:47.172055 139944570513216 train.py:188] Step 2000, Loss: 0.37933242321014404, Accuracy: 82.61%, Validation Loss: 0.35436931252479553, Validation Accuracy: 85.85%
I0130 01:49:41.324347 139944570513216 train.py:188] Step 2250, Loss: 0.3631615936756134, Accuracy: 83.75%, Validation Loss: 0.2573973536491394, Validation Accuracy: 90.57%
I0130 01:49:41.346194 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:50:35.303453 139944570513216 train.py:188] Step 2500, Loss: 0.34913837909698486, Accuracy: 84.15%, Validation Loss: 0.317491739988327, Validation Accuracy: 83.96%
I0130 01:51:29.558689 139944570513216 train.py:188] Step 2750, Loss: 0.342357873916626, Accuracy: 84.66%, Validation Loss: 0.2100268006324768, Validation Accuracy: 93.40%
I0130 01:51:29.594988 139944570513216 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts.
I0130 01:52:23.509191 139944570513216 train.py:188] Step 3000, Loss: 0.33218371868133545, Accuracy: 84.90%, Validation Loss: 0.2637036442756653, Validation Accuracy: 87.74%
I0130 01:53:17.714239 139944570513216 train.py:188] Step 3250, Loss: 0.3253288269042969, Accuracy: 85.70%, Validation Loss: 0.6183364391326904, Validation Accuracy: 78.30%
I0130 01:54:11.542236 139944570513216 train.py:188] Step 3500, Loss: 0.3176189064979553, Accuracy: 85.96%, Validation Loss: 0.39723852276802063, Validation Accuracy: 79.25%
I0130 01:55:05.707786 139944570513216 train.py:188] Step 3750, Loss: 0.29579028487205505, Accuracy: 86.87%, Validation Loss: 0.3617320954799652, Validation Accuracy: 83.02%
I0130 01:55:59.600310 139944570513216 train.py:188] Step 4000, Loss: 0.29919731616973877, Accuracy: 87.13%, Validation Loss: 0.58711838722229, Validation Accuracy: 83.96%
I0130 01:56:53.836625 139944570513216 train.py:188] Step 4250, Loss: 0.27880001068115234, Accuracy: 87.86%, Validation Loss: 0.7236917614936829, Validation Accuracy: 78.30%
I0130 01:57:47.754407 139944570513216 train.py:188] Step 4500, Loss: 0.28115224838256836, Accuracy: 88.10%, Validation Loss: 0.34207355976104736, Validation Accuracy: 86.79%
I0130 01:58:41.976178 139944570513216 train.py:188] Step 4750, Loss: 0.26681649684906006, Accuracy: 88.95%, Validation Loss: 0.43121400475502014, Validation Accuracy: 81.13%
I0130 01:59:35.876933 139944570513216 train.py:188] Step 5000, Loss: 0.24724450707435608, Accuracy: 89.70%, Validation Loss: 0.4246004819869995, Validation Accuracy: 77.36%
I0130 02:00:30.024058 139944570513216 train.py:188] Step 5250, Loss: 0.2507391571998596, Accuracy: 89.28%, Validation Loss: 0.7591496706008911, Validation Accuracy: 78.30%
I0130 02:01:23.830870 139944570513216 train.py:188] Step 5500, Loss: 0.24279706180095673, Accuracy: 90.22%, Validation Loss: 0.32046079635620117, Validation Accuracy: 85.85%
I0130 02:02:18.001332 139944570513216 train.py:188] Step 5750, Loss: 0.23144935071468353, Accuracy: 90.47%, Validation Loss: 0.21039070188999176, Validation Accuracy: 89.62%
I0130 02:03:11.783015 139944570513216 train.py:188] Step 6000, Loss: 0.2158811241388321, Accuracy: 90.85%, Validation Loss: 0.18983976542949677, Validation Accuracy: 93.40%
I0130 02:04:06.307209 139944570513216 train.py:188] Step 6250, Loss: 0.2236645221710205, Accuracy: 90.77%, Validation Loss: 0.26106977462768555, Validation Accuracy: 88.68%
I0130 02:05:00.255109 139944570513216 train.py:188] Step 6500, Loss: 0.21056129038333893, Accuracy: 91.45%, Validation Loss: 0.24252934753894806, Validation Accuracy: 87.74%
I0130 02:05:54.584847 139944570513216 train.py:188] Step 6750, Loss: 0.1978464424610138, Accuracy: 91.91%, Validation Loss: 0.30739834904670715, Validation Accuracy: 85.85%
I0130 02:06:48.346024 139944570513216 train.py:188] Step 7000, Loss: 0.20282748341560364, Accuracy: 92.09%, Validation Loss: 0.7135685682296753, Validation Accuracy: 79.25%
I0130 02:07:42.676741 139944570513216 train.py:188] Step 7250, Loss: 0.20314304530620575, Accuracy: 92.07%, Validation Loss: 0.27920830249786377, Validation Accuracy: 90.57%
I0130 02:08:36.518909 139944570513216 train.py:188] Step 7500, Loss: 0.18450327217578888, Accuracy: 92.57%, Validation Loss: 0.43089473247528076, Validation Accuracy: 83.02%
I0130 02:08:36.537820 139944570513216 train.py:222] Finished training after 7500 steps.
I0130 02:08:36.560876 139944570513216 eval.py:22] 
======== Starting Evaluation ========
I0130 02:08:36.586415 139944570513216 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/ckpts
I0130 02:08:36.904198 139944570513216 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       93.39622641509435
Balanced_Acc:         93.78591954022988
Sensitivity:          97.91666666666666
Specificity:          89.65517241379311
F1_Score:             93.06930693069307
Confusion_matrix:   
                   [47  6]
                   [ 1 52]


I0130 02:08:37.282229 139944570513216 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       73.7864077669903
Balanced_Acc:         72.30679156908666
Sensitivity:          64.28571428571429
Specificity:          80.32786885245902
F1_Score:             66.66666666666666
Confusion_matrix:   
                   [27 12]
                   [15 49]


I0130 02:08:37.282518 139944570513216 eval.py:66] ======== Finished Evaluation ========
I0130 02:08:37.282841 139944570513216 visualization.py:90] 
======== Starting DeepVis ========
I0130 02:08:38.351406 139944570513216 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/plot/train/deepvis_IDRiD_001.jpg
I0130 02:08:38.832854 139944570513216 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/plot/test/deepvis_IDRiD_001.jpg
I0130 02:08:39.308822 139944570513216 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/plot/train/deepvis_IDRiD_009.jpg
I0130 02:08:39.792399 139944570513216 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T01-41-27-944256/plot/test/deepvis_IDRiD_009.jpg
I0130 02:08:39.855132 139944570513216 visualization.py:165] ======== Finished DeepVis ========
Model: "resnet"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
stem (Sequential)               (None, 256, 256, 32) 1024        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 128, 4)  1156        stem[0][0]                       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128, 128, 4)  16          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 128, 128, 4)  16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 4)  132         stem[0][0]                       
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128, 4)  0           batch_normalization_2[0][0]      
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 128, 128, 4)  0           add[0][0]                        
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 4)  148         re_lu[0][0]                      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128, 128, 4)  16          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 128, 4)  16          conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 128, 128, 4)  20          re_lu[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 128, 4)  0           batch_normalization_4[0][0]      
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 128, 128, 4)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 64, 8)    296         re_lu_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64, 64, 8)    32          conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 64, 8)    584         batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 64, 64, 8)    32          conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 64, 8)    40          re_lu_1[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 64, 64, 8)    0           batch_normalization_6[0][0]      
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64, 64, 8)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 64, 64, 8)    584         re_lu_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 64, 64, 8)    32          conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 64, 64, 8)    584         batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 64, 64, 8)    32          conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 64, 64, 8)    72          re_lu_2[0][0]                    
__________________________________________________________________________________________________
add_3 (Add)                     (None, 64, 64, 8)    0           batch_normalization_8[0][0]      
                                                                 conv2d_12[0][0]                  
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64, 64, 8)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 32)   2336        re_lu_3[0][0]                    
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 39)           1287        global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            80          dropout[0][0]                    
==================================================================================================
Total params: 8,831
Trainable params: 8,671
Non-trainable params: 160
__________________________________________________________________________________________________
2022-01-30 02:08:43.790454: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 02:08:44.251909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 02:08:44.649258 140148617017152 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 02:08:46.042267 140148617017152 main.py:117] Running model: resnet
I0130 02:08:46.044488 140148617017152 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047
I0130 02:08:46.044563 140148617017152 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-020846
I0130 02:08:46.054577 140148617017152 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 02:08:46.054630 140148617017152 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts
I0130 02:08:46.054664 140148617017152 train.py:171] 
======== Starting Training ========
2022-01-30 02:08:46.081331: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 02:08:47.883956: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 02:09:45.355206 140148617017152 train.py:188] Step 250, Loss: 0.5735751986503601, Accuracy: 69.66%, Validation Loss: 0.7030125856399536, Validation Accuracy: 51.89%
I0130 02:09:45.372843 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:10:39.386305 140148617017152 train.py:188] Step 500, Loss: 0.5089318752288818, Accuracy: 74.76%, Validation Loss: 0.7612209916114807, Validation Accuracy: 57.55%
I0130 02:10:39.409410 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:11:33.743911 140148617017152 train.py:188] Step 750, Loss: 0.4193000793457031, Accuracy: 80.50%, Validation Loss: 0.5724947452545166, Validation Accuracy: 73.58%
I0130 02:11:33.781699 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:12:27.919343 140148617017152 train.py:188] Step 1000, Loss: 0.3607027232646942, Accuracy: 83.97%, Validation Loss: 1.0051367282867432, Validation Accuracy: 58.49%
I0130 02:13:22.076131 140148617017152 train.py:188] Step 1250, Loss: 0.3213965892791748, Accuracy: 85.94%, Validation Loss: 0.5180929899215698, Validation Accuracy: 77.36%
I0130 02:13:22.096238 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:14:16.128756 140148617017152 train.py:188] Step 1500, Loss: 0.2868584990501404, Accuracy: 87.89%, Validation Loss: 0.40381309390068054, Validation Accuracy: 81.13%
I0130 02:14:16.159500 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:15:10.474407 140148617017152 train.py:188] Step 1750, Loss: 0.2795238196849823, Accuracy: 88.10%, Validation Loss: 0.4125826060771942, Validation Accuracy: 83.96%
I0130 02:15:10.518940 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:16:04.737563 140148617017152 train.py:188] Step 2000, Loss: 0.2697290778160095, Accuracy: 88.51%, Validation Loss: 0.42041483521461487, Validation Accuracy: 76.42%
I0130 02:16:59.808888 140148617017152 train.py:188] Step 2250, Loss: 0.25283634662628174, Accuracy: 89.40%, Validation Loss: 0.32644981145858765, Validation Accuracy: 80.19%
I0130 02:17:56.447002 140148617017152 train.py:188] Step 2500, Loss: 0.24227666854858398, Accuracy: 90.08%, Validation Loss: 0.3565126359462738, Validation Accuracy: 81.13%
I0130 02:18:53.720328 140148617017152 train.py:188] Step 2750, Loss: 0.23067863285541534, Accuracy: 90.48%, Validation Loss: 0.6812924742698669, Validation Accuracy: 74.53%
I0130 02:19:50.595224 140148617017152 train.py:188] Step 3000, Loss: 0.2099144458770752, Accuracy: 91.70%, Validation Loss: 0.2552730143070221, Validation Accuracy: 87.74%
I0130 02:19:50.619091 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:20:47.841167 140148617017152 train.py:188] Step 3250, Loss: 0.19858133792877197, Accuracy: 92.13%, Validation Loss: 0.42805638909339905, Validation Accuracy: 74.53%
I0130 02:21:44.535857 140148617017152 train.py:188] Step 3500, Loss: 0.19553221762180328, Accuracy: 92.30%, Validation Loss: 0.3013731837272644, Validation Accuracy: 86.79%
I0130 02:22:41.649878 140148617017152 train.py:188] Step 3750, Loss: 0.183746337890625, Accuracy: 92.82%, Validation Loss: 0.8251265287399292, Validation Accuracy: 78.30%
I0130 02:23:38.266212 140148617017152 train.py:188] Step 4000, Loss: 0.18342842161655426, Accuracy: 92.96%, Validation Loss: 0.3042961657047272, Validation Accuracy: 92.45%
I0130 02:23:38.299557 140148617017152 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts.
I0130 02:24:35.325537 140148617017152 train.py:188] Step 4250, Loss: 0.16919384896755219, Accuracy: 93.45%, Validation Loss: 0.4834326505661011, Validation Accuracy: 85.85%
I0130 02:25:31.856184 140148617017152 train.py:188] Step 4500, Loss: 0.17215599119663239, Accuracy: 93.33%, Validation Loss: 0.47129717469215393, Validation Accuracy: 82.08%
I0130 02:26:28.879447 140148617017152 train.py:188] Step 4750, Loss: 0.1598663032054901, Accuracy: 93.98%, Validation Loss: 0.3505662977695465, Validation Accuracy: 89.62%
I0130 02:27:25.195995 140148617017152 train.py:188] Step 5000, Loss: 0.1528879553079605, Accuracy: 93.89%, Validation Loss: 0.34723353385925293, Validation Accuracy: 83.02%
I0130 02:28:22.318945 140148617017152 train.py:188] Step 5250, Loss: 0.1511233150959015, Accuracy: 94.42%, Validation Loss: 0.43909943103790283, Validation Accuracy: 90.57%
I0130 02:29:18.925538 140148617017152 train.py:188] Step 5500, Loss: 0.13655705749988556, Accuracy: 94.60%, Validation Loss: 0.4979865550994873, Validation Accuracy: 83.96%
I0130 02:30:16.156452 140148617017152 train.py:188] Step 5750, Loss: 0.13471534848213196, Accuracy: 94.71%, Validation Loss: 0.4752940833568573, Validation Accuracy: 77.36%
I0130 02:31:12.905673 140148617017152 train.py:188] Step 6000, Loss: 0.141465961933136, Accuracy: 94.57%, Validation Loss: 0.6222440004348755, Validation Accuracy: 79.25%
I0130 02:32:10.030463 140148617017152 train.py:188] Step 6250, Loss: 0.1250687837600708, Accuracy: 95.25%, Validation Loss: 0.44874468445777893, Validation Accuracy: 86.79%
I0130 02:33:06.784041 140148617017152 train.py:188] Step 6500, Loss: 0.13310043513774872, Accuracy: 94.97%, Validation Loss: 0.5211045742034912, Validation Accuracy: 79.25%
I0130 02:34:03.967245 140148617017152 train.py:188] Step 6750, Loss: 0.1356893628835678, Accuracy: 94.76%, Validation Loss: 0.3736611008644104, Validation Accuracy: 90.57%
I0130 02:35:00.632927 140148617017152 train.py:188] Step 7000, Loss: 0.11947135627269745, Accuracy: 95.29%, Validation Loss: 0.4353506565093994, Validation Accuracy: 85.85%
I0130 02:35:57.978767 140148617017152 train.py:188] Step 7250, Loss: 0.12072969973087311, Accuracy: 95.46%, Validation Loss: 0.8993996381759644, Validation Accuracy: 76.42%
I0130 02:36:54.646362 140148617017152 train.py:188] Step 7500, Loss: 0.12677475810050964, Accuracy: 95.27%, Validation Loss: 0.26990699768066406, Validation Accuracy: 84.91%
I0130 02:36:54.669275 140148617017152 train.py:222] Finished training after 7500 steps.
I0130 02:36:54.701583 140148617017152 eval.py:22] 
======== Starting Evaluation ========
I0130 02:36:54.724560 140148617017152 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/ckpts
I0130 02:36:55.046755 140148617017152 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         92.45283018867924
Sensitivity:          92.45283018867924
Specificity:          92.45283018867924
F1_Score:             92.45283018867924
Confusion_matrix:   
                   [49  4]
                   [ 4 49]


I0130 02:36:55.427511 140148617017152 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       78.64077669902912
Balanced_Acc:         77.5478927203065
Sensitivity:          68.88888888888889
Specificity:          86.20689655172413
F1_Score:             73.8095238095238
Confusion_matrix:   
                   [31  8]
                   [14 50]


I0130 02:36:55.427996 140148617017152 eval.py:66] ======== Finished Evaluation ========
I0130 02:36:55.428523 140148617017152 visualization.py:90] 
======== Starting DeepVis ========
I0130 02:36:56.522347 140148617017152 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/plot/train/deepvis_IDRiD_001.jpg
I0130 02:36:57.026557 140148617017152 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/plot/test/deepvis_IDRiD_001.jpg
I0130 02:36:57.541541 140148617017152 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/plot/train/deepvis_IDRiD_009.jpg
I0130 02:36:58.037454 140148617017152 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-08-44-643047/plot/test/deepvis_IDRiD_009.jpg
I0130 02:36:58.097949 140148617017152 visualization.py:165] ======== Finished DeepVis ========
Model: "resnet"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
stem (Sequential)               (None, 256, 256, 32) 1024        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 128, 4)  1156        stem[0][0]                       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128, 128, 4)  16          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 128, 128, 4)  16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 4)  132         stem[0][0]                       
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128, 4)  0           batch_normalization_2[0][0]      
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 128, 128, 4)  0           add[0][0]                        
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 4)  148         re_lu[0][0]                      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128, 128, 4)  16          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 128, 4)  148         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 128, 4)  16          conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 128, 128, 4)  20          re_lu[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 128, 4)  0           batch_normalization_4[0][0]      
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 128, 128, 4)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 64, 8)    296         re_lu_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64, 64, 8)    32          conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 64, 8)    584         batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 64, 64, 8)    32          conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 64, 8)    40          re_lu_1[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 64, 64, 8)    0           batch_normalization_6[0][0]      
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64, 64, 8)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 64, 64, 8)    584         re_lu_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 64, 64, 8)    32          conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 64, 64, 8)    584         batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 64, 64, 8)    32          conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 64, 64, 8)    72          re_lu_2[0][0]                    
__________________________________________________________________________________________________
add_3 (Add)                     (None, 64, 64, 8)    0           batch_normalization_8[0][0]      
                                                                 conv2d_12[0][0]                  
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64, 64, 8)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 32)   2336        re_lu_3[0][0]                    
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 39)           1287        global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            80          dropout[0][0]                    
==================================================================================================
Total params: 8,831
Trainable params: 8,671
Non-trainable params: 160
__________________________________________________________________________________________________
2022-01-30 02:37:02.746795: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 02:37:03.283899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 02:37:03.771159 139983860717376 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 02:37:05.243627 139983860717376 main.py:117] Running model: vgg
I0130 02:37:05.244765 139983860717376 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809
I0130 02:37:05.244842 139983860717376 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-023705
I0130 02:37:05.255916 139983860717376 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 02:37:05.255975 139983860717376 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts
I0130 02:37:05.256010 139983860717376 train.py:171] 
======== Starting Training ========
2022-01-30 02:37:05.284124: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 02:37:07.043972: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 02:38:03.570270 139983860717376 train.py:188] Step 250, Loss: 0.6462526917457581, Accuracy: 63.30%, Validation Loss: 0.5868739485740662, Validation Accuracy: 75.47%
I0130 02:38:03.590543 139983860717376 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts.
I0130 02:38:53.139083 139983860717376 train.py:188] Step 500, Loss: 0.5659555196762085, Accuracy: 72.79%, Validation Loss: 0.5480755567550659, Validation Accuracy: 70.75%
I0130 02:39:43.405460 139983860717376 train.py:188] Step 750, Loss: 0.397960901260376, Accuracy: 82.26%, Validation Loss: 0.32645756006240845, Validation Accuracy: 83.96%
I0130 02:39:43.437067 139983860717376 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts.
I0130 02:40:33.193010 139983860717376 train.py:188] Step 1000, Loss: 0.27037376165390015, Accuracy: 88.71%, Validation Loss: 0.3219643831253052, Validation Accuracy: 85.85%
I0130 02:40:33.221944 139983860717376 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts.
I0130 02:41:23.096379 139983860717376 train.py:188] Step 1250, Loss: 0.23102250695228577, Accuracy: 90.24%, Validation Loss: 0.5932349562644958, Validation Accuracy: 85.85%
I0130 02:42:12.808643 139983860717376 train.py:188] Step 1500, Loss: 0.19693523645401, Accuracy: 92.05%, Validation Loss: 0.9310317635536194, Validation Accuracy: 75.47%
I0130 02:43:02.902808 139983860717376 train.py:188] Step 1750, Loss: 0.1505357176065445, Accuracy: 94.14%, Validation Loss: 0.9322974681854248, Validation Accuracy: 78.30%
I0130 02:43:52.377918 139983860717376 train.py:188] Step 2000, Loss: 0.11139968782663345, Accuracy: 95.74%, Validation Loss: 1.1803183555603027, Validation Accuracy: 76.42%
I0130 02:44:42.452147 139983860717376 train.py:188] Step 2250, Loss: 0.1421210765838623, Accuracy: 94.58%, Validation Loss: 1.3826749324798584, Validation Accuracy: 81.13%
I0130 02:45:32.022018 139983860717376 train.py:188] Step 2500, Loss: 0.10491722077131271, Accuracy: 96.05%, Validation Loss: 0.8819586038589478, Validation Accuracy: 79.25%
I0130 02:46:22.122288 139983860717376 train.py:188] Step 2750, Loss: 0.09961400926113129, Accuracy: 96.36%, Validation Loss: 0.8384174704551697, Validation Accuracy: 82.08%
I0130 02:47:11.639102 139983860717376 train.py:188] Step 3000, Loss: 0.08763555437326431, Accuracy: 96.65%, Validation Loss: 1.2969563007354736, Validation Accuracy: 80.19%
I0130 02:48:01.670760 139983860717376 train.py:188] Step 3250, Loss: 0.07761097699403763, Accuracy: 97.24%, Validation Loss: 1.2877743244171143, Validation Accuracy: 74.53%
I0130 02:48:51.183799 139983860717376 train.py:188] Step 3500, Loss: 0.06013952195644379, Accuracy: 97.86%, Validation Loss: 1.2285889387130737, Validation Accuracy: 82.08%
I0130 02:49:41.113742 139983860717376 train.py:188] Step 3750, Loss: 0.05775423347949982, Accuracy: 98.00%, Validation Loss: 1.30086088180542, Validation Accuracy: 86.79%
I0130 02:49:41.146171 139983860717376 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts.
I0130 02:50:30.838162 139983860717376 train.py:188] Step 4000, Loss: 0.049322083592414856, Accuracy: 98.15%, Validation Loss: 1.492781400680542, Validation Accuracy: 79.25%
I0130 02:51:20.851542 139983860717376 train.py:188] Step 4250, Loss: 0.04728170484304428, Accuracy: 98.29%, Validation Loss: 1.8101346492767334, Validation Accuracy: 83.96%
I0130 02:52:10.330232 139983860717376 train.py:188] Step 4500, Loss: 0.057148952037096024, Accuracy: 97.84%, Validation Loss: 1.6290611028671265, Validation Accuracy: 82.08%
I0130 02:53:00.372353 139983860717376 train.py:188] Step 4750, Loss: 0.05065904185175896, Accuracy: 98.12%, Validation Loss: 1.5488401651382446, Validation Accuracy: 85.85%
I0130 02:53:49.983741 139983860717376 train.py:188] Step 5000, Loss: 0.03668921813368797, Accuracy: 98.70%, Validation Loss: 1.0036702156066895, Validation Accuracy: 85.85%
I0130 02:54:39.998208 139983860717376 train.py:188] Step 5250, Loss: 0.05401293560862541, Accuracy: 97.98%, Validation Loss: 2.21639347076416, Validation Accuracy: 83.02%
I0130 02:55:29.641814 139983860717376 train.py:188] Step 5500, Loss: 0.05509931221604347, Accuracy: 97.96%, Validation Loss: 0.9246993660926819, Validation Accuracy: 85.85%
I0130 02:56:17.728949 139983860717376 train.py:188] Step 5750, Loss: 0.03225118666887283, Accuracy: 98.86%, Validation Loss: 2.172136068344116, Validation Accuracy: 83.96%
I0130 02:57:06.367070 139983860717376 train.py:188] Step 6000, Loss: 0.04152681306004524, Accuracy: 98.45%, Validation Loss: 1.0391294956207275, Validation Accuracy: 84.91%
I0130 02:57:56.180252 139983860717376 train.py:188] Step 6250, Loss: 0.038963545113801956, Accuracy: 98.64%, Validation Loss: 1.1244258880615234, Validation Accuracy: 84.91%
I0130 02:58:45.800018 139983860717376 train.py:188] Step 6500, Loss: 0.04093106836080551, Accuracy: 98.63%, Validation Loss: 1.906334638595581, Validation Accuracy: 81.13%
I0130 02:59:35.760151 139983860717376 train.py:188] Step 6750, Loss: 0.046422019600868225, Accuracy: 98.50%, Validation Loss: 1.0505132675170898, Validation Accuracy: 86.79%
I0130 03:00:25.439672 139983860717376 train.py:188] Step 7000, Loss: 0.03339178487658501, Accuracy: 98.91%, Validation Loss: 1.3575453758239746, Validation Accuracy: 82.08%
I0130 03:01:15.610996 139983860717376 train.py:188] Step 7250, Loss: 0.02967081405222416, Accuracy: 99.01%, Validation Loss: 2.0301835536956787, Validation Accuracy: 79.25%
I0130 03:02:05.207900 139983860717376 train.py:188] Step 7500, Loss: 0.02179623581469059, Accuracy: 99.17%, Validation Loss: 2.2752342224121094, Validation Accuracy: 82.08%
I0130 03:02:05.241067 139983860717376 train.py:222] Finished training after 7500 steps.
I0130 03:02:05.282640 139983860717376 eval.py:22] 
======== Starting Evaluation ========
I0130 03:02:05.299473 139983860717376 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/ckpts
I0130 03:02:06.316613 139983860717376 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       86.79245283018868
Balanced_Acc:         87.27010457987738
Sensitivity:          91.48936170212765
Specificity:          83.05084745762711
F1_Score:             86.00000000000001
Confusion_matrix:   
                   [43 10]
                   [ 4 49]


I0130 03:02:07.316453 139983860717376 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       82.52427184466019
Balanced_Acc:         81.37596899224806
Sensitivity:          74.4186046511628
Specificity:          88.33333333333333
F1_Score:             78.04878048780488
Confusion_matrix:   
                   [32  7]
                   [11 53]


I0130 03:02:07.316918 139983860717376 eval.py:66] ======== Finished Evaluation ========
I0130 03:02:07.317440 139983860717376 visualization.py:90] 
======== Starting DeepVis ========
I0130 03:02:09.409799 139983860717376 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/plot/train/deepvis_IDRiD_001.jpg
I0130 03:02:09.903732 139983860717376 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/plot/test/deepvis_IDRiD_001.jpg
I0130 03:02:10.387199 139983860717376 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/plot/train/deepvis_IDRiD_009.jpg
I0130 03:02:10.887038 139983860717376 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T02-37-03-764809/plot/test/deepvis_IDRiD_009.jpg
I0130 03:02:10.948685 139983860717376 visualization.py:165] ======== Finished DeepVis ========
Model: "vgg_like"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 256, 256, 16)      448       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 256, 16)      2320      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      4640      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 32)      9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 64)        18496     
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 64, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 128)       73856     
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 128)       147584    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 256)       590080    
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130       
=================================================================
Total params: 1,195,346
Trainable params: 1,195,346
Non-trainable params: 0
_________________________________________________________________
2022-01-30 03:02:15.641826: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 03:02:16.155540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 03:02:16.650551 139943199860544 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 03:02:18.087908 139943199860544 main.py:117] Running model: vgg
I0130 03:02:18.089051 139943199860544 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024
I0130 03:02:18.089128 139943199860544 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-030218
I0130 03:02:18.100183 139943199860544 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 03:02:18.100237 139943199860544 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/ckpts
I0130 03:02:18.100270 139943199860544 train.py:171] 
======== Starting Training ========
2022-01-30 03:02:18.127039: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 03:02:19.887249: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 03:03:16.421259 139943199860544 train.py:188] Step 250, Loss: 0.6930587291717529, Accuracy: 50.00%, Validation Loss: 0.6932502388954163, Validation Accuracy: 50.00%
I0130 03:03:16.437126 139943199860544 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/ckpts.
I0130 03:04:05.767513 139943199860544 train.py:188] Step 500, Loss: 0.693152904510498, Accuracy: 49.95%, Validation Loss: 0.693305492401123, Validation Accuracy: 50.00%
I0130 03:04:55.571325 139943199860544 train.py:188] Step 750, Loss: 0.6930215954780579, Accuracy: 50.42%, Validation Loss: 0.6932081580162048, Validation Accuracy: 50.00%
I0130 03:05:45.030449 139943199860544 train.py:188] Step 1000, Loss: 0.6930571794509888, Accuracy: 50.71%, Validation Loss: 0.6931922435760498, Validation Accuracy: 50.00%
I0130 03:06:34.885607 139943199860544 train.py:188] Step 1250, Loss: 0.6931329965591431, Accuracy: 49.83%, Validation Loss: 0.6933608055114746, Validation Accuracy: 50.00%
I0130 03:07:24.253080 139943199860544 train.py:188] Step 1500, Loss: 0.6932312250137329, Accuracy: 49.88%, Validation Loss: 0.6931531429290771, Validation Accuracy: 50.00%
I0130 03:08:13.827746 139943199860544 train.py:188] Step 1750, Loss: 0.6931880712509155, Accuracy: 49.72%, Validation Loss: 0.6931509375572205, Validation Accuracy: 50.00%
I0130 03:09:03.164361 139943199860544 train.py:188] Step 2000, Loss: 0.6931413412094116, Accuracy: 49.84%, Validation Loss: 0.6932508945465088, Validation Accuracy: 50.00%
I0130 03:09:53.037375 139943199860544 train.py:188] Step 2250, Loss: 0.6931122541427612, Accuracy: 49.95%, Validation Loss: 0.6932247877120972, Validation Accuracy: 50.00%
I0130 03:10:42.433352 139943199860544 train.py:188] Step 2500, Loss: 0.6931608319282532, Accuracy: 50.05%, Validation Loss: 0.6931796073913574, Validation Accuracy: 50.00%
I0130 03:11:32.345096 139943199860544 train.py:188] Step 2750, Loss: 0.6931276917457581, Accuracy: 49.98%, Validation Loss: 0.6932108402252197, Validation Accuracy: 50.00%
I0130 03:12:21.856079 139943199860544 train.py:188] Step 3000, Loss: 0.6930921673774719, Accuracy: 50.04%, Validation Loss: 0.6932145357131958, Validation Accuracy: 50.00%
I0130 03:13:11.590528 139943199860544 train.py:188] Step 3250, Loss: 0.6930469274520874, Accuracy: 49.96%, Validation Loss: 0.6932927966117859, Validation Accuracy: 50.00%
I0130 03:14:00.970265 139943199860544 train.py:188] Step 3500, Loss: 0.6930142641067505, Accuracy: 50.04%, Validation Loss: 0.6933093070983887, Validation Accuracy: 50.00%
I0130 03:14:50.714523 139943199860544 train.py:188] Step 3750, Loss: 0.6931944489479065, Accuracy: 49.98%, Validation Loss: 0.6931546330451965, Validation Accuracy: 50.00%
I0130 03:15:39.998075 139943199860544 train.py:188] Step 4000, Loss: 0.693082332611084, Accuracy: 50.02%, Validation Loss: 0.693261981010437, Validation Accuracy: 50.00%
I0130 03:16:29.637634 139943199860544 train.py:188] Step 4250, Loss: 0.693041205406189, Accuracy: 49.98%, Validation Loss: 0.6932241916656494, Validation Accuracy: 50.00%
I0130 03:17:18.831458 139943199860544 train.py:188] Step 4500, Loss: 0.6931354403495789, Accuracy: 50.02%, Validation Loss: 0.6931838989257812, Validation Accuracy: 50.00%
I0130 03:18:08.520787 139943199860544 train.py:188] Step 4750, Loss: 0.6931793689727783, Accuracy: 49.98%, Validation Loss: 0.6931876540184021, Validation Accuracy: 50.00%
I0130 03:18:57.848093 139943199860544 train.py:188] Step 5000, Loss: 0.6931352615356445, Accuracy: 50.02%, Validation Loss: 0.6931851506233215, Validation Accuracy: 50.00%
I0130 03:19:47.497773 139943199860544 train.py:188] Step 5250, Loss: 0.692984938621521, Accuracy: 49.99%, Validation Loss: 0.6932976245880127, Validation Accuracy: 50.00%
I0130 03:20:36.700385 139943199860544 train.py:188] Step 5500, Loss: 0.6930205225944519, Accuracy: 50.01%, Validation Loss: 0.6932834982872009, Validation Accuracy: 50.00%
I0130 03:21:26.325390 139943199860544 train.py:188] Step 5750, Loss: 0.6931729912757874, Accuracy: 49.99%, Validation Loss: 0.6931644678115845, Validation Accuracy: 50.00%
I0130 03:22:15.634834 139943199860544 train.py:188] Step 6000, Loss: 0.6931436657905579, Accuracy: 50.01%, Validation Loss: 0.6931527256965637, Validation Accuracy: 50.00%
I0130 03:23:05.655316 139943199860544 train.py:188] Step 6250, Loss: 0.6930990815162659, Accuracy: 49.97%, Validation Loss: 0.6931842565536499, Validation Accuracy: 50.00%
I0130 03:23:55.107792 139943199860544 train.py:188] Step 6500, Loss: 0.6931189894676208, Accuracy: 50.03%, Validation Loss: 0.6931580305099487, Validation Accuracy: 50.00%
I0130 03:24:44.923520 139943199860544 train.py:188] Step 6750, Loss: 0.6931280493736267, Accuracy: 50.03%, Validation Loss: 0.6931707262992859, Validation Accuracy: 50.00%
I0130 03:25:34.226447 139943199860544 train.py:188] Step 7000, Loss: 0.6931225061416626, Accuracy: 50.02%, Validation Loss: 0.6931807398796082, Validation Accuracy: 50.00%
I0130 03:26:24.025852 139943199860544 train.py:188] Step 7250, Loss: 0.6931137442588806, Accuracy: 49.99%, Validation Loss: 0.6931917667388916, Validation Accuracy: 50.00%
I0130 03:27:13.261966 139943199860544 train.py:188] Step 7500, Loss: 0.69306880235672, Accuracy: 50.01%, Validation Loss: 0.6932512521743774, Validation Accuracy: 50.00%
I0130 03:27:13.285376 139943199860544 train.py:222] Finished training after 7500 steps.
I0130 03:27:13.322067 139943199860544 eval.py:22] 
======== Starting Evaluation ========
I0130 03:27:13.336885 139943199860544 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/ckpts
I0130 03:27:14.360803 139943199860544 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       50.0
Balanced_Acc:         nan
Sensitivity:          nan
Specificity:          50.0
F1_Score:             nan
Confusion_matrix:   
                   [ 0 53]
                   [ 0 53]


I0130 03:27:15.346626 139943199860544 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       62.13592233009708
Balanced_Acc:         nan
Sensitivity:          nan
Specificity:          62.13592233009708
F1_Score:             nan
Confusion_matrix:   
                   [ 0 39]
                   [ 0 64]


I0130 03:27:15.346964 139943199860544 eval.py:66] ======== Finished Evaluation ========
I0130 03:27:15.347322 139943199860544 visualization.py:90] 
======== Starting DeepVis ========
I0130 03:27:17.424404 139943199860544 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/plot/train/deepvis_IDRiD_001.jpg
I0130 03:27:17.915634 139943199860544 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/plot/test/deepvis_IDRiD_001.jpg
I0130 03:27:18.398156 139943199860544 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/plot/train/deepvis_IDRiD_009.jpg
I0130 03:27:18.869510 139943199860544 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-02-16-644024/plot/test/deepvis_IDRiD_009.jpg
I0130 03:27:18.932728 139943199860544 visualization.py:165] ======== Finished DeepVis ========
Model: "vgg_like"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 256, 256, 16)      448       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 256, 16)      2320      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      4640      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 32)      9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 64)        18496     
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 64, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 128)       73856     
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 128)       147584    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 256)       590080    
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130       
=================================================================
Total params: 1,195,346
Trainable params: 1,195,346
Non-trainable params: 0
_________________________________________________________________
2022-01-30 03:27:23.658821: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 03:27:24.195085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 03:27:24.695838 140119860389696 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 03:27:26.162769 140119860389696 main.py:117] Running model: vgg
I0130 03:27:26.163908 140119860389696 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440
I0130 03:27:26.163978 140119860389696 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-032726
I0130 03:27:26.175277 140119860389696 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 03:27:26.175345 140119860389696 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts
I0130 03:27:26.175379 140119860389696 train.py:171] 
======== Starting Training ========
2022-01-30 03:27:26.203026: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 03:27:27.962756: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 03:28:24.648616 140119860389696 train.py:188] Step 250, Loss: 0.6529967188835144, Accuracy: 61.25%, Validation Loss: 0.6426005959510803, Validation Accuracy: 70.75%
I0130 03:28:24.666846 140119860389696 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts.
I0130 03:29:14.281238 140119860389696 train.py:188] Step 500, Loss: 0.5859240293502808, Accuracy: 71.02%, Validation Loss: 0.5727269649505615, Validation Accuracy: 73.58%
I0130 03:29:14.309390 140119860389696 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts.
I0130 03:30:04.326637 140119860389696 train.py:188] Step 750, Loss: 0.4860943555831909, Accuracy: 75.83%, Validation Loss: 0.462523490190506, Validation Accuracy: 79.25%
I0130 03:30:04.349056 140119860389696 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts.
I0130 03:30:53.842057 140119860389696 train.py:188] Step 1000, Loss: 0.33670976758003235, Accuracy: 84.75%, Validation Loss: 0.3445890247821808, Validation Accuracy: 82.08%
I0130 03:30:53.865861 140119860389696 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts.
I0130 03:31:43.840065 140119860389696 train.py:188] Step 1250, Loss: 0.2579308748245239, Accuracy: 89.79%, Validation Loss: 0.5096806883811951, Validation Accuracy: 82.08%
I0130 03:32:33.696648 140119860389696 train.py:188] Step 1500, Loss: 0.19911928474903107, Accuracy: 92.32%, Validation Loss: 0.49866655468940735, Validation Accuracy: 82.08%
I0130 03:33:23.923454 140119860389696 train.py:188] Step 1750, Loss: 0.15258270502090454, Accuracy: 94.16%, Validation Loss: 0.45484164357185364, Validation Accuracy: 86.79%
I0130 03:33:23.941928 140119860389696 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts.
I0130 03:34:13.864613 140119860389696 train.py:188] Step 2000, Loss: 0.1360996514558792, Accuracy: 94.96%, Validation Loss: 1.2370103597640991, Validation Accuracy: 79.25%
I0130 03:35:03.937673 140119860389696 train.py:188] Step 2250, Loss: 0.09382394701242447, Accuracy: 96.41%, Validation Loss: 0.7458603978157043, Validation Accuracy: 83.96%
I0130 03:35:53.734217 140119860389696 train.py:188] Step 2500, Loss: 0.1085672378540039, Accuracy: 96.05%, Validation Loss: 1.3776334524154663, Validation Accuracy: 82.08%
I0130 03:36:44.020650 140119860389696 train.py:188] Step 2750, Loss: 0.08538900315761566, Accuracy: 96.76%, Validation Loss: 1.5569666624069214, Validation Accuracy: 79.25%
I0130 03:37:33.701141 140119860389696 train.py:188] Step 3000, Loss: 0.0698065236210823, Accuracy: 97.49%, Validation Loss: 1.74871826171875, Validation Accuracy: 79.25%
I0130 03:38:23.711950 140119860389696 train.py:188] Step 3250, Loss: 0.055330634117126465, Accuracy: 97.90%, Validation Loss: 2.441946029663086, Validation Accuracy: 74.53%
I0130 03:39:13.368731 140119860389696 train.py:188] Step 3500, Loss: 0.052678849548101425, Accuracy: 98.23%, Validation Loss: 1.3031997680664062, Validation Accuracy: 82.08%
I0130 03:40:03.261335 140119860389696 train.py:188] Step 3750, Loss: 0.07779140770435333, Accuracy: 97.26%, Validation Loss: 1.7813364267349243, Validation Accuracy: 81.13%
I0130 03:40:52.906775 140119860389696 train.py:188] Step 4000, Loss: 0.04624225199222565, Accuracy: 98.37%, Validation Loss: 1.655005693435669, Validation Accuracy: 80.19%
I0130 03:41:43.035280 140119860389696 train.py:188] Step 4250, Loss: 0.04791739210486412, Accuracy: 98.34%, Validation Loss: 2.6277143955230713, Validation Accuracy: 78.30%
I0130 03:42:32.844027 140119860389696 train.py:188] Step 4500, Loss: 0.14872875809669495, Accuracy: 94.37%, Validation Loss: 0.9597607851028442, Validation Accuracy: 84.91%
I0130 03:43:23.095774 140119860389696 train.py:188] Step 4750, Loss: 0.0636826902627945, Accuracy: 97.61%, Validation Loss: 1.1285678148269653, Validation Accuracy: 82.08%
I0130 03:44:12.673270 140119860389696 train.py:188] Step 5000, Loss: 0.04729848355054855, Accuracy: 98.21%, Validation Loss: 1.8192030191421509, Validation Accuracy: 82.08%
I0130 03:45:02.751702 140119860389696 train.py:188] Step 5250, Loss: 0.028815485537052155, Accuracy: 98.99%, Validation Loss: 1.5529804229736328, Validation Accuracy: 81.13%
I0130 03:45:52.192321 140119860389696 train.py:188] Step 5500, Loss: 0.042079828679561615, Accuracy: 98.58%, Validation Loss: 1.3498139381408691, Validation Accuracy: 82.08%
I0130 03:46:42.019604 140119860389696 train.py:188] Step 5750, Loss: 0.02635824866592884, Accuracy: 99.04%, Validation Loss: 1.684808373451233, Validation Accuracy: 80.19%
I0130 03:47:31.754084 140119860389696 train.py:188] Step 6000, Loss: 0.026456791907548904, Accuracy: 98.98%, Validation Loss: 2.4328458309173584, Validation Accuracy: 82.08%
I0130 03:48:21.557687 140119860389696 train.py:188] Step 6250, Loss: 0.030639508739113808, Accuracy: 98.87%, Validation Loss: 2.8109686374664307, Validation Accuracy: 80.19%
I0130 03:49:11.241310 140119860389696 train.py:188] Step 6500, Loss: 0.0373724028468132, Accuracy: 98.62%, Validation Loss: 2.2228987216949463, Validation Accuracy: 78.30%
I0130 03:50:01.325313 140119860389696 train.py:188] Step 6750, Loss: 0.04217967391014099, Accuracy: 98.42%, Validation Loss: 0.7758475542068481, Validation Accuracy: 84.91%
I0130 03:50:50.872736 140119860389696 train.py:188] Step 7000, Loss: 0.04439955949783325, Accuracy: 98.36%, Validation Loss: 2.9765968322753906, Validation Accuracy: 80.19%
I0130 03:51:40.842213 140119860389696 train.py:188] Step 7250, Loss: 0.022231360897421837, Accuracy: 99.24%, Validation Loss: 2.2917659282684326, Validation Accuracy: 81.13%
I0130 03:52:30.562510 140119860389696 train.py:188] Step 7500, Loss: 0.03938964381814003, Accuracy: 98.72%, Validation Loss: 2.0634124279022217, Validation Accuracy: 80.19%
I0130 03:52:30.592840 140119860389696 train.py:222] Finished training after 7500 steps.
I0130 03:52:30.610274 140119860389696 eval.py:22] 
======== Starting Evaluation ========
I0130 03:52:30.624567 140119860389696 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/ckpts
I0130 03:52:31.671555 140119860389696 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       86.79245283018868
Balanced_Acc:         87.27010457987738
Sensitivity:          83.05084745762711
Specificity:          91.48936170212765
F1_Score:             87.5
Confusion_matrix:   
                   [49  4]
                   [10 43]


I0130 03:52:32.678224 140119860389696 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       78.64077669902912
Balanced_Acc:         79.60227272727273
Sensitivity:          65.45454545454545
Specificity:          93.75
F1_Score:             76.59574468085107
Confusion_matrix:   
                   [36  3]
                   [19 45]


I0130 03:52:32.678587 140119860389696 eval.py:66] ======== Finished Evaluation ========
I0130 03:52:32.679001 140119860389696 visualization.py:90] 
======== Starting DeepVis ========
I0130 03:52:34.767590 140119860389696 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/plot/train/deepvis_IDRiD_001.jpg
I0130 03:52:35.260243 140119860389696 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/plot/test/deepvis_IDRiD_001.jpg
I0130 03:52:35.753475 140119860389696 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/plot/train/deepvis_IDRiD_009.jpg
I0130 03:52:36.262552 140119860389696 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-27-24-689440/plot/test/deepvis_IDRiD_009.jpg
I0130 03:52:36.341049 140119860389696 visualization.py:165] ======== Finished DeepVis ========
Model: "vgg_like"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 256, 256, 16)      448       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 256, 16)      2320      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      4640      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 32)      9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 64)        18496     
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 64, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 128)       73856     
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 128)       147584    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 256)       590080    
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130       
=================================================================
Total params: 1,195,346
Trainable params: 1,195,346
Non-trainable params: 0
_________________________________________________________________
2022-01-30 03:52:41.009059: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 03:52:41.536944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 03:52:42.025588 140010119624512 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 03:52:43.446587 140010119624512 main.py:117] Running model: vgg
I0130 03:52:43.447758 140010119624512 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141
I0130 03:52:43.447832 140010119624512 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-035243
I0130 03:52:43.458892 140010119624512 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 03:52:43.458952 140010119624512 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts
I0130 03:52:43.458987 140010119624512 train.py:171] 
======== Starting Training ========
2022-01-30 03:52:43.487260: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 03:52:45.216509: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 03:53:41.905306 140010119624512 train.py:188] Step 250, Loss: 0.6154509782791138, Accuracy: 67.07%, Validation Loss: 0.6679642200469971, Validation Accuracy: 69.81%
I0130 03:53:41.918861 140010119624512 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts.
I0130 03:54:31.605487 140010119624512 train.py:188] Step 500, Loss: 0.5580638647079468, Accuracy: 72.41%, Validation Loss: 0.53862065076828, Validation Accuracy: 74.53%
I0130 03:54:31.632391 140010119624512 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts.
I0130 03:55:21.754062 140010119624512 train.py:188] Step 750, Loss: 0.43417975306510925, Accuracy: 79.79%, Validation Loss: 0.3930736780166626, Validation Accuracy: 85.85%
I0130 03:55:21.781727 140010119624512 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts.
I0130 03:56:11.360152 140010119624512 train.py:188] Step 1000, Loss: 0.2777731418609619, Accuracy: 88.69%, Validation Loss: 0.36089226603507996, Validation Accuracy: 87.74%
I0130 03:56:11.379403 140010119624512 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts.
I0130 03:57:01.566994 140010119624512 train.py:188] Step 1250, Loss: 0.22287878394126892, Accuracy: 91.35%, Validation Loss: 0.3648061454296112, Validation Accuracy: 92.45%
I0130 03:57:01.593649 140010119624512 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts.
I0130 03:57:51.441973 140010119624512 train.py:188] Step 1500, Loss: 0.16657443344593048, Accuracy: 93.55%, Validation Loss: 0.5720628499984741, Validation Accuracy: 87.74%
I0130 03:58:41.538768 140010119624512 train.py:188] Step 1750, Loss: 0.13571088016033173, Accuracy: 95.15%, Validation Loss: 0.7349119186401367, Validation Accuracy: 79.25%
I0130 03:59:31.234394 140010119624512 train.py:188] Step 2000, Loss: 0.1392233520746231, Accuracy: 94.98%, Validation Loss: 0.7477027773857117, Validation Accuracy: 78.30%
I0130 04:00:21.370010 140010119624512 train.py:188] Step 2250, Loss: 0.10290028899908066, Accuracy: 96.09%, Validation Loss: 0.9549551010131836, Validation Accuracy: 84.91%
I0130 04:01:10.945806 140010119624512 train.py:188] Step 2500, Loss: 0.07672369480133057, Accuracy: 97.31%, Validation Loss: 0.9260432124137878, Validation Accuracy: 84.91%
I0130 04:02:00.954617 140010119624512 train.py:188] Step 2750, Loss: 0.09041734784841537, Accuracy: 96.93%, Validation Loss: 0.6750145554542542, Validation Accuracy: 87.74%
I0130 04:02:50.520638 140010119624512 train.py:188] Step 3000, Loss: 0.05086738243699074, Accuracy: 98.14%, Validation Loss: 1.0766758918762207, Validation Accuracy: 86.79%
I0130 04:03:40.574172 140010119624512 train.py:188] Step 3250, Loss: 0.07204853743314743, Accuracy: 97.53%, Validation Loss: 0.7923812866210938, Validation Accuracy: 82.08%
I0130 04:04:30.315175 140010119624512 train.py:188] Step 3500, Loss: 0.057709962129592896, Accuracy: 98.03%, Validation Loss: 1.3389952182769775, Validation Accuracy: 79.25%
I0130 04:05:20.449997 140010119624512 train.py:188] Step 3750, Loss: 0.05920032411813736, Accuracy: 98.06%, Validation Loss: 0.8429766297340393, Validation Accuracy: 84.91%
I0130 04:06:10.021638 140010119624512 train.py:188] Step 4000, Loss: 0.04640728235244751, Accuracy: 98.39%, Validation Loss: 1.0171992778778076, Validation Accuracy: 83.02%
I0130 04:06:59.924131 140010119624512 train.py:188] Step 4250, Loss: 0.04487035050988197, Accuracy: 98.39%, Validation Loss: 0.7006106376647949, Validation Accuracy: 81.13%
I0130 04:07:49.360795 140010119624512 train.py:188] Step 4500, Loss: 0.040244217962026596, Accuracy: 98.56%, Validation Loss: 1.1302071809768677, Validation Accuracy: 82.08%
I0130 04:08:39.401171 140010119624512 train.py:188] Step 4750, Loss: 0.05053291842341423, Accuracy: 98.38%, Validation Loss: 2.0721144676208496, Validation Accuracy: 79.25%
I0130 04:09:29.122479 140010119624512 train.py:188] Step 5000, Loss: 0.03940465673804283, Accuracy: 98.56%, Validation Loss: 1.090342402458191, Validation Accuracy: 87.74%
I0130 04:10:19.217002 140010119624512 train.py:188] Step 5250, Loss: 0.05316179245710373, Accuracy: 98.13%, Validation Loss: 1.1684200763702393, Validation Accuracy: 83.02%
I0130 04:11:08.774986 140010119624512 train.py:188] Step 5500, Loss: 0.03924137353897095, Accuracy: 98.63%, Validation Loss: 0.8369037508964539, Validation Accuracy: 83.96%
I0130 04:11:59.000744 140010119624512 train.py:188] Step 5750, Loss: 0.04239596053957939, Accuracy: 98.53%, Validation Loss: 0.8348524570465088, Validation Accuracy: 85.85%
I0130 04:12:48.775683 140010119624512 train.py:188] Step 6000, Loss: 0.037579718977212906, Accuracy: 98.77%, Validation Loss: 1.491735816001892, Validation Accuracy: 84.91%
I0130 04:13:38.836383 140010119624512 train.py:188] Step 6250, Loss: 0.03574780374765396, Accuracy: 98.83%, Validation Loss: 1.50570547580719, Validation Accuracy: 83.02%
I0130 04:14:28.372458 140010119624512 train.py:188] Step 6500, Loss: 0.036764394491910934, Accuracy: 98.69%, Validation Loss: 0.6020790338516235, Validation Accuracy: 90.57%
I0130 04:15:18.478432 140010119624512 train.py:188] Step 6750, Loss: 0.03663834184408188, Accuracy: 98.70%, Validation Loss: 1.6945455074310303, Validation Accuracy: 83.02%
I0130 04:16:08.187230 140010119624512 train.py:188] Step 7000, Loss: 0.032709892839193344, Accuracy: 98.82%, Validation Loss: 2.1532366275787354, Validation Accuracy: 83.96%
I0130 04:16:58.056253 140010119624512 train.py:188] Step 7250, Loss: 0.030958743765950203, Accuracy: 98.88%, Validation Loss: 2.0873985290527344, Validation Accuracy: 85.85%
I0130 04:17:47.569237 140010119624512 train.py:188] Step 7500, Loss: 0.022172734141349792, Accuracy: 99.23%, Validation Loss: 1.3807110786437988, Validation Accuracy: 87.74%
I0130 04:17:47.603162 140010119624512 train.py:222] Finished training after 7500 steps.
I0130 04:17:47.637946 140010119624512 eval.py:22] 
======== Starting Evaluation ========
I0130 04:17:47.655609 140010119624512 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/ckpts
I0130 04:17:48.692775 140010119624512 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       92.45283018867924
Balanced_Acc:         92.5133689839572
Sensitivity:          94.11764705882352
Specificity:          90.9090909090909
F1_Score:             92.3076923076923
Confusion_matrix:   
                   [48  5]
                   [ 3 50]


I0130 04:17:49.697988 140010119624512 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       77.66990291262135
Balanced_Acc:         76.32708821233412
Sensitivity:          69.04761904761905
Specificity:          83.60655737704919
F1_Score:             71.60493827160495
Confusion_matrix:   
                   [29 10]
                   [13 51]


I0130 04:17:49.698282 140010119624512 eval.py:66] ======== Finished Evaluation ========
I0130 04:17:49.698619 140010119624512 visualization.py:90] 
======== Starting DeepVis ========
I0130 04:17:51.785704 140010119624512 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/plot/train/deepvis_IDRiD_001.jpg
I0130 04:17:52.263891 140010119624512 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/plot/test/deepvis_IDRiD_001.jpg
I0130 04:17:52.773783 140010119624512 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/plot/train/deepvis_IDRiD_009.jpg
I0130 04:17:53.262544 140010119624512 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T03-52-42-019141/plot/test/deepvis_IDRiD_009.jpg
I0130 04:17:53.324636 140010119624512 visualization.py:165] ======== Finished DeepVis ========
Model: "vgg_like"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 256, 256, 16)      448       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 256, 16)      2320      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      4640      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 32)      9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 64)        18496     
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 64, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 128)       73856     
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 128)       147584    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 256)       590080    
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130       
=================================================================
Total params: 1,195,346
Trainable params: 1,195,346
Non-trainable params: 0
_________________________________________________________________
2022-01-30 04:17:58.066067: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-01-30 04:17:58.586522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9656 MB memory:  -> device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
/usr/local/lib/python3.8/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:54: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.6.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
I0130 04:17:59.098299 139825713186624 main.py:50] TFRecords files already exist. Proceed with the execution
I0130 04:18:00.583595 139825713186624 main.py:117] Running model: vgg
I0130 04:18:00.584763 139825713186624 train.py:20] All relevant data from this run is stored in /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868
I0130 04:18:00.584841 139825713186624 train.py:27] Tensorboard output will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/diabetic_retinopathy/logs/20220130-041800
I0130 04:18:00.596007 139825713186624 train.py:84] Training will be from scratch since no valid checkpoint was specified.
I0130 04:18:00.596076 139825713186624 train.py:85] All checkpoints will be stored in: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts
I0130 04:18:00.596110 139825713186624 train.py:171] 
======== Starting Training ========
2022-01-30 04:18:00.623303: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-30 04:18:02.367747: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
I0130 04:18:59.176458 139825713186624 train.py:188] Step 250, Loss: 0.6403011679649353, Accuracy: 65.07%, Validation Loss: 0.6689640283584595, Validation Accuracy: 68.87%
I0130 04:18:59.190210 139825713186624 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts.
I0130 04:19:48.841005 139825713186624 train.py:188] Step 500, Loss: 0.5988020896911621, Accuracy: 70.18%, Validation Loss: 0.5952634811401367, Validation Accuracy: 70.75%
I0130 04:19:48.862283 139825713186624 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts.
I0130 04:20:38.820795 139825713186624 train.py:188] Step 750, Loss: 0.49878668785095215, Accuracy: 75.73%, Validation Loss: 0.4072222113609314, Validation Accuracy: 74.53%
I0130 04:20:38.860702 139825713186624 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts.
I0130 04:21:28.610862 139825713186624 train.py:188] Step 1000, Loss: 0.3324967324733734, Accuracy: 85.82%, Validation Loss: 0.5705838203430176, Validation Accuracy: 83.96%
I0130 04:21:28.634618 139825713186624 train.py:216] Saving better val_acc checkpoint to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts.
I0130 04:22:18.426453 139825713186624 train.py:188] Step 1250, Loss: 0.2537667751312256, Accuracy: 89.78%, Validation Loss: 0.5729122757911682, Validation Accuracy: 80.19%
I0130 04:23:07.917330 139825713186624 train.py:188] Step 1500, Loss: 0.23453563451766968, Accuracy: 90.48%, Validation Loss: 1.0952333211898804, Validation Accuracy: 79.25%
I0130 04:23:58.074791 139825713186624 train.py:188] Step 1750, Loss: 0.1638077199459076, Accuracy: 93.62%, Validation Loss: 1.479480266571045, Validation Accuracy: 78.30%
I0130 04:24:47.872915 139825713186624 train.py:188] Step 2000, Loss: 0.141778364777565, Accuracy: 94.68%, Validation Loss: 1.021316647529602, Validation Accuracy: 81.13%
I0130 04:25:37.871040 139825713186624 train.py:188] Step 2250, Loss: 0.10151395946741104, Accuracy: 96.48%, Validation Loss: 1.4618680477142334, Validation Accuracy: 77.36%
I0130 04:26:27.674663 139825713186624 train.py:188] Step 2500, Loss: 0.08490301668643951, Accuracy: 97.14%, Validation Loss: 1.197515845298767, Validation Accuracy: 72.64%
I0130 04:27:17.719072 139825713186624 train.py:188] Step 2750, Loss: 0.08747036755084991, Accuracy: 96.84%, Validation Loss: 1.6634984016418457, Validation Accuracy: 80.19%
I0130 04:28:07.259138 139825713186624 train.py:188] Step 3000, Loss: 0.06468856334686279, Accuracy: 97.72%, Validation Loss: 0.8917996883392334, Validation Accuracy: 80.19%
I0130 04:28:57.314245 139825713186624 train.py:188] Step 3250, Loss: 0.06677308678627014, Accuracy: 97.76%, Validation Loss: 2.688612222671509, Validation Accuracy: 79.25%
I0130 04:29:47.017553 139825713186624 train.py:188] Step 3500, Loss: 0.04152565822005272, Accuracy: 98.63%, Validation Loss: 1.87626314163208, Validation Accuracy: 75.47%
I0130 04:30:37.127646 139825713186624 train.py:188] Step 3750, Loss: 0.046330250799655914, Accuracy: 98.46%, Validation Loss: 1.8443228006362915, Validation Accuracy: 75.47%
I0130 04:31:26.876936 139825713186624 train.py:188] Step 4000, Loss: 0.04574708268046379, Accuracy: 98.33%, Validation Loss: 1.5021913051605225, Validation Accuracy: 81.13%
I0130 04:32:17.123689 139825713186624 train.py:188] Step 4250, Loss: 0.05305631086230278, Accuracy: 98.21%, Validation Loss: 1.8265471458435059, Validation Accuracy: 78.30%
I0130 04:33:06.750344 139825713186624 train.py:188] Step 4500, Loss: 0.035391468554735184, Accuracy: 98.75%, Validation Loss: 2.459542989730835, Validation Accuracy: 76.42%
I0130 04:33:56.905561 139825713186624 train.py:188] Step 4750, Loss: 0.03880869597196579, Accuracy: 98.62%, Validation Loss: 1.3618052005767822, Validation Accuracy: 80.19%
I0130 04:34:46.846394 139825713186624 train.py:188] Step 5000, Loss: 0.037123240530490875, Accuracy: 98.70%, Validation Loss: 3.13444185256958, Validation Accuracy: 81.13%
I0130 04:35:36.998265 139825713186624 train.py:188] Step 5250, Loss: 0.05124075338244438, Accuracy: 98.34%, Validation Loss: 3.2159252166748047, Validation Accuracy: 80.19%
I0130 04:36:26.989158 139825713186624 train.py:188] Step 5500, Loss: 0.037435028702020645, Accuracy: 98.79%, Validation Loss: 2.9944417476654053, Validation Accuracy: 80.19%
I0130 04:37:17.193949 139825713186624 train.py:188] Step 5750, Loss: 0.032704245299100876, Accuracy: 98.90%, Validation Loss: 2.000305414199829, Validation Accuracy: 80.19%
I0130 04:38:06.964346 139825713186624 train.py:188] Step 6000, Loss: 0.02864750847220421, Accuracy: 99.05%, Validation Loss: 2.0586116313934326, Validation Accuracy: 81.13%
I0130 04:38:57.133482 139825713186624 train.py:188] Step 6250, Loss: 0.03892451152205467, Accuracy: 98.60%, Validation Loss: 2.5398340225219727, Validation Accuracy: 79.25%
I0130 04:39:46.951387 139825713186624 train.py:188] Step 6500, Loss: 0.03636057674884796, Accuracy: 98.73%, Validation Loss: 2.1172027587890625, Validation Accuracy: 81.13%
I0130 04:40:37.236360 139825713186624 train.py:188] Step 6750, Loss: 0.034315768629312515, Accuracy: 98.82%, Validation Loss: 1.8428914546966553, Validation Accuracy: 82.08%
I0130 04:41:27.018960 139825713186624 train.py:188] Step 7000, Loss: 0.03183363378047943, Accuracy: 98.96%, Validation Loss: 2.850466251373291, Validation Accuracy: 81.13%
I0130 04:42:17.247071 139825713186624 train.py:188] Step 7250, Loss: 0.019049838185310364, Accuracy: 99.34%, Validation Loss: 2.049103260040283, Validation Accuracy: 81.13%
I0130 04:43:07.228251 139825713186624 train.py:188] Step 7500, Loss: 0.029805077239871025, Accuracy: 98.96%, Validation Loss: 1.8108901977539062, Validation Accuracy: 82.08%
I0130 04:43:07.255517 139825713186624 train.py:222] Finished training after 7500 steps.
I0130 04:43:22.555129 139825713186624 eval.py:22] 
======== Starting Evaluation ========
I0130 04:43:22.568689 139825713186624 eval.py:27] Checkpoint restored from: /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/ckpts
I0130 04:43:23.614428 139825713186624 eval.py:60] 
Evaluating on val dataset
Unbalanced_Acc:       83.9622641509434
Balanced_Acc:         84.07142857142857
Sensitivity:          86.0
Specificity:          82.14285714285714
F1_Score:             83.49514563106797
Confusion_matrix:   
                   [43 10]
                   [ 7 46]


I0130 04:43:24.600234 139825713186624 eval.py:60] 
Evaluating on test dataset
Unbalanced_Acc:       85.43689320388349
Balanced_Acc:         85.11320754716981
Sensitivity:          74.0
Specificity:          96.22641509433963
F1_Score:             83.14606741573033
Confusion_matrix:   
                   [37  2]
                   [13 51]


I0130 04:43:24.600602 139825713186624 eval.py:66] ======== Finished Evaluation ========
I0130 04:43:24.601015 139825713186624 visualization.py:90] 
======== Starting DeepVis ========
I0130 04:43:26.673223 139825713186624 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/plot/train/deepvis_IDRiD_001.jpg
I0130 04:43:27.163465 139825713186624 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/plot/test/deepvis_IDRiD_001.jpg
I0130 04:43:27.648997 139825713186624 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/plot/train/deepvis_IDRiD_009.jpg
I0130 04:43:28.147089 139825713186624 visualization.py:162] Storing image to /home/RUS_CIP/st148923/dl-lab-21w-team20/runs/run_2022-01-30T04-17-59-091868/plot/test/deepvis_IDRiD_009.jpg
I0130 04:43:28.209145 139825713186624 visualization.py:165] ======== Finished DeepVis ========
Model: "vgg_like"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 256, 256, 16)      448       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 256, 16)      2320      
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      4640      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 32)      9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 64)        18496     
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 64, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 128)       73856     
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 128)       147584    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 256)       590080    
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dropout (Dropout)            (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130       
=================================================================
Total params: 1,195,346
Trainable params: 1,195,346
Non-trainable params: 0
_________________________________________________________________
